{"version":3,"sources":["state/constants/initial.tsx","state/constants/header.tsx","perks/constants/bonuses.tsx","state/actions/perks/bonuses.tsx","perks/constants/discounts.tsx","data/skills.tsx","state/actions/perks/discounts.tsx","data/ranks.tsx","perks/bonuses.tsx","perks/discounts.tsx","data/chi.tsx","state/chi.tsx","state/derived.tsx","state/skills.tsx","state/discounts.tsx","state/header.tsx","state/bonuses.tsx","state/constants/chi.tsx","data/loresheets/index.tsx","data/loresheets/core/riversandlakes/jianghu.tsx","data/loresheets/core/riversandlakes/crouchingtigersandhiddendragons.tsx","data/loresheets/core/riversandlakes/wulin.tsx","data/loresheets/core/riversandlakes/wulinsage.tsx","data/kungfu/types.tsx","perks/constants/effects.tsx","state/actions/perks/effects.tsx","data/kungfu/externals/blossom-harvest.tsx","data/kungfu/externals/bone-fed-wolf-fang.tsx","data/kungfu/internals/boundless-prosperity-manual.tsx","data/kungfu/internals/fire-sutra.tsx","data/kungfu/index.tsx","state/costs.tsx","state/constants/kungfu.tsx","state/kungfu.tsx","state/reducers/kungfu.tsx","state/constants/history.tsx","state/constants/skills.tsx","state/constants/loresheets.tsx","state/loresheets.tsx","state/reducers/loresheets.tsx","state/constants/virtues.tsx","data/virtues.tsx","state/virtues.tsx","state/reducers/virtues.tsx","state/reducers/global.tsx","state/reducers/header.tsx","state/reducers/chi.tsx","state/reducers/skills.tsx","state/reducers/history.tsx","state/history.tsx","data/archetypes.tsx","state/actions/header.tsx","state/actions/skills.tsx","state/initial.tsx","state/actions/initial.tsx","serviceWorker.ts","components/AppHeader/index.tsx","components/AppIntro/index.tsx","components/AppPage/index.tsx","components/FieldHeader.tsx","components/DDLText.tsx","components/Character/Archetype.tsx","containers/Character/Archetype.tsx","components/EditText.tsx","components/Character/Concept.tsx","containers/Character/Concept.tsx","components/StaticText.tsx","components/Character/Destiny.tsx","containers/Character/Destiny.tsx","components/Character/Entanglement.tsx","containers/Character/Entanglement.tsx","components/Character/Name.tsx","containers/Character/Name.tsx","components/Character/Rank.tsx","containers/Character/Rank.tsx","routes/Homepage.tsx","components/EditNumeric.tsx","components/Character/Skill.tsx","containers/Character/Skill.tsx","components/TokenInput/index.tsx","components/Character/EditSpecialities.tsx","components/Character/Specialities.tsx","containers/Character/Specialities.tsx","components/Character/Skills.tsx","routes/Skills.tsx","components/Character/Virtues.tsx","containers/Character/Virtues.tsx","state/actions/virtues.tsx","routes/Virtues.tsx","components/Character/Chi.tsx","containers/Character/Chi.tsx","state/actions/chi.tsx","components/Character/ChiList.tsx","routes/Chi.tsx","components/PlaceHolder.tsx","routes/Equipment.tsx","routes/Conditions.tsx","components/SelectorList/index.tsx","components/SelectorList/SelectorList.tsx","state/actions/kungfu.tsx","state/effects.tsx","components/Character/ExternalKungFuTechnique.tsx","containers/Character/ExternalKungFuTechnique.tsx","components/Character/ExternalKungFu.tsx","containers/Character/ExternalKungFu.tsx","components/Character/InternalKungFuTechnique.tsx","containers/Character/InternalKungFuTechnique.tsx","components/Character/InternalKungFu.tsx","containers/Character/InternalKungFu.tsx","components/Character/KungFuList.tsx","routes/KungFu.tsx","components/Character/LoresheetOptionPopup.tsx","components/Character/LoresheetOption.tsx","containers/Character/LoresheetOption.tsx","state/actions/loresheets.tsx","components/Character/Loresheet.tsx","containers/Character/Loresheet.tsx","components/Character/LoresheetsList.tsx","routes/Loresheets.tsx","components/Character/History.tsx","containers/Character/History.tsx","state/actions/history.tsx","routes/History.tsx","App/index.tsx","index.tsx"],"names":["INITIAL_STATE","HEADER_SET_NAME","HEADER_SET_CONCEPT","HEADER_SET_ARCHETYPE","HEADER_SET_RANK","BONUS_DISCOUNT","BONUS_DESTINY","BONUS_ENTANGLEMENT","BONUS_CHI","BONUS_CULTIVATION","BONUS_ONE_AMONG_N","BONUS_SKILL_RANK","BONUS_SPECIALITY","bonusDestiny","value","type","constants","bonusChi","chiName","chi","bonusSpeciality","skill","specialityName","speciality","DISCOUNT_CHI","DISCOUNT_SKILL","DISCOUNT_LORESHEET","DISCOUNT_LORESHEET_OPTION","DISCOUNT_KUNGFU_STYLE","DISCOUNT_KUNGFU_TECHNIQUE","skills","Awareness","name","specialities","Confidence","Crafting","Finesse","Hardiness","Inspire","Learning","Medicine","Might","Perform","Politics","Ride","Stealth","Survival","Tactics","discountSkillFactory","subset","length","Object","keys","ranks","description","key","perks","isBonus","bonus","isDiscount","r","chiNames","createState","state","forEach","cultivation","increase","increaseCultivation","increaseValue","chiValue","costMultiplier","Math","max","maxSkillBonus","rank","data","defineProperty","writable","skillName","maxSkillValue","Error","isSpecialityPresent","findIndex","addSpeciality","push","canBuySkill","canBuySpeciality","getDiscountIndexes","predicate","discountIdx","discounts","map","discount","idx","NaN","filter","isNaN","setRank","rankKey","baseState","bonuses","dataRank","foundRank","find","getRank","p","produce","draftState","destiny","entanglement","pushToDiscounts","CHI_BUY","loresheets","uid","category","cost","ruleset","options","repeatable","prerequisites","payload","min","values","bonusOneAmongN","sensechi","hidekillerintent","loresheetsCategories","ls","index","self","indexOf","validateLoresheet","loresheet","validateLoresheetOption","lsUid","loresheetIndex","option","getLoresheetData","idxLS","getLoresheetOptionData","optUid","idxOpt","o","KUNGFU_EXTERNAL","KUNGFU_INTERNAL","EFFECT_COMBAT_STATISTIC","EFFECT_CONDITIONAL_TEXT","EFFECT_CHI_THRESHOLD_INCREASE_BASE_CHI","combatStatistic","statistic","conditionalText","textInput","text","line","conditionalOnelineText","Array","chiIncrease","blossomHarvest","qualities","weapons","laugths","fears","statistics","speed","footwork","strike","damage","block","toughness","techniques","effect","effects","boneFedWolfFang","boundlessProsperityManual","element","level","fireSutra","externalKungfu","internalKungfu","validateKungFuType","validateKungFuStyle","styleUid","kf","validateKungFuTechnique","techniqueUid","tech","kungfuData","idxKF","kungfuTechniqueData","techUid","idxTech","t","zeroCost","canPay","original","_costFactory","costValue","remainingCost","stateDiscount","effectiveDiscount","newValue","applyCost","costDiscount","splice","updateDiscounts","getCostSkill","d","s","getCostSpeciality","getCostChi","chiMultiplicator","expectedCost","chis","getCostOpenLoresheet","uids","_getCostBuyLoresheetOptionOneCost","opt","discountOptUid","getCostBuyLoresheetOption","defaultCost","lenght","from","v","getCostVirtue","getCostKungFuStyle","getCostKungFuTechnique","kfData","KUNGFU_OPEN_STYLE","KUNGFU_CUSTOM_NAME_FOR_STYLE","KUNGFU_CUSTOM_NAME_FOR_TECHNIQUE","KUNGFU_BUY_TECHNIQUE","isStylePresent","stateKungFuUid","isStyleTechniquePresent","stateTechniqueUid","getExternalKungFuStatistics","dataStatistics","kfTechnique","canOpenKungFu","canBuyKungFuTechnique","noRestrictionInternal","levels","sort","_knownInternalKungFuLevel","kungfuReducer","action","openStyle","kungfu","kungfuType","dataKungfu","history","addKungFuTechnique","HISTORY_DELETE","SKILLS_BUY","SKILLS_SPECIALITY_BUY","LORESHEET_OPEN","LORESHEET_BUY_OPTION","isLoresheetPresent","loresheetUid","stateLoresheetUid","isLoresheetOptionPresent","optionUid","undefined","canOpenLoresheet","_or","a","b","_and","canBuyLoresheetOption","lsOptData","prerequisite","reduce","_prerequisiteToBool","loresheetsReducer","buyLoresheetOption","VIRTUE_INCREASE","virtues","isVirtuePresent","virtue","canBuyVirtue","virtuesReducer","globalReducer","initialStateFactory","header","concept","archetype","headerReducer","chiReducer","initial","skillsReducer","replayHistory","slice","id","historyReducer","actions","archetypes","breath","setArchetype","dataArchetype","dataArchetypes","dataRanks","skillSpecialityBuy","emptyStateFactory","createChiState","createSkillsState","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","error","AppHeader","props","toggle","bind","isOpen","this","setState","className","Link","to","React","AppIntro","children","AppPage","style","display","textAlign","FieldHeader","label","DDLText","dropdownOpen","edit","default","startEdit","endEdit","toggleDDL","select","getLabelForSelectedKey","renderButton","renderDropdownList","renderDropdownItems","renderHeader","renderValue","locked","labelForSelectedKey","onSubmit","e","join","btnOk","onClick","color","btnKo","role","Archetype","onChange","connect","dispatch","headerActions","propsFromState","propsForDispatch","assign","EditText","componentWillReceiveProps","textChange","renderEdit","renderNoEdit","nextProps","trim","validate","target","isValueValid","Button","InputGroup","InputGroupAddon","addonType","Input","placeholder","valid","Concept","isStringNotNull","StaticText","render","Destiny","toString","Entanglement","Name","Rank","Homepage","EditNumeric","doBuy","canBuy","onBuy","icon","f","Skill","TokenInput","idKey","labelKey","defaultProps","focused","input","inputChange","onBlur","onFocus","renderTokens","renderSuggestion","renderAddNew","tokens","matchOptionsWithInput","onMouseDown","onAdd","resetState","allowNew","event","exact","inputPrep","toLowerCase","some","token","labelPrep","EditSpecialities","buySpeciality","renderBoughtSpecialities","bought","optionList","foundIndex","available","indexNewSpeciality","Specialities","newSpecialityAvailability","concat","merge","item","pos","retVal","Skills","RouteSkills","Virtues","chivalrousVirtues","selfishVirtues","rows","i","cvdiv","renderVirtue","svdiv","variable","val","RouteVirtues","Chi","charAt","toUpperCase","ChiList","RouteChi","PlaceHolder","RouteEquipment","RouteConditions","SelectorList","searched","meta","selected","preSelected","renderList","renderSearchBox","renderSelected","itemOnSelectedToggle","searchInputChanged","prop","disabled","renderItem","prevState","newList","search","dataKungFu","buyTechnique","effectToString","ExternalKungFuTechnique","technique","known","ExternalKungFu","renderCrunch","renderStats","renderTechniques","justifyContent","w","q","flexGrow","canOpen","onOpen","knownTechniques","InternalKungFuTechnique","InternalKungFu","KungFuList","externals","internals","externalIdx","internalIdx","getKungFuType","RouteKungFu","LoresheetOptionPopup","initState","renderComplexCost","renderPayload","buyButtonClick","choices","renderBonusChoices","complexCost","Modal","ModalHeader","ModalBody","ModalFooter","renderBuyButton","perk","all","bonusKey","JSON","stringify","fromBonusToString","marks","newMarks","included","step","activePayload","activeCost","active","LoresheetOption","isModalOpen","renderKnown","renderNotKnown","onRowClickBuy","toggleModal","payloads","fromCostToString","canBuyOneOrMore","previousValue","currentValue","lsState","dataLoresheets","buyOption","Loresheet","renderOptions","open","LoresheetsList","nestedOptions","categories","lsInCategory","RouteLoresheets","History","hoverIndex","renderHistoryAction","rollbackHistory","onDelete","RouteHistory","App","BrowserRouter","Route","path","component","Equipment","Conditions","KungFu","Loresheets","store","createStore","testingStateFactory","devToolsEnhancer","ReactDOM","document","getElementById","URL","process","href","origin","addEventListener","fetch","response","contentType","headers","get","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"8WAAaA,EAAgB,gBCAtB,IAAMC,EAAkB,kBAGlBC,EAAqB,qBAGrBC,EAAuB,uBAGvBC,EAAkB,kB,QCTlBC,EAAiB,iBAGjBC,EAAgB,gBAGhBC,EAAqB,qBAGrBC,EAAY,YAGZC,EAAoB,oBAGpBC,EAAoB,oBAGpBC,EAAmB,mBAGnBC,EAAmB,mBCNzB,SAASC,EAAaC,GAC3B,MAAO,CAAEC,KAAMC,EAAyBF,SAOnC,SAASG,EAASH,EAAeI,GACtC,MAAO,CAAEH,KAAMC,EAAqBG,IAAKD,EAASJ,SA0B7C,SAASM,EACdC,EACAC,GAEA,MAAO,CACLD,QACAE,WAAYD,EACZP,KAAMC,GCzDH,IAAMQ,EAAe,eAGfC,EAAiB,iBAGjBC,EAAqB,qBAGrBC,EAA4B,4BAG5BC,EAAwB,wBAGxBC,EAA4B,4BCU5BC,EAAsB,CACjCC,UAAW,CACTC,KAAM,YACNC,aAAc,CAAC,OAAQ,MAAO,QAAS,QAAS,UAElDC,WAAY,CACVF,KAAM,aACNC,aAAc,CACZ,mBACA,kCACA,oCACA,gCAGJE,SAAU,CACRH,KAAM,WACNC,aAAc,CACZ,QACA,YACA,QACA,UACA,YACA,WACA,QACA,YAGJG,QAAS,CACPJ,KAAM,UACNC,aAAc,CACZ,aACA,WACA,iBACA,kBACA,oBAGJI,UAAW,CACTL,KAAM,YACNC,aAAc,CACZ,UACA,oCACA,SACA,2BACA,gBACA,qBAGJK,QAAS,CACPN,KAAM,UACNC,aAAc,CACZ,WACA,eACA,gBACA,kBACA,2CACA,uBAGJM,SAAU,CACRP,KAAM,WACNC,aAAc,CACZ,cACA,iCACA,UACA,OACA,iBACA,aACA,4CAGJO,SAAU,CACRR,KAAM,WACNC,aAAc,CACZ,UACA,gCACA,WACA,SACA,kBACA,2CAGJQ,MAAO,CACLT,KAAM,QACNC,aAAc,CAAC,WAAY,UAAW,UAAW,aAEnDS,QAAS,CACPV,KAAM,UACNC,aAAc,CACZ,SACA,0BACA,UACA,SACA,UACA,UAGJU,SAAU,CACRX,KAAM,WACNC,aAAc,CAAC,+BAEjBW,KAAM,CACJZ,KAAM,OACNC,aAAc,CACZ,wBACA,4CACA,WAGJY,QAAS,CACPb,KAAM,UACNC,aAAc,CACZ,aACA,YACA,gBACA,aACA,UACA,cAGJa,SAAU,CACRd,KAAM,WACNC,aAAc,CACZ,SACA,SACA,UACA,UACA,YACA,YAGJc,QAAS,CACPf,KAAM,UACNC,aAAc,CACZ,uBACA,aACA,qBACA,qBACA,4CAGJ,SAAU,CACRD,KAAM,SACNC,aAAc,CACZ,mCACA,mBACA,cACA,oBACA,4CCxKC,SAASe,EACdlC,EACAmC,GAEA,OAAIA,GAAUA,EAAOC,OAAS,EACrB,CAAEpB,OAAQmB,EAAQlC,KAAMC,EAA0BF,SAElD,CACLgB,OAAQqB,OAAOC,KAAKtB,GACpBf,KAAMC,EACNF,SCEC,IAAMuC,EAAoB,CAC/B,CACEC,YACE,uGACFC,IAAK,WACLvB,KAAM,WACNwB,MAAO,CAAC3C,EAAa,IAAKmC,EAAqB,IAAK/B,EAAS,EAAG,YAChEH,MAAO,GAET,CACEwC,YACE,2GACFC,IAAK,WACLvB,KAAM,WACNwB,MAAO,CAAC3C,EAAa,IAAKmC,EAAqB,IAAK/B,EAAS,EAAG,YAChEH,MAAO,GAET,CACEwC,YACE,4GACFC,IAAK,WACLvB,KAAM,WACNwB,MAAO,CACL3C,EAAa,IACbmC,EAAqB,IACrB/B,EAAS,GAAI,YAEfH,MAAO,GAET,CACEwC,YACE,4GACFC,IAAK,WACLvB,KAAM,WACNwB,MAAO,CACL3C,EAAa,IACbmC,EAAqB,IACrB/B,EAAS,GAAI,YAEfH,MAAO,GAET,CACEwC,YACE,4GACFC,IAAK,WACLvB,KAAM,WACNwB,MAAO,CACL3C,EAAa,KACbmC,EAAqB,IACrB/B,EAAS,GAAI,YAEfH,MAAO,GAET,CACEwC,YACE,6GACFC,IAAK,WACLvB,KAAM,WACNwB,MAAO,CACL3C,EAAa,KACbmC,EAAqB,IACrB/B,EAAS,GAAI,YAEfH,MAAO,IC5BJ,SAAS2C,EAAQC,GACtB,OAAQA,EAAM3C,MACZ,KAAKC,EACL,KAAKA,EACL,KAAKA,EACL,KAAKA,EACL,KAAKA,EACL,KAAKA,EACL,KAAKA,EACH,OAAO,EACT,KAAKA,EACL,QACE,OAAO,GCbN,SAAS2C,EAAWC,GACzB,OAAQA,EAAE7C,MACR,KAAKC,EACL,KAAKA,EACL,KAAKA,EACL,KAAKA,EACL,KAAKA,EACL,KAAKA,EACH,OAAO,EACT,QACE,OAAO,GC3DN,IAAM6C,EACb,CAAE,UAAY,OAAS,OAAS,QAAU,QAAU,QAAU,cAAgB,WCGvE,SAASC,IACd,IAAMC,EAAQ,GAId,OAHAF,EAASG,QAAQ,SAAC7C,GAChB4C,EAAM5C,GAAO,CAAEL,MAAO,EAAGmD,YAAa,KAEjCF,EAGF,SAASG,EACdH,EACA/B,EACAlB,GAEAiD,EAAM/B,GAAMlB,OAASA,EAGhB,SAASqD,EACdJ,EACA/B,EACAoC,GAYA,IAVA,IAAIH,EAAcF,EAAM/B,GAAMiC,YAAcG,EACxCC,EAAWN,EAAM/B,GAAMlB,MAErBwD,EACK,gBAATtC,GAAmC,YAATA,EACtB,GACS,YAATA,EACA,EACA,EAECiC,EAAcK,EAAiBC,KAAKC,IAAI,EAAGH,IAAa,GAC7DJ,GAAeK,EAAiBC,KAAKC,IAAI,EAAGH,GAC5CA,IAGFN,EAAM/B,GAAMlB,MAAQuD,EACpBN,EAAM/B,GAAMiC,YAAcA,ECNrB,SAASQ,EAAcV,GAC5B,OAAIA,EAAMW,KACDH,KAAKC,IAAI,EAAG,EAAIT,EAAMW,KAAK5D,OAE7B,EC7BF,SAASgD,IACd,IAAMC,EAAQ,GAWd,OAVAZ,OAAOC,KAAKuB,GAAMX,QAAQ,SAAA3C,GACxB8B,OAAOyB,eAAeb,EAAO1C,EAAO,CAClCP,MAAO,CACLkB,KAAMX,EACNY,aAAc,GACdnB,MAAO,GAET+D,UAAU,MAGPd,EAGF,SAASG,EACdH,EACAe,EACAC,GAGA,GADYhB,EAAMe,GAAWhE,MACnB,EAAIiE,EACZ,MAAM,IAAIC,MAAM,SAAWF,EAAY,aAEzCf,EAAMe,GAAWhE,OAAS,EAGrB,SAASmE,EACdlB,EACAe,EACAxD,GAKA,OAA4B,IAHJyC,EAAMe,GAAW7C,aAAaiD,UACpD,SAAC3D,GAAD,OAAwBA,IAAeD,IAKpC,SAAS6D,EACdpB,EACAe,EACAxD,GAEA,GAAI2D,EAAoBlB,EAAOe,EAAWxD,GACxC,MAAM,IAAI0D,MACR,qCACE1D,EACA,gBACAwD,EACA,oBAGNf,EAAMe,GAAW7C,aAAamD,KAAK9D,GAG9B,SAAS+D,EACdtB,EACAe,GAIA,QAFcf,EAAMjC,OAAOgD,GAAWhE,MAErB,EADL2D,EAAcV,IAIrB,SAASuB,EACdvB,EACAe,EACAvD,GAEA,OAAQ0D,EAAoBlB,EAAMjC,OAAQgD,EAAWvD,GC3DhD,SAASgE,EACdxB,EACAyB,GAEA,IAAMC,EAAc1B,EAAM2B,UACvBC,IAAI,SAACC,EAAqBC,GACzB,OAAIL,EAAUI,GACLC,EAEFC,MAERC,OAAO,SAACjF,GAAD,OAAoBkF,MAAMlF,KACpC,OAAI2E,GAGK,GC5BJ,SAASQ,EAAQlC,EAAoBmC,GAC1C,ICSAC,EACAC,EDVMC,ERiFD,SAAiB3B,GACtB,IAAM4B,EAAYjD,EAAMkD,KAAK,SAACF,GAAD,OAAyBA,EAAS9C,MAAQmB,IACvE,IAAK4B,EACH,MAAM,IAAItB,MAAM,iBAAmBN,EAAO,KAE5C,OAAO4B,EQtFUE,CAAQN,GACzBnC,EAAMW,KAAO,CAAE1C,KAAMqE,EAASrE,KAAMlB,MAAOuF,EAASvF,OCQpDqF,EDPapC,ECQbqC,EDRoBC,EAAS7C,MAAMuC,OAAO,SAAAU,GAAC,OAAIhD,EAAQgD,KCUrCC,YAAQP,EAAW,SAAAQ,GACnCP,EACGL,OAAO,SAACrC,GAAD,OAAmBD,EAAQC,KAClCM,QAAQ,SAACN,GACR,OAAQA,EAAM3C,MACZ,KAAKC,EACH2F,EAAWC,SAAWlD,EAAM5C,MAC5B,MACF,KAAKE,EACH2F,EAAWE,cAAgBnD,EAAM5C,MACjC,MACF,KAAKE,EACHG,EAAawF,EAAWxF,IAAKuC,EAAMvC,IAAKuC,EAAM5C,OAC9C,MACF,KAAKE,EACHG,EAAwBwF,EAAWxF,IAAKuC,EAAMvC,IAAKuC,EAAM5C,OACzD,MACF,KAAKE,EACH,IAAMwD,EAAMC,EAAckC,GAE1B7E,EAAgB6E,EAAW7E,OAAQ4B,EAAMrC,MAAOmD,GAChD,MACF,KAAKxD,EAEHc,EACE6E,EAAW7E,OACX4B,EAAMrC,MACNqC,EAAMnC,YAER,MACF,QACE,YF1CL,SACLwC,EACA2B,GAEAA,EACGK,OAAO,SAACnC,GAAD,OAAkBD,EAAWC,KACpCI,QAAQ,SAACJ,GACRG,EAAM2B,UAAUN,KAAKxB,KCLzBkD,CAAgB/C,EAAOsC,EAAS7C,MAAMuC,OAAO,SAAAU,GAAC,OAC5C9C,EAAW8C,MEdR,IAAMM,EAAU,UC2DVC,EAA+B,CCvDL,CACrCC,IAAK,UACLjF,KAAM,eACNkF,SAAU,mBACVC,KAAM,EACNC,QAAS,OACT9D,YACE,8bACF+D,QAAS,CACP,CACEJ,IAAK,cACLE,KAAM,EACNpG,KAAM,QACNuC,YACE,kSACFgE,YAAY,EACZC,cAAe,GACf/D,MAAO,GACPgE,QAAS,mBAEX,CACEP,IAAK,gBACLE,KAAM,CAAEM,IAAK,EAAGjD,IAAK,IACrBzD,KAAM,UACNuC,YACE,0NACFgE,YAAY,EACZC,cAAe,GACf/D,MAAO,IAET,CACEyD,IAAK,oBACLE,KAAM,CAAEM,IAAK,EAAGjD,IAAK,GACrBlB,YACE,gHACFvC,KAAM,SACNuG,YAAY,EACZC,cAAe,CACb,CAAExG,KAAM,KAAMwG,cAAe,CAAC,cAAe,mBAE/C/D,MAAO,GACPgE,QAAS,qBCrCgD,CAC7DP,IAAK,mBACLjF,KAAM,sCACNkF,SAAU,mBACVC,KAAM,EACNC,QAAS,OACT9D,YACE,+PACF+D,QAAS,CACP,CACEJ,IAAK,WACLE,KAAM,CAAEM,IAAK,EAAGjD,IAAK,GACrBzD,KAAM,eACNuC,YACE,2eACFgE,YAAY,EACZC,cAAe,GACf/D,MAAO,GACPgE,QAAS,sBAEX,CACEP,IAAK,yBACLE,KAAM,EACN7D,YACE,ygBACFvC,KAAM,SACNuG,YAAY,EACZC,cAAe,GACf/D,MAAO,IAET,CACEyD,IAAK,WACLE,KAAM,EACN7D,YACE,4FACFvC,KAAM,QACNuG,YAAY,EACZC,cAAe,GACf/D,MAAO,CjBZN,SACL4C,GAEA,GAAoC,IAAhCjD,OAAOC,KAAKgD,GAASlD,OACvB,MAAM,IAAI8B,MAAM,kCAElB,OAAoC,IAAhC7B,OAAOC,KAAKgD,GAASlD,OAChBC,OAAOuE,OAAOtB,GAAS,GAEzB,CAAErF,KAAMC,EAA6BoF,WiBItCuB,CAAe,CACbC,SAAUxG,EAAgB,SAAU,aACpCyG,iBAAkBzG,EAAgB,SAAU,4BC7CjB,CACnC6F,IAAK,QACLjF,KAAM,YACNkF,SAAU,mBACVC,KAAM,EACNC,QAAS,OACT9D,YACE,wfACF+D,QAAS,CACP,CACEJ,IAAK,kBACLE,KAAM,CAAEM,IAAK,EAAGjD,IAAK,IACrBzD,KAAM,cACNuC,YACE,+hBACFgE,YAAY,EACZC,cAAe,GACf/D,MAAO,GACPgE,QAAS,UAEX,CACEP,IAAK,iBACLE,KAAM,CAAEM,IAAK,EAAGjD,IAAK,IACrBzD,KAAM,UACNuC,YACE,8bACFgE,YAAY,EACZC,cAAe,GACf/D,MAAO,GACPgE,QAAS,wBC7B0B,CACvCP,IAAK,YACLjF,KAAM,iBACNkF,SAAU,mBACVC,KAAM,EACNC,QAAS,OACT9D,YACE,oaACF+D,QAAS,CACP,CACEJ,IAAK,OACLE,KAAM,CAAEM,IAAK,EAAGjD,IAAK,IACrBzD,KAAM,UACNuC,YACE,6HACFgE,YAAY,EACZC,cAAe,GACf/D,MAAO,GACPgE,QAAS,UAEX,CACEP,IAAK,eACLE,KAAM,CAAEM,IAAK,EAAGjD,IAAK,IACrBzD,KAAM,cACNuC,YAAa,6DACbgE,YAAY,EACZC,cAAe,GACf/D,MAAO,IAET,CACEyD,IAAK,mBACLE,KAAM,CAAEM,IAAK,EAAGjD,IAAK,IACrBzD,KAAM,cACNuC,YACE,2FACFgE,YAAY,EACZC,cAAe,GACf/D,MAAO,GACPgE,QAAS,YJwBFM,EAAiCd,EAC3CrB,IAAI,SAAAoC,GAAE,OAAIA,EAAGb,WACbnB,OACC,SAACjF,EAAekH,EAAeC,GAA/B,OACEA,EAAKC,QAAQpH,KAAWkH,IAGvB,SAASG,EAAkBlB,GAChC,IAAKD,EAAWT,KAAK,SAAC6B,GAAD,OAA+BA,EAAUnB,MAAQA,IACpE,MAAM,IAAIjC,MAAM,sBAAwBiC,EAAM,KAI3C,SAASoB,EAAwBC,EAAerB,GACrDkB,EAAkBG,GAClB,IAAMC,EAAiBvB,EAAW9B,UAChC,SAAC6C,GAAD,OAAwBA,EAAGd,MAAQqB,IAErC,IACGtB,EAAWuB,GAAgBlB,QAAQd,KAClC,SAACiC,GAAD,OAAkCA,EAAOvB,MAAQA,IAGnD,MAAM,IAAIjC,MAAM,wCAIb,SAASyD,GAAiBH,GAC/B,IAAMI,EAAQ1B,EAAW9B,UAAU,SAAA6C,GAAE,OAAIA,EAAGd,MAAQqB,IACpD,OAAOtB,EAAW0B,GAGb,SAASC,GACdL,EACAM,GAEA,IAAMF,EAAQ1B,EAAW9B,UAAU,SAAA6C,GAAE,OAAIA,EAAGd,MAAQqB,IAC9CO,EAAS7B,EAAW0B,GAAOrB,QAAQnC,UAAU,SAAA4D,GAAC,OAAIA,EAAE7B,MAAQ2B,IAClE,OAAO5B,EAAW0B,GAAOrB,QAAQwB,GKnG5B,IAAME,GAAkB,kBAGlBC,GAAkB,kBCRlBC,GAA0B,0BAG1BC,GAA0B,0BAG1BC,GAAyC,yCCE/C,SAASC,GACdC,EACAnF,GAEA,MAAO,CAAEA,WAAUmF,YAAWtI,KAAMC,IAG/B,SAASsI,GAAgBC,GAC9B,IAAMC,EAAOD,EAAUxD,OAAO,SAAC0D,GAAD,OAAkBA,EAAKvG,OAAS,IAC9D,GAAoB,IAAhBsG,EAAKtG,OACP,MAAM,IAAI8B,MAAM,2CAElB,MAAO,CAAEwE,OAAMzI,KAAMC,IAGhB,SAAS0I,GAAuBF,GACrC,OAAOF,GAAgB,IAAIK,MAAcH,IClBpC,IDsBLI,GCtBWC,GAAsC,CACjD7H,KAAM,kBACNiF,IAAK,kBACL6C,UAAW,CACT,wbACA,iNAEFC,QAAS,CAAC,UAAW,QAAS,WAC9BC,QACE,iYACFC,MACE,8PACFC,WAAY,CACVC,MAAO,EACPC,SAAU,EACVC,OAAQ,EACRC,OAAQ,GACRC,MAAO,EACPC,UAAW,IAEbC,WAAY,CACV,CACEzI,KAAM,0BACNmF,KAAM,EACN7D,YACE,+LACFoH,OAAQC,GACN,8FAEF1D,IAAK,2BAEP,CACEjF,KAAM,YACNmF,KAAM,EACN7D,YACE,yIACFoH,OAAQC,GAAwB,YAAa,GAC7C1D,IAAK,aAEP,CACEjF,KAAM,YACNiF,IAAK,cACLE,KAAM,EACN7D,YACE,yIACFoH,QDvBJd,GCuBgD,EDrBzC,CACLA,eACA7I,KAAMC,KCoBJuG,cAAe,CAAC,CAAEN,IAAK,iBAEzB,CACEjF,KAAM,gCACNiF,IAAK,gCACLE,KAAM,EACN7D,YACE,qFACFoH,OAAQC,GAAwB,SAAU,IAE5C,CACE3I,KAAM,yBACNiF,IAAK,yBACLE,KAAM,EACN7D,YACE,mQACFoH,OAAQC,GACN,4FC/DKC,GAAuC,CAClD5I,KAAM,qBACNiF,IAAK,qBACL8C,QAAS,CAAC,UAAW,SACrBD,UAAW,CACT,ocACA,2PAEFE,QACE,sKACFC,MACE,kNACFC,WAAY,CACVC,MAAO,EACPC,SAAU,EACVC,OAAQ,EACRC,OAAQ,GACRC,MAAO,EACPC,UAAW,GAEbC,WAAY,CACV,CACEzI,KAAM,gBACNmF,KAAM,EACN7D,YACE,gKACFoH,OAAQC,GACN,oGAEF1D,IAAK,iBAEP,CACEjF,KAAM,qBACNmF,KAAM,EACN7D,YACE,iZACFoH,OAAQC,GACN,yGAEF1D,IAAK,sBAEP,CACEjF,KAAM,qBACNmF,KAAM,EACN7D,YACE,uSACFoH,OAAQC,GACN,gJAEF1D,IAAK,sBAEP,CACEjF,KAAM,oBACNmF,KAAM,EACN7D,YACE,gUACFoH,OAAQC,GACN,gGAEF1D,IAAK,qBAEP,CACEjF,KAAM,yBACNmF,KAAM,EACN7D,YACE,0MACFoH,OAAQC,GACN,gGAEF1D,IAAK,4BCrEE4D,GAAiD,CAC5D7I,KAAM,8BACNiF,IAAK,8BACL3D,YACE,qdACFwH,QAAS,OACTL,WAAY,CACV,CACEM,MAAO,EACP/I,KAAM,yBACNiF,IAAK,yBACL3D,YACE,6GACFoH,OAAQC,GACN,sRAGJ,CACEI,MAAO,EACP/I,KAAM,yBACNiF,IAAK,yBACL3D,YACE,gKACFoH,OAAQC,GAA+B,oCAEzC,CACEI,MAAO,EACP/I,KAAM,oBACNiF,IAAK,oBACL3D,YACE,0KACFoH,OAAQC,GAAwB,CAC9B,uBACA,uCAGJ,CACEI,MAAO,EACP/I,KAAM,4BACNiF,IAAK,4BACL3D,YACE,mJACFoH,OAAQC,GAA+B,oCAEzC,CACEI,MAAO,EACP/I,KAAM,0BACNiF,IAAK,0BACL3D,YACE,gFACFoH,OAAQC,GAA+B,mCAEzC,CACEI,MAAO,EACP/I,KAAM,kCACNiF,IAAK,kCACL3D,YACE,uLACFoH,OAAQC,GAAwB,CAC9B,yKACA,gIACA,0EAGJ,CACEI,MAAO,EACP/I,KAAM,uCACNiF,IAAK,uCACL3D,YACE,iJACFoH,OAAQC,GAAwB,CAC9B,uBACA,4HAGJ,CACEI,MAAO,EACP/I,KAAM,0BACNiF,IAAK,0BACL3D,YACE,qIACFoH,OAAQC,GACN,mEAGJ,CACEI,MAAO,EACP/I,KAAM,oCACNiF,IAAK,oCACL3D,YACE,8EACFoH,OAAQC,GAAwB,CAC9B,uBACA,qFACA,sGAGJ,CACEI,MAAO,EACP/I,KAAM,kCACNiF,IAAK,kCACL3D,YACE,sSACFoH,OAAQC,GACN,qQAGJ,CACEI,MAAO,EACP/I,KAAM,yBACNiF,IAAK,yBACL3D,YACE,qSACFoH,OAAQC,GAAwB,CAC9B,iQACA,qCCnHKK,GAAiC,CAC5ChJ,KAAM,aACNiF,IAAK,aACL3D,YACE,+UACFwH,QAAS,OACTL,WAAY,CACV,CACEM,MAAO,EACP/I,KAAM,mBACNiF,IAAK,mBACL3D,YACE,yJACFoH,OAAQC,GACN,kFAGJ,CACEI,MAAO,EACP/I,KAAM,mBACNiF,IAAK,mBACL3D,YACE,2KACFoH,OAAQC,GAAwB,CAC9B,qKACA,uGAGJ,CACEI,MAAO,EACP/I,KAAM,2BACNiF,IAAK,2BACL3D,YACE,wJACFoH,OAAQC,GACN,yGAGJ,CACEI,MAAO,EACP/I,KAAM,gBACNiF,IAAK,gBACL3D,YACE,yQACFoH,OAAQC,GAAwB,CAC9B,uBACA,qFACA,6QAGJ,CACEI,MAAO,EACP/I,KAAM,gBACNiF,IAAK,gBACL3D,YACE,8MACFoH,OAAQC,GACN,kFAGJ,CACEI,MAAO,EACP/I,KAAM,uBACNiF,IAAK,uBACL3D,YACE,0VACFoH,OAAQC,GAAwB,CAC9B,gGACA,mDACA,0QAGJ,CACEI,MAAO,EACP/I,KAAM,uBACNiF,IAAK,uBACL3D,YACE,yGACFoH,OAAQC,GACN,0JAGJ,CACEI,MAAO,EACP/I,KAAM,iBACNiF,IAAK,iBACL3D,YACE,0IACFoH,OAAQC,GAAwB,CAC9B,uBACA,+FACA,mGAGJ,CACEI,MAAO,EACP/I,KAAM,oBACNiF,IAAK,oBACL3D,YACE,4NACFoH,OAAQC,GAAwB,CAC9B,uBACA,+FACA,kHAGJ,CACEI,MAAO,EACP/I,KAAM,oBACNiF,IAAK,oBACL3D,YACE,sMACFoH,OAAQC,GACN,2JAGJ,CACEI,MAAO,EACP/I,KAAM,2BACNiF,IAAK,2BACL3D,YACE,kUACFoH,OAAQC,GACN,sPCpHKM,GAAwC,CACnDpB,GACAe,IAKWM,GAAwC,CACnDL,GACAG,IAGK,SAASG,GAAmBpK,GACjC,OAAQA,GACN,KAAKgI,GAEL,KAAKC,GACH,OACF,QACE,MAAM,IAAIhE,MAAM,2BAA6BjE,EAAO,MAInD,SAASqK,GAAoBrK,EAAmBsK,GAErD,GADAF,GAAmBpK,GACfA,IAASgI,IAIX,GAHiBkC,GAAelF,OAC9B,SAACuF,GAAD,OAA6BA,EAAGrE,MAAQoE,IAE7BnI,OAAS,EACpB,MAAM,IAAI8B,MAAM,4BAA8BqG,EAAW,UAM3D,GAHiBH,GAAenF,OAC9B,SAACuF,GAAD,OAA6BA,EAAGrE,MAAQoE,IAE7BnI,OAAS,EACpB,MAAM,IAAI8B,MAAM,4BAA8BqG,EAAW,KAKxD,SAASE,GACdxK,EACAsK,EACAG,GAGA,GADAJ,GAAoBrK,EAAMsK,GACtBtK,IAASgI,IASX,GARiBkC,GAAelF,OAAO,SAACuF,GACtC,OACEA,EAAGrE,MAAQoE,GACXC,EAAGb,WAAW1E,OACZ,SAAC0F,GAAD,OAAwCA,EAAKxE,MAAQuE,IACrDtI,OAAS,IAGFA,OAAS,EACpB,MAAM,IAAI8B,MACR,sCACEwG,EACA,gBACAH,EACA,UAYN,GARiBH,GAAenF,OAAO,SAACuF,GACtC,OACEA,EAAGrE,MAAQoE,GACXC,EAAGb,WAAW1E,OACZ,SAAC0F,GAAD,OAAwCA,EAAKxE,MAAQuE,IACrDtI,OAAS,IAGFA,OAAS,EACpB,MAAM,IAAI8B,MACR,sCACEwG,EACA,gBACAH,EACA,KAkBH,SAASK,GAAW3K,EAAmBsK,GAC5C,GAAItK,IAASgI,GAAiB,CAC5B,IAAM4C,EAAQV,GAAe/F,UAAU,SAAAoG,GAAE,OAAIA,EAAGrE,MAAQoE,IACxD,OAAOJ,GAAeU,GAEtB,IAAMA,EAAQT,GAAehG,UAAU,SAAAoG,GAAE,OAAIA,EAAGrE,MAAQoE,IACxD,OAAOH,GAAeS,GAInB,SAASC,GACd7K,EACAsK,EACAQ,GAEA,GAAI9K,IAASgI,GAAiB,CAC5B,IAAM4C,EAAQV,GAAe/F,UAAU,SAAAoG,GAAE,OAAIA,EAAGrE,MAAQoE,IAClDS,EAAUb,GAAeU,GAAOlB,WAAWvF,UAC/C,SAAA6G,GAAC,OAAIA,EAAE9E,MAAQ4E,IAEjB,OAAOZ,GAAeU,GAAOlB,WAAWqB,GAExC,IAAMH,EAAQT,GAAehG,UAAU,SAAAoG,GAAE,OAAIA,EAAGrE,MAAQoE,IAClDS,EAAUZ,GAAeS,GAAOlB,WAAWvF,UAC/C,SAAA6G,GAAC,OAAIA,EAAE9E,MAAQ4E,IAEjB,OAAOX,GAAeS,GAAOlB,WAAWqB,GC3HrC,IAAME,GAAkB,CAC7BC,QAAQ,EACRrF,QAAS,EACTsF,SAAU,GAGZ,SAASC,GACPpI,EACAqI,EACA3G,GAEA,GAAIA,EAAa,CACf,IAAI4G,EAAgBD,EACd1G,EAAYD,EAAYE,IAAI,SAACE,GACjC,IAAMyG,EAA2BvI,EAAM2B,UAAUG,GAC3C0G,EAAoBhI,KAAKkD,IAAI4E,EAAeC,EAAcxL,OAC1D0L,EAAWF,EAAcxL,MAAQyL,EAEvC,OADAF,GAAiBE,EACV,CAAE1G,MAAK2G,cAEhB,MAAO,CACLP,OAAQlI,EAAM6C,SAAWyF,EACzBzF,QAASyF,EACT3G,YACAwG,SAAUE,GAGZ,MAAO,CACLH,OAAQlI,EAAM6C,SAAWwF,EACzBxF,QAASwF,EACTF,SAAUE,GAKT,SAASK,GAAU1I,EAAoBoD,GAC5C,IAAKA,EAAK8E,OACR,MAAM,IAAIjH,MAAM,kBAGlB,GADAjB,EAAM6C,SAAWO,EAAKP,QAClB7C,EAAM6C,QAAU,EAClB,MAAM,IAAI5B,MAAM,6BjBfb,SAAyBjB,EAAoBoD,GAE7CA,EAAKzB,WAIVyB,EAAKzB,UAAU1B,QAAQ,SAAA0I,GACrB3I,EAAM2B,UAAUgH,EAAa7G,KAAK/E,MAAQ4L,EAAaF,SAEzB,IAA1BE,EAAaF,UAEfzI,EAAM2B,UAAUiH,OAAOD,EAAa7G,IAAK,KiBM7C+G,CAAgB7I,EAAOoD,GAKlB,SAAS0F,GAAa9I,EAAoBe,GAY/C,OAAOqH,GAAapI,EAXA,EAEKwB,EAAmBxB,EAAO,SAAC+I,GAClD,OAAIA,EAAE/L,OAASU,IAGS,IAApBqL,EAAEhL,OAAOoB,SAGL,IAAM4J,EAAEhL,OAAOoD,UAAU,SAAC6H,GAAD,OAAmBA,IAAMjI,QAKvD,SAASkI,GAAkBjJ,GAEhC,OAAOoI,GAAapI,EADA,EACoB,IAKnC,SAASkJ,GAAWlJ,EAAoB7C,GAC7C,IAAMmD,EAAWN,EAAM5C,IAAID,GAASJ,MAC9BoM,EACQ,YAAZhM,EACI,EACY,YAAZA,GAAqC,gBAAZA,EACzB,GACA,EACAiM,EACJ9I,EAAW,EAAI6I,EAAmBA,EAAmB7I,EAevD,OAAO8H,GAAapI,EAdAQ,KAAKC,IACvB,EACA2I,EAAepJ,EAAM5C,IAAID,GAAS+C,aAGbsB,EAAmBxB,EAAO,SAAC+I,GAChD,OAAIA,EAAE/L,OAASS,IAGO,IAAlBsL,EAAEM,KAAKlK,SAGH,IAAM4J,EAAEM,KAAKlI,UAAU,SAAC6H,GAAD,OAAiBA,IAAM7L,QAOnD,SAASmM,GAAqBtJ,EAAoBkD,GAavD,OAAOkF,GAAapI,EAZL0E,GAAiBxB,GACLE,KAEL5B,EAAmBxB,EAAO,SAAC+I,GAC/C,OAAIA,EAAE/L,OAASW,IAGO,IAAlBoL,EAAEQ,KAAKpK,SAGH,IAAM4J,EAAEQ,KAAKpI,UAAU,SAAC6H,GAAD,OAAeA,IAAM9F,QAQxD,SAASsG,GACPxJ,EACAuE,EACArB,EACAE,GAmBA,OAAOgF,GAAapI,EAAOoD,EAjBL5B,EAAmBxB,EAAO,SAAC+I,GAC/C,OAAIA,EAAE/L,OAASY,IAGO,IAAlBmL,EAAEQ,KAAKpK,SAKR,IACD4J,EAAEQ,KAAKpI,UACL,SAAAsI,GAAG,OACDA,EAAIlF,QAAUA,IACb,IAAMkF,EAAI5E,OAAO1D,UAAU,SAAAuI,GAAc,OAAIxG,IAAQwG,UAOzD,SAASC,GACd3J,EACAuE,EACArB,GAEA,IACM0G,EADShF,GAAuBL,EAAOrB,GAClBE,KAC3B,GAA2B,kBAAhBwG,EACT,MAAO,CAACJ,GAAkCxJ,EAAOuE,EAAOrB,EAAK0G,IAE7D,IAAMC,EAASD,EAAYnJ,IAAMmJ,EAAYlG,IAAM,EACnD,OAAOkC,MAAMkE,KAAK,IAAIlE,MAAMiE,GAAQxK,QACjCuC,IAAI,SAACmI,GAAD,OAAeH,EAAYlG,IAAMqG,IACrCnI,IAAI,SAAAwB,GAAI,OAAIoG,GAAkCxJ,EAAOuE,EAAOrB,EAAKE,KAIjE,SAAS4G,GAAchK,GAC5B,OAAOoI,GAAapI,EAAO,GAGtB,SAASiK,GAAmBjK,GACjC,OAAOoI,GAAapI,EAAO,IAUtB,SAASkK,GACdlK,EACAhD,EACAsK,EACApE,GAKA,IAAMiH,EAAStC,GAAoB7K,EAAMsK,EAAUpE,GAMnD,OAAOkF,GAAapI,EAJlBhD,IAASgI,GACJmF,EAAwC/G,KACxC+G,EAAwCnD,OC5M1C,IAAMoD,GAAoB,oBAGpBC,GAA+B,+BAG/BC,GAAmC,mCAGnCC,GAAuB,uB,+OCiC7B,SAASC,GACdxK,EACAhD,EACAsK,GAKA,OAAuB,IAHJlI,OAAOC,KAAKW,EAAMhD,IAAOmE,UAC1C,SAAAsJ,GAAc,OAAIA,IAAmBnD,IAwBlC,SAASoD,GACd1K,EACAhD,EACAsK,EACAG,GAEA,QAAK+C,GAAexK,EAAOhD,EAAMsK,KAMT,IAHJtH,EAAMhD,GAAMsK,GAAUnG,UACxC,SAAAwJ,GAAiB,OAAIA,IAAsBlD,IAKxC,SAASmD,GACd5K,EACAsH,GAEA,IAAMuD,EAAkBlD,GACtB3C,GACAsC,GACwBnB,WAE1B,IAAKqE,GAAexK,EAAOgF,GAAiBsC,GAC1C,OAAOuD,EAGT,IAAM1E,E,wVAAyC,IAAQ0E,GAgBvD,OAdA7K,EAAMgF,IAAiBsC,GAAUrH,QAAQ,SAAAwH,GACvC,IAAMqD,EAAcjD,GAClB7C,GACAsC,EACAG,GAEF,OAAQqD,EAAYnE,OAAO3J,MACzB,KAAK4J,GACHT,EAAW2E,EAAYnE,OAAOrB,YAAcwF,EAAYnE,OAAOxG,YAM9DgG,EAGF,SAAS4E,GACd/K,EACAhD,EACAsK,GAEA,OAAQkD,GAAexK,EAAOhD,EAAMsK,GAmB/B,SAAS0D,GACdhL,EACAhD,EACAsK,EACAG,GAEA,IAAK+C,GAAexK,EAAOhD,EAAMsK,GAC/B,OAAO,EAET,GAAIoD,GAAwB1K,EAAOhD,EAAMsK,EAAUG,GACjD,OAAO,EAGT,GAAIzK,IAASgI,GACX,OAAO,EAEP,GAAIhF,EAAMiL,wBAEL,IAAMjL,EAAMiL,sBAAsB9J,UAAU,SAAA+B,GAAG,OAAIA,IAAQoE,IAE5D,OAAO,EAGX,IAAM4D,EAvCV,SACElL,EACAsH,GAEA,OAAOtH,EAAMiF,IAAiBqC,GAC3B1F,IAAI,SAAA6F,GAMH,OALiBI,GACf5C,GACAqC,EACAG,GAEcT,QAEjBmE,OA0BcC,CAA0BpL,EAAOsH,GAC1CwD,EAAcjD,GAClB5C,GACAqC,EACAG,GAGF,OAAsB,IAAlByD,EAAO/L,QAAsC,IAAtB2L,EAAY9D,OAGhCxG,KAAKC,IAAL,MAAAD,KAAI,aAAQ0K,MAAYJ,EAAY9D,MAAQ,EC9JhD,SAASqE,GACdjJ,EACAkJ,GAEA,OAAQA,EAAOtO,MACb,KAAKC,GACH,OAAO0F,YAAQP,EAAW,SAAAQ,GAIxB,GAHA8F,GAAU9F,EAAY0I,EAAOlI,MDK9B,SACLpD,EACAhD,EACAsK,GAGA,GADAD,GAAoBrK,EAAMsK,GACtBkD,GAAexK,EAAOhD,EAAMsK,GAC9B,MAAM,IAAIrG,MAAM,uCAElBjB,EAAMhD,GAAMsK,GAAY,GCblBiE,CAAU3I,EAAW4I,OAAQF,EAAOG,WAAYH,EAAOpI,KAEnDoI,EAAOG,aAAezG,GACxB5H,EACEwF,EAAWxF,IACX,UACAkO,EAAOlI,KAAKP,aAET,CACL,IAAMjC,EAAO8K,GACXzG,GACAqG,EAAOpI,KAET9F,EACEwF,EAAWxF,IACXwD,EAAKmG,QACLuE,EAAOlI,KAAKP,SAIhBD,EAAW+I,QAAQtK,KAAKiK,KAE5B,KAAKrO,GACH,OAAO0F,YAAQP,EAAW,SAAAQ,GASxB,GARA8F,GAAU9F,EAAY0I,EAAOlI,MDG9B,SACLpD,EACAhD,EACAsK,EACAG,GAKA,GAHAJ,GAAoBrK,EAAMsK,GAC1BE,GAAwBxK,EAAMsK,EAAUG,IAEnC+C,GAAexK,EAAOhD,EAAMsK,GAC/B,MAAM,IAAIrG,MAAM,mCAElB,GAAIyJ,GAAwB1K,EAAOhD,EAAMsK,EAAUG,GACjD,MAAM,IAAIxG,MAAM,+CAGlBjB,EAAMhD,GAAMsK,GAAUjG,KAAKoG,GClBrBmE,CACEhJ,EAAW4I,OACXF,EAAOG,WACPH,EAAOhE,SACPgE,EAAOpI,KAGLoI,EAAOG,aAAezG,GACxB5H,EACEwF,EAAWxF,IACX,UACAkO,EAAOlI,KAAKP,aAET,CACL,IAAMjC,EAAO8K,GACXzG,GACAqG,EAAOhE,UAETlK,EACEwF,EAAWxF,IACXwD,EAAKmG,QACLuE,EAAOlI,KAAKP,SAIhBD,EAAW+I,QAAQtK,KAAKiK,KAM9B,OAAOlJ,EClFF,IAAMyJ,GAAiB,iBCAvB,IAAMC,GAAa,aAGbC,GAAwB,wBCH9B,IAAMC,GAAiB,iBAGjBC,GAAuB,uBCkB7B,SAASC,GACdlM,EACAmM,GAKA,OAA2B,IAHJ/M,OAAOC,KAAKW,GAAOmB,UACxC,SAAAiL,GAAiB,OAAIA,IAAsBD,IAKxC,SAASE,GACdrM,EACAmM,EACAG,GAEA,YAA4BC,IAAxBvM,EAAMmM,KAMc,IAHJnM,EAAMmM,GAAchL,UACtC,SAAAsD,GAAM,OAAIA,EAAOvB,MAAQoJ,IAKtB,SAASE,GAAiBxM,EAAoBkD,GACnD,OAAQgJ,GAAmBlM,EAAMiD,WAAYC,GAG/C,SAASuJ,GAAIC,EAAYC,GACvB,OAAOD,GAAKC,EAEd,SAASC,GAAKF,EAAYC,GACxB,OAAOD,GAAKC,EAuBP,SAASE,GACd7M,EACAuE,EACArB,GAEA,IAAKgJ,GAAmBlM,EAAOuE,GAC7B,OAAO,EAET,IAAMuI,EAAYlI,GAAuBL,EAAOrB,GAChD,OAAImJ,GAAyBrM,EAAOuE,EAAOrB,IAAQ4J,EAAUvJ,WACpDuJ,EAAUvJ,WAERuJ,EAAUtJ,cAClB5B,IAAI,SAAAc,GAAC,OAjCV,SACE1C,EACAuE,EACAwI,GAEA,MAA4B,kBAAjBA,EACFV,GAAyBrM,EAAOuE,EAAOwI,GAEvCA,EAAavJ,cACjB5B,IAAI,SAACiD,GAEJ,OADawH,GAAyBrM,EAAOuE,EAAOM,KAGrDmI,OACuB,OAAtBD,EAAa/P,KAAgByP,GAAMG,GACb,OAAtBG,EAAa/P,MAkBPiQ,CAAoBjN,EAAOuE,EAAO7B,KAC3CsK,OAAOJ,IAAM,GChFX,SAASM,GACd9K,EACAkJ,GAEA,OAAQA,EAAOtO,MACb,KAAKC,GACH,OAAO0F,YAAQP,EAAW,SAAAQ,GDkGzB,IACL5C,EACAmM,ECnGMzD,GAAU9F,EAAY0I,EAAOlI,MDkGnCpD,ECjGoB4C,EAAWK,WDoG/BmB,EAFA+H,EClG2Cb,EAAOpI,KDqGlDlD,EAAMmM,GAAgB,GCpGhBvJ,EAAW+I,QAAQtK,KAAKiK,KAE5B,KAAKrO,GACH,OAAO0F,YAAQP,EAAW,SAAAQ,GACxB8F,GAAU9F,EAAY0I,EAAOlI,MDuE9B,SACLpD,EACAmM,EACAG,EACA7I,GAKA,GAHAW,EAAkB+H,GAClB7H,EAAwB6H,EAAcG,IAEjCO,GAAsB7M,EAAOmM,EAAcG,GAC9C,MAAM,IAAIrL,MACR,uDACEkL,EACA,IACAG,GAGNtM,EAAMmM,GAAc9K,KAAK,CAAE6B,IAAKoJ,EAAW7I,YCvFrC0J,CACEvK,EAAWK,WACXqI,EAAO/G,MACP+G,EAAOpI,IACPoI,EAAO7H,SAETb,EAAW+I,QAAQtK,KAAKiK,KAI9B,OAAOlJ,EClCF,IAAMgL,GAAkB,kBCalBC,GAAyB,CACpC,CAACpP,KAAM,QAASjB,KAde,qBAe/B,CAACiB,KAAM,cAAejB,KAfS,qBAgB/B,CAACiB,KAAM,gBAAiBjB,KAhBO,qBAiB/B,CAACiB,KAAM,UAAWjB,KAjBa,qBAkB/B,CAACiB,KAAM,QAASjB,KAlBe,qBAmB/B,CAACiB,KAAM,UAAWjB,KAhBU,kBAiB5B,CAACiB,KAAM,gBAAiBjB,KAjBI,kBAkB5B,CAACiB,KAAM,YAAajB,KAlBQ,kBAmB5B,CAACiB,KAAM,eAAgBjB,KAnBK,kBAoB5B,CAACiB,KAAM,WAAYjB,KApBS,mBCyCvB,SAASsQ,GAAgBtN,EAAsB/B,GACpD,OAA4D,IAArD+B,EAAMmB,UAAU,SAAAoM,GAAM,OAAItP,IAASsP,EAAOtP,OAG5C,SAASuP,GAAaxN,EAAoB/B,GAC/C,IAAMkD,EAAYnB,EAAMqN,QAAQlM,UAAU,SAAA4I,GAAC,OAAI9L,IAAS8L,EAAE9L,OAC1D,OAAmB,IAAfkD,KAGWnB,EAAMqN,QAAQlM,GAClBpE,MAAQ,EAAI,GC7ClB,SAAS0Q,GACdrL,EACAkJ,GAEA,OAAQA,EAAOtO,MACb,KAAKC,GACH,OAAO0F,YAAQP,EAAW,SAAApC,GACxB0I,GAAU1I,EAAOsL,EAAOlI,MDazB,SACLpD,EACA/B,EACAlB,GAEA,IAAKuQ,GAAgBtN,EAAO/B,GAC1B,MAAM,IAAIgD,MAAM,uCAAyChD,GAE3D+B,EAAMC,QAAQ,SAAAsN,GACRA,EAAOtP,OAASA,IAClBsP,EAAOxQ,OAASA,KCtBdoD,CAASH,EAAMqN,QAAS/B,EAAOrN,KAAMqN,EAAOvO,OAC5CiD,EAAM2L,QAAQtK,KAAKiK,KAIzB,OAAOlJ,ECMF,SAASsL,GACd1N,EACAsL,GAEA,IAAKtL,EACH,OAAO0N,GAAcC,KAAuBrC,GAE9C,OAAQA,EAAOtO,MACb,KAAK4Q,EACL,KAAKA,EACL,KAAKA,EACL,KAAKA,EACH,OCjCC,SACLxL,EACAkJ,GAEA,OAAQA,EAAOtO,MACb,KAAKC,EACH,OAAO0F,YAAQP,EAAW,SAAAQ,GACxBA,EAAW3E,KAAOqN,EAAOrN,KACzB2E,EAAW+I,QAAQtK,KAAKiK,KAE5B,KAAKrO,EACH,OAAO0F,YAAQP,EAAW,SAAAQ,GACxBA,EAAWiL,QAAUvC,EAAOuC,QAC5BjL,EAAW+I,QAAQtK,KAAKiK,KAE5B,KAAKrO,EACH,OAAO0F,YAAQP,EAAW,SAAAQ,GACxBV,EAAQU,EAAY0I,EAAO3K,MAC3BiC,EAAW+I,QAAQtK,KAAKiK,KAE5B,KAAKrO,EACH,OAAO0F,YAAQP,EAAW,SAAAQ,GACxBA,EAAWkL,UAAYxC,EAAOwC,UAC9BlL,EAAW+I,QAAQtK,KAAKiK,KAI9B,OAAOlJ,EDMI2L,CAAc/N,EAAOsL,GAC9B,KAAKlO,EACH,OEhCC,SACLgF,EACAkJ,GAEA,OAAQA,EAAOtO,MACb,KAAKC,EACH,OAAO0F,YAAQP,EAAW,SAAAQ,GACxB8F,GAAU9F,EAAY0I,EAAOlI,MAC7BjD,EAASyC,EAAWxF,IAAKkO,EAAOlO,IAAKkO,EAAOvO,OAC5C6F,EAAW+I,QAAQtK,KAAKiK,KAI9B,OAAOlJ,EFmBI4L,CAAWhO,EAAOsL,GAC3B,KAAK2C,EACH,OAAON,KACT,KAAKnC,GACL,KAAKA,GACL,KAAKA,GACL,KAAKA,GACH,OAAOH,GAAcrL,EAAOsL,GAC9B,KAAKvN,GACL,KAAKA,GACH,OG1CC,SACLqE,EACAkJ,GAEA,OAAQA,EAAOtO,MACb,KAAKC,GACH,OAAO0F,YAAQP,EAAW,SAAAQ,GACxB8F,GAAU9F,EAAY0I,EAAOlI,MAC7B,IAAM3C,EAAMC,EAAckC,GAC1BzC,EAASyC,EAAW7E,OAAQuN,EAAOrN,KAAMwC,GACzCmC,EAAW+I,QAAQtK,KAAKiK,KAE5B,KAAKrO,GACH,OAAO0F,YAAQP,EAAW,SAAAQ,GACxB8F,GAAU9F,EAAY0I,EAAOlI,MAC7BhC,EAAcwB,EAAW7E,OAAQuN,EAAOhO,MAAOgO,EAAO9N,YACtDoF,EAAW+I,QAAQtK,KAAKiK,KAI9B,OAAOlJ,EHsBI8L,CAAclO,EAAOsL,GAC9B,KAAKrI,GACL,KAAKA,GACH,OAAOiK,GAAkBlN,EAAOsL,GAClC,KAAKK,GACH,OInDC,SACLvJ,EACAkJ,GAEA,OAAQA,EAAOtO,MACb,KAAKC,GACH,OAAOkR,GACL/L,EACAA,EAAUuJ,QAAQyC,MAAM,EAAG9C,EAAO+C,GAAK,IAE3C,QACE,OAAOjM,GJwCAkM,CAAetO,EAAOsL,GAC/B,KAAK+B,GACH,OAAOI,GAAezN,EAAOsL,GAC/B,QACE,OAAOtL,GKtDN,SAASmO,GACdnO,EACAuO,GACc,IAAD,uBACb,YAAqBA,EAArB,+CAA8B,CAC5BvO,EAAQ0N,GAAc1N,EADM,UADjB,kFAIb,OAAOA,ECJF,IAAMwO,GAA8B,CACzC,CACEC,OAAQ,YACRlP,YAAa,sTACbC,IAAK,UACLvB,KAAM,WACL,CACDwQ,OAAQ,QACRlP,YAAa,0QACbC,IAAK,SACLvB,KAAM,UACL,CACDwQ,OAAQ,aACRlP,YAAa,oTACbC,IAAK,WACLvB,KAAM,YACL,CACDwQ,OAAQ,WACRlP,YAAa,2UACbC,IAAK,UACLvB,KAAM,WACL,CACDwQ,OAAQ,WACRlP,YAAa,yTACbC,IAAK,SACLvB,KAAM,WCIH,SAASyQ,GAAaZ,GAE3B,ODFK,SAA2BA,GAEhC,IADuBU,GAAWhM,KAAK,SAACmM,GAAD,OAAoCA,EAAcnP,MAAQsO,IACxE,MAAM,IAAI7M,MAAM,sBAAwB6M,EAAY,KCD7Ec,CAAiCd,GAC1B,CAAEA,YAAW9Q,KAAMC,GAGrB,SAASiF,GAAQvB,GAEtB,O5CsCK,SAAsBA,GAE3B,IADkBrB,EAAMkD,KAAK,SAACF,GAAD,OAAyBA,EAAS9C,MAAQmB,IAErE,MAAM,IAAIM,MAAM,iBAAmBN,EAAO,K4C1C5CkO,CAAuBlO,GAChB,CAAEA,OAAM3D,KAAMC,GCvBhB,SAAS6R,GACdxR,EACAE,EACA4F,GAEA,GAA0B,IAAtB5F,EAAW2B,OACb,MAAM,IAAI8B,MAAM,oBAElB,MAAO,CAAEmC,OAAM9F,QAAOE,aAAYR,KAAMC,ICjBnC,SAAS8R,KACd,MAAO,CACLjB,eAAWvB,EACXsB,aAAStB,EACTtO,UAAMsO,EACN5L,UAAM4L,EAEN1J,QAAS,EACTC,aAAc,EAEd6I,QJNK,CKTA,CAAE3O,KAAMC,IDiBbG,IAAK4R,IACLxD,OpBJK,CACLxG,gBAAiB,GACjBC,gBAAiB,GACjBgG,sBAAuB,IoBEvBhI,WfVK,GeWLlF,OAAQkR,IACR5B,QXlBKA,GAAQzL,IAAI,SAAC2L,GAClB,MAAO,CAAEtP,KAAMsP,EAAOtP,KAAMlB,MAAO,EAAGC,KAAMuQ,EAAOvQ,QWmBnDqF,QrCjBK,GqCkBLV,UvCzBK,IuC8CF,SAASgM,KACd,OAAOoB,KExCT,IAAMG,GAAcC,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2DA8CN,SAASC,GAAgBC,EAAeC,GACtCC,UAAUC,cACPC,SAASJ,GACTK,KAAK,SAAAC,GACJA,EAAaC,cAAgB,WAC3B,IAAMC,EAAmBF,EAAaG,WACd,MAApBD,IAGJA,EAAiBE,cAAgB,WACA,cAA3BF,EAAiBjQ,QACf2P,UAAUC,cAAcQ,YAI1BC,QAAQC,IACN,gHAKEZ,GAAUA,EAAOa,UACnBb,EAAOa,SAASR,KAMlBM,QAAQC,IAAI,sCAGRZ,GAAUA,EAAOc,WACnBd,EAAOc,UAAUT,UAO5BU,MAAM,SAAAC,GACLL,QAAQK,MAAM,4CAA6CA,K,2HCrClDC,I,mBA/Db,WAAYC,GAAa,IAAD,+BACtB,8CAAMA,KAEDC,OAAS,EAAKA,OAAOC,KAAZ,iBACd,EAAK9Q,MAAQ,CACX+Q,QAAQ,GALY,E,wEAStBC,KAAKC,SAAS,CACZF,QAASC,KAAKhR,MAAM+Q,W,+BAKtB,OACE,uBAAKG,UAAU,UACb,sBAAIA,UAAU,QACZ,gBAACC,GAAA,EAAD,CAAMC,GAAG,KACP,0BACE,sCAGJ,gBAACD,GAAA,EAAD,CAAMC,GAAG,WACP,qCAEF,gBAACD,GAAA,EAAD,CAAMC,GAAG,QACP,kCAEF,gBAACD,GAAA,EAAD,CAAMC,GAAG,YACP,sCAEF,gBAACD,GAAA,EAAD,CAAMC,GAAG,cACP,wCAEF,gBAACD,GAAA,EAAD,CAAMC,GAAG,eACP,yCAEF,gBAACD,GAAA,EAAD,CAAMC,GAAG,WACP,0BAAK,eAEP,gBAACD,GAAA,EAAD,CAAMC,GAAG,eACP,yCAEF,gBAACD,GAAA,EAAD,CAAMC,GAAG,YACP,uCAGJ,sBAAIF,UAAU,SACZ,gBAACC,GAAA,EAAD,CAAMC,GAAG,UACP,yCAEF,gBAACD,GAAA,EAAD,CAAMC,GAAG,WACP,0BACE,gBAAC,KAAD,CAAMnT,KAAK,gB,GAvDDoT,kBCITC,I,6LAJX,OAAO,2BAASJ,UAAU,aAAaF,KAAKJ,MAAMW,c,GAF/BF,kBCMRG,I,6LAJX,OAAO,2BAASN,UAAU,YAAYF,KAAKJ,MAAMW,c,GAF/BF,kBCEhBI,GAA6B,CACjCC,QAAS,QACTC,UAAW,UAaEC,G,sLARX,OACE,sBAAIH,MAAOA,IACT,wBAAMP,UAAU,qBAAqBF,KAAKJ,MAAMiB,Y,GAJ9BR,iBCsJXS,G,YA1Hb,WAAYlB,GAAuB,IAAD,+BAChC,8CAAMA,KAED5Q,MAAQ,CACX+R,cAAc,EACdC,MAAM,EACNjV,MAAO,EAAK6T,MAAMqB,QAAU,EAAKrB,MAAMqB,QAAU,IAGnD,EAAKC,UAAY,EAAKA,UAAUpB,KAAf,iBACjB,EAAKqB,QAAU,EAAKA,QAAQrB,KAAb,iBACf,EAAKsB,UAAY,EAAKA,UAAUtB,KAAf,iBACjB,EAAKuB,OAAS,EAAKA,OAAOvB,KAAZ,iBACd,EAAKwB,uBAAyB,EAAKA,uBAAuBxB,KAA5B,iBAC9B,EAAKyB,aAAe,EAAKA,aAAazB,KAAlB,iBACpB,EAAK0B,mBAAqB,EAAKA,mBAAmB1B,KAAxB,iBAC1B,EAAK2B,oBAAsB,EAAKA,oBAAoB3B,KAAzB,iBAC3B,EAAK4B,aAAe,EAAKA,aAAa5B,KAAlB,iBAjBY,E,6FAThCF,EACA5Q,GAKA,OAHKA,EAAMgS,OACThS,EAAMjD,MAAQ6T,EAAMqB,QAAUrB,EAAMqB,QAAU,IAEzCjS,M,+CAwBP,OAAOgR,KAAKhR,MAAMgS,KAAOhB,KAAKwB,qBAAuBxB,KAAK2B,gB,kCAItD3B,KAAKJ,MAAMgC,QACb5B,KAAKC,SAAS,CAAEe,MAAM,EAAMD,cAAc,M,gCAK5Cf,KAAKC,SAAS,CAAEe,MAAM,EAAOD,cAAc,IAC3C,IAAMc,EAAsB7B,KAAKsB,yBAE/BtB,KAAKhR,MAAMjD,QAAUiU,KAAKJ,MAAMqB,SAChCY,EAAoB1T,OAAS,GAE7B6R,KAAKJ,MAAMkC,SAAS9B,KAAKhR,MAAMjD,S,kCAKjCiU,KAAKC,SAAS,CAAEc,cAAef,KAAKhR,MAAM+R,iB,6BAG7BvS,GACbwR,KAAKC,SAAS,CAAElU,MAAOyC,M,+CAGiB,IAAD,OACvC,OAAOwR,KAAKJ,MAAMjN,OACf/B,IACC,gBAAGpC,EAAH,EAAGA,IAAKqS,EAAR,EAAQA,MAAR,OAA+BrS,IAAQ,EAAKQ,MAAMjD,MAAQ8U,EAAQ,KAEnE7P,OAAO,SAAC+Q,GAAD,MAAqB,KAANA,IACtBC,KAAK,Q,qCAIR,OAAO,gBAAC,GAAD,CAAanB,MAAOb,KAAKJ,MAAMhD,W,mCAGnBiF,GACnB,IAAMI,EACJ,0BAAQC,QAASlC,KAAKmB,QAASgB,MAAM,WACnC,gBAAC,KAAD,CAAMlV,KAAK,WAGTmV,EACJ,0BAAQF,QAASlC,KAAKmB,QAASgB,MAAM,UACnC,gBAAC,KAAD,CAAMlV,KAAK,WAGf,OAAO4U,EAAoB1T,OAAS,EAAI8T,EAAQG,I,4CAGJ,IAAD,OAC3C,OAAOpC,KAAKJ,MAAMjN,OAAO/B,IAAI,YAA+B,IAA5BpC,EAA2B,EAA3BA,IAAKqS,EAAsB,EAAtBA,MAEnC,OACE,uBAAKrS,IAAKA,EAAK0T,QAFA,kBAAM,EAAKb,OAAO7S,KAG9BqS,O,2CAOP,IAAMgB,EAAsB7B,KAAKsB,yBACjC,OACE,2BACE,2BAAMtB,KAAK0B,gBACX,2BACE,2BACE,2BACGG,EAAoB1T,OAAS,EAC1B0T,EACA,YAAc7B,KAAKJ,MAAMhD,QAE/B,2BAAMoD,KAAKyB,wBAEZzB,KAAKuB,aAAaM,O,oCAOzB,IAAMA,EAAsB7B,KAAKsB,yBACjC,OACE,uBAAKY,QAASlC,KAAKkB,UAAWmB,KAAK,UACjC,2BAAMrC,KAAK0B,gBACX,2BACGG,EAAoB1T,OAAS,EAC1B0T,EACA7B,KAAKhR,MAAMjD,Y,GA9HHsU,iBCUPiC,G,sLAzBX,OACE,gBAAC,GAAD,CACE1F,OAAO,sBACPqE,QAASjB,KAAKJ,MAAM7T,MACpB4G,OAAQ6K,GACLrD,KAAK,SAACuB,EAAmBC,GACxB,OAAID,EAAEzO,KAAO0O,EAAE1O,MACL,EAENyO,EAAEzO,KAAO0O,EAAE1O,KACN,EAEF,IAER2D,IAAI,SAAC8K,GAAD,MAAwB,CAC3BlN,IAAKkN,EAAElN,IACPqS,MAAOnF,EAAEzO,QAEb6U,SAAU9B,KAAKJ,MAAM2C,SACrBX,OAAQ5B,KAAKJ,MAAMgC,a,GArBHvB,iBC8BTmC,mBAtBf,SAAyBxT,GACvB,MAAO,CACL4S,YAA4BrG,IAApBvM,EAAM8N,UACd/Q,WAA2BwP,IAApBvM,EAAM8N,UAA0B9N,EAAM8N,UAAY,KAI7D,SACE2F,GAEA,MAAO,CACLF,SAAU,SAACvK,GAAD,OAAeyK,EAASC,GAA2B1K,OAIjE,SACE2K,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIbF,I,wCC2EaQ,G,YAlGb,WAAYlD,GAAwB,IAAD,+BACjC,8CAAMA,KAED5Q,MAAQ,CACXgS,MAAM,EACNjV,MAAO,EAAK6T,MAAMqB,QAAU,EAAKrB,MAAMqB,QAAU,IAGnD,EAAK8B,0BAA4B,EAAKA,0BAA0BjD,KAA/B,iBACjC,EAAKoB,UAAY,EAAKA,UAAUpB,KAAf,iBACjB,EAAKqB,QAAU,EAAKA,QAAQrB,KAAb,iBACf,EAAKkD,WAAa,EAAKA,WAAWlD,KAAhB,iBAClB,EAAKmD,WAAa,EAAKA,WAAWnD,KAAhB,iBAClB,EAAKoD,aAAe,EAAKA,aAAapD,KAAlB,iBAba,E,wEAiBjC,OAAOE,KAAKhR,MAAMgS,KAAOhB,KAAKiD,aAAejD,KAAKkD,iB,gDAGnBC,GAC/BnD,KAAKC,SAAS,CACZlU,MAAOoX,EAAUlC,QAAUkC,EAAUlC,QAAU,O,kCAK7CjB,KAAKJ,MAAMgC,QACb5B,KAAKC,SAAS,CAAEe,MAAM,M,gCAKxBhB,KAAKC,SAAS,CACZe,MAAM,EACNjV,MAAOiU,KAAKhR,MAAMjD,MAAMqX,SAEtBpD,KAAKJ,MAAMyD,SAASrD,KAAKhR,MAAMjD,QAC7BiU,KAAKhR,MAAMjD,QAAUiU,KAAKJ,MAAMqB,SAClCjB,KAAKJ,MAAMkC,SAAS9B,KAAKhR,MAAMjD,S,iCAKlBgW,GACjB/B,KAAKC,SAAS,CAAElU,MAAOgW,EAAEuB,OAAOvX,U,mCAGbwX,GACnB,IAAMtB,EACJ,gBAACuB,GAAA,EAAD,CAAQtB,QAASlC,KAAKmB,QAASgB,MAAM,WACnC,gBAAC,KAAD,CAAMlV,KAAK,WAGTmV,EACJ,gBAACoB,GAAA,EAAD,CAAQtB,QAASlC,KAAKmB,QAASgB,MAAM,UACnC,gBAAC,KAAD,CAAMlV,KAAK,WAGf,OAAOsW,EAAetB,EAAQG,I,qCAI9B,OACE,uBAAKF,QAASlC,KAAKkB,UAAWmB,KAAK,UACjC,gBAACoB,GAAA,EAAD,KACE,gBAACC,GAAA,EAAD,CAAiBC,UAAU,WACxB3D,KAAKJ,MAAMhD,QAEd,uBAAKsD,UAAU,gBAAgBF,KAAKhR,MAAMjD,W,mCAOhD,IAAMwX,EAAevD,KAAKJ,MAAMyD,SAASrD,KAAKhR,MAAMjD,OACpD,OACE,2BACE,gBAAC0X,GAAA,EAAD,KACE,gBAACC,GAAA,EAAD,CAAiBC,UAAU,WACxB3D,KAAKJ,MAAMhD,QAEd,gBAACgH,GAAA,EAAD,CACErB,SAAUvC,KAAKgD,WACfjX,MAAOiU,KAAKhR,MAAMjD,MAClB8X,YAAa7D,KAAKhR,MAAMjD,MACxB+X,MAAOP,IAET,gBAACG,GAAA,EAAD,CAAiBC,UAAU,UACxB3D,KAAKuB,aAAagC,U,GA3FRlD,iBCKR0D,G,sLAfX,OACE,gBAAC,GAAD,CACEnH,OAAO,oBACPqE,QAASjB,KAAKJ,MAAM7T,MACpBsX,SAAUrD,KAAKgE,gBACflC,SAAU9B,KAAKJ,MAAM2C,a,sCAKHvK,GACtB,OAAOA,EAAEoL,OAAOjV,OAAS,M,GAbPkS,iBC4BPmC,mBArBf,SAAyBxT,GACvB,MAAO,CACLjD,WAAyBwP,IAAlBvM,EAAM6N,QAAwB7N,EAAM6N,QAAU,KAIzD,SACE4F,GAEA,MAAO,CACLF,SAAU,SAACvK,GAAD,OAAeyK,EdUpB,CAAEzW,KAAMC,EAA8B4Q,QcVgB7E,OAI/D,SACE2K,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIbuB,ICpBaE,G,8MAZNC,OAAS,WACd,OACE,gBAACT,GAAA,EAAD,KACE,gBAACC,GAAA,EAAD,CAAiBC,UAAU,WACxB,EAAK/D,MAAMhD,QAEd,uBAAKsD,UAAU,gBAAgB,EAAKN,MAAM7T,S,8BAPzBsU,iBCMV8D,G,sLAJX,OAAO,gBAAC,GAAD,CAAYvH,OAAO,UAAU7Q,MAAOiU,KAAKJ,MAAM7T,MAAMqY,iB,GAF1C/D,iBCIPmC,mBANf,SAAyBxT,GACvB,MAAO,CACLjD,MAAOiD,EAAM6C,UAIF2Q,CAAyB2B,ICIzBE,G,sLANX,OACE,gBAAC,GAAD,CAAYzH,OAAO,eAAe7Q,MAAOiU,KAAKJ,MAAM7T,MAAMqY,iB,GAHrC/D,iBCMZmC,mBANf,SAAyBxT,GACvB,MAAO,CACLjD,MAAOiD,EAAM8C,eAIF0Q,CAAyB6B,ICYzBC,G,sLAfX,OACE,gBAAC,GAAD,CACE1H,OAAO,iBACPqE,QAASjB,KAAKJ,MAAM7T,MACpBsX,SAAUrD,KAAKgE,gBACflC,SAAU9B,KAAKJ,MAAM2C,a,sCAKHvK,GACtB,OAAOA,EAAEoL,OAAOjV,OAAS,M,GAbVkS,iBC4BJmC,mBArBf,SAAyBxT,GACvB,MAAO,CACLjD,WAAsBwP,IAAfvM,EAAM/B,KAAqB+B,EAAM/B,KAAO,KAInD,SACEwV,GAEA,MAAO,CACLF,SAAU,SAACvK,GAAD,OAAeyK,ErBMpB,CAAEzW,KAAMC,EAA2BgB,KqBNgB+K,OAI5D,SACE2K,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIb8B,IChBaC,G,sLAZX,OACE,gBAAC,GAAD,CACE3H,OAAO,iBACPqE,QAASjB,KAAKJ,MAAMjQ,KAAOqQ,KAAKJ,MAAMjQ,KAAK1C,KAAO,GAClD0F,OAAQrE,EAAMsC,IAAI,kBAA0B,CAAEiQ,MAA5B,EAAG5T,KAAmCuB,IAAtC,EAAYA,OAC9BsT,SAAU9B,KAAKJ,MAAM2C,SACrBX,OAAQ5B,KAAKJ,MAAMgC,a,GARRvB,iBC4BJmC,mBAtBf,SAAyBxT,GACvB,MAAO,CACL4S,YAA4BrG,IAApBvM,EAAM8N,UACdnN,KAAMX,EAAMW,OAIhB,SACE8S,GAEA,MAAO,CACLF,SAAU,SAACvK,GAAD,OAAeyK,EAASC,GAAsB1K,OAI5D,SACE2K,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIb+B,ICZaC,G,sLAhBX,OACE,2BACE,gBAAC,GAAD,oBACA,gBAAC,GAAD,KACE,gBAAC,GAAD,MACA,gBAAC,GAAD,MACA,gBAAC,GAAD,MACA,gBAAC,GAAD,MACA,gBAAC,GAAD,MACA,gBAAC,GAAD,Y,GAXanE,iBCmFRoE,G,YA3Eb,WAAY7E,GAA2B,IAAD,+BACpC,8CAAMA,KAED5Q,MAAQ,CACXgS,MAAM,GAGR,EAAKE,UAAY,EAAKA,UAAUpB,KAAf,iBACjB,EAAKqB,QAAU,EAAKA,QAAQrB,KAAb,iBACf,EAAK4E,MAAQ,EAAKA,MAAM5E,KAAX,iBACb,EAAK4B,aAAe,EAAKA,aAAa5B,KAAlB,iBACpB,EAAKyB,aAAe,EAAKA,aAAazB,KAAlB,iBAXgB,E,wEAepC,OAAKE,KAAKhR,MAAMgS,KAWZ,gBAACyC,GAAA,EAAD,KACE,gBAACC,GAAA,EAAD,CAAiBC,UAAU,WACxB3D,KAAKJ,MAAM3S,MAEd,uBAAKiT,UAAU,gBAAgBF,KAAKJ,MAAM7T,OAC1C,gBAAC2X,GAAA,EAAD,CAAiBC,UAAU,UACxB3D,KAAKJ,MAAM+E,OAAS3E,KAAKuB,aAAa,OAAQvB,KAAK0E,OAAS,KAC5D1E,KAAKuB,aAAa,QAASvB,KAAKmB,WAhBrC,gBAACsC,GAAA,EAAD,CAAYvB,QAASlC,KAAKkB,UAAWmB,KAAK,UACxC,gBAACqB,GAAA,EAAD,CAAiBC,UAAU,WACxB3D,KAAKJ,MAAM3S,MAEd,uBAAKiT,UAAU,gBAAgBF,KAAKJ,MAAM7T,U,2CAoB5CiU,KAAKhR,MAAMgS,OAAShB,KAAKJ,MAAM+E,QACjC3E,KAAKmB,Y,kCAKHnB,KAAKJ,MAAM+E,QACb3E,KAAKC,SAAS,CAAEe,MAAM,M,gCAKxBhB,KAAKC,SAAS,CACZe,MAAM,M,8BAKRhB,KAAKJ,MAAMgF,U,qCAIX,OAAO,gBAAC,GAAD,CAAa/D,MAAOb,KAAKJ,MAAM3S,S,mCAGnB4X,EAAcC,GACjC,OACE,gBAACtB,GAAA,EAAD,CAAQtB,QAAS4C,GACf,gBAAC,KAAD,CAAM7X,KAAM4X,S,GAzEMxE,iBCoBX0E,G,YApBb,WAAYnF,GAAqB,IAAD,+BAC9B,8CAAMA,KACDgF,MAAQ,EAAKA,MAAM9E,KAAX,iBAFiB,E,wEAK9B,OACE,gBAAC,GAAD,CACE7S,KAAM+S,KAAKJ,MAAM3S,KACjBlB,MAAOiU,KAAKJ,MAAM7T,MAClB4Y,OAAQ3E,KAAKJ,MAAM+E,QAAU3E,KAAKJ,MAAMxN,KAAK8E,OAC7C0N,MAAO5E,KAAK4E,U,8BAMhB5E,KAAKJ,MAAMgF,MAAM5E,KAAKJ,MAAMxN,U,GAjBZiO,iBCsCLmC,mBA3Bf,SAAyBxT,EAAoB4Q,GAC3C,MAAO,CACL+E,OAAQrU,EAAYtB,EAAO4Q,EAAM3S,MACjCmF,KAAM0F,GAAa9I,EAAO4Q,EAAM3S,MAChCA,KAAM2S,EAAM3S,KACZlB,MAAOiD,EAAMjC,OAAO6S,EAAM3S,MAAMlB,QAIpC,SACE0W,EACA7C,GAEA,MAAO,CACLgF,MAAO,SAACxS,GACNqQ,E1BvBC,SAAmBxV,EAAkBmF,GAC1C,MAAO,CAAEA,OAAMnF,OAAMjB,KAAMC,I0BsBdsR,CAAkBqC,EAAM3S,KAAMmF,OAK7C,SACEuQ,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIbuC,ICxCIC,I,mBAYJ,WAAYpF,GAA0B,IAAD,+BACnC,8CAAMA,KAJAqF,WAG6B,IAF7BC,cAE6B,EAGnC,EAAKA,SAAW,EAAKtF,MAAMsF,SACvB,EAAKtF,MAAMsF,SACXF,EAAWG,aAAaD,SAE5B,EAAKD,MAAQ,EAAKrF,MAAMqF,MACpB,EAAKrF,MAAMqF,MACXD,EAAWG,aAAaF,MAE5B,EAAKjW,MAAQ,CACXoW,SAAS,EACTC,MAAO,IAGT,EAAKC,YAAc,EAAKA,YAAYxF,KAAjB,iBACnB,EAAKyF,OAAS,EAAKA,OAAOzF,KAAZ,iBACd,EAAK0F,QAAU,EAAKA,QAAQ1F,KAAb,iBAlBoB,E,wEAsBnC,OACE,uBAAKI,UAAU,gBACb,uBAAKA,UAAU,cACb,uBAAKA,UAAU,yBAAyBF,KAAKyF,gBAC7C,uBAAKvF,UAAU,uBACb,yBACEA,UAAU,mBACVqF,OAAQvF,KAAKuF,OACbhD,SAAUvC,KAAKsF,YACfE,QAASxF,KAAKwF,QACdzZ,MAAOiU,KAAKhR,MAAMqW,QAEpB,uBAAKnF,UAAU,+BACZF,KAAK0F,mBACL1F,KAAK2F,qB,qCAShB,OAAQ3F,KAAKJ,MAAMgG,OAAoBhV,IAAI,SAAAoG,GAAC,OAC1C,wBAAMxI,IAAKwI,EAAGkJ,UAAU,oBACrBlJ,O,yCAKqB,IAAD,OACzB,OAAOgJ,KAAK6F,uBAAsB,GAC/B7U,OAAO,SAACyC,GAAD,OAAiBA,EAAO,EAAKyR,UAAU/W,OAAS,IACvD6C,OAAO,SAAAyC,GACN,IAAMoN,EAAQpN,EAAO,EAAKyR,UACpB7H,EAAK5J,EAAO,EAAKwR,OAEvB,SAAKpE,IAAUxD,KAKhBzM,IAAI,SAAC6C,GACJ,IAAMoN,EAAQpN,EAAO,EAAKyR,UACpB7H,EAAK5J,EAAO,EAAKwR,OAKvB,OACE,wBAAMzW,IAAK6O,EAAIyI,YALD,WACd,EAAKlG,MAAMmG,MAAM1I,GACjB,EAAK2I,eAIFnF,O,qCAMiC,IAAD,OACzC,GAAKb,KAAKhR,MAAMoW,SAIdpF,KAAKJ,MAAMqG,UACXjG,KAAKhR,MAAMqW,MAAMlX,OAAS,GACkB,IAA5C6R,KAAK6F,uBAAsB,GAAM1X,OACjC,CAKA,OACE,wBAAMkP,GAAG,SAASyI,YALJ,WACd,EAAKlG,MAAMmG,MAAM,EAAK/W,MAAMqW,OAC5B,EAAKW,eAGL,qBACqBhG,KAAKhR,MAAMqW,U,gCAOpCrF,KAAKC,SAAS,CACZmF,SAAS,M,oEAUOc,GAClBlG,KAAKC,SAAS,CACZoF,MAAOa,EAAM5C,OAAOvX,MAAMqX,W,mCAK5BpD,KAAKC,SAAS,CACZoF,MAAO,O,4CAImBc,GAAwB,IAAD,OACnD,IAAKnG,KAAKhR,MAAMoW,QACd,MAAO,GAET,IAAMgB,EAAYpG,KAAKhR,MAAMqW,MAAMgB,cAAcjD,OAEjD,OAAOpD,KAAKJ,MAAMtN,QACftB,OAAO,SAACyC,GAEP,OAAI,EAAKmM,MAAMgG,SACL,EAAKhG,MAAMgG,OAAOU,KAAK,SAAAC,GAC7B,OAAOA,IAAU9S,EAAO,EAAKyR,cAMlClU,OAAO,SAACyC,GACP,IAAMoN,EAAQpN,EAAO,EAAKyR,UAC1B,IAAKrE,EACH,OAAO,EAGT,IAAM2F,EAAY3F,EAAMwF,cAAcjD,OAEtC,OAAK+C,GAAS,EAAKnX,MAAMqW,MAAMlX,OAAS,GACG,IAAlCqY,EAAUrT,QAAQiT,IAChBD,GACFC,IAAcI,Q,GApKNnG,kBAAnB2E,GAIUG,aAAe,CAC3BF,MAAO,KACPC,SAAU,QAsKCF,UClCAyB,G,YAnIb,WAAY7G,GAAgC,IAAD,+BACzC,8CAAMA,KACD5Q,MAAQ,CACXgS,MAAM,GAGR,EAAKE,UAAY,EAAKA,UAAUpB,KAAf,iBACjB,EAAKqB,QAAU,EAAKA,QAAQrB,KAAb,iBACf,EAAKyD,aAAe,EAAKA,aAAazD,KAAlB,iBAEpB,EAAK4G,cAAgB,EAAKA,cAAc5G,KAAnB,iBACrB,EAAKyB,aAAe,EAAKA,aAAazB,KAAlB,iBACpB,EAAK6G,yBAA2B,EAAKA,yBAAyB7G,KAA9B,iBAChC,EAAKoD,aAAe,EAAKA,aAAapD,KAAlB,iBACpB,EAAKmD,WAAa,EAAKA,WAAWnD,KAAhB,iBAduB,E,wEAkBzC,OAAKE,KAAKhR,MAAMgS,KAGPhB,KAAKiD,aAFLjD,KAAKkD,iB,mCAMK2B,EAAc1C,EAAe2C,GAChD,OACE,gBAACtB,GAAA,EAAD,CAAQtB,QAAS4C,EAAG3C,MAAOA,GACzB,gBAAC,KAAD,CAAMlV,KAAM4X,O,iDAMhB,OAAO7E,KAAKJ,MAAMgH,OAAOhW,IAAI,SAACpE,EAAoByG,GAChD,OAAQA,EAAQ,EAAI,KAAO,IAAMzG,M,qCAKnC,IAAMmY,EAAS3E,KAAKJ,MAAM1S,aAAaoZ,KACrC,SAAA7S,GAAM,OAAIA,EAAOkR,QAAUlR,EAAOrB,KAAK8E,SAEzC,OACE,gBAACuM,GAAA,EAAD,CAAYvB,QAASlC,KAAKkB,UAAWmB,KAAK,UACxC,uBAAKnC,UAAU,gBAAgBF,KAAK2G,4BACnChC,EACC,gBAACjB,GAAA,EAAD,CAAiBC,UAAU,UACxB3D,KAAKuB,aAAa,OAAQ,UAAWvB,KAAKkB,YAG7C,M,mCAON,IAAM2F,EAAa7G,KAAKJ,MAAM1S,aAAa0D,IAAI,SAAApE,GAC7C,MAAO,CAAE6Q,GAAI7Q,EAAWS,KAAMA,KAAMT,EAAWS,QAGjD,OACE,gBAACwW,GAAA,EAAD,KACE,gBAAC,GAAD,CACEwC,UAAU,EACVf,SAAS,OACTa,MAAO/F,KAAK0G,cACZpU,QAASuU,EACTjB,OAAQ5F,KAAKJ,MAAMgH,SAErB,gBAAClD,GAAA,EAAD,CAAiBC,UAAU,UACxB3D,KAAKuB,aAAa,QAAS,UAAWvB,KAAKmB,a,kCAOnCnB,KAAKJ,MAAM1S,aAAaoZ,KAAK,SAAA7S,GAAM,OAAIA,EAAOkR,UAE3D3E,KAAKC,SAAS,CAAEe,MAAM,M,gCAKxBhB,KAAKC,SAAS,CACZe,MAAM,M,mCAIWzU,GACnB,OAGS,IAFPyT,KAAKJ,MAAMgH,OAAOzW,UAChB,SAAA3D,GAAU,OAAID,IAAmBC,M,oCAKjBA,GACpB,GAA0B,IAAtBA,EAAW2B,QAGV6R,KAAKuD,aAAa/W,GAAvB,CAIA,IAAMsa,EAAa9G,KAAKJ,MAAM1S,aAAaiD,UAAU,SAAA4W,GACnD,OAAOA,EAAU9Z,OAAST,IAE5B,IAAoB,IAAhBsa,EACE9G,KAAKJ,MAAM1S,aAAa4Z,GAAYnC,QACtC3E,KAAKJ,MAAMgF,MACT5E,KAAKJ,MAAM1S,aAAa4Z,GAAY7Z,KACpC+S,KAAKJ,MAAM1S,aAAa4Z,GAAY1U,UAGnC,CACL,IAAM4U,EAAqBhH,KAAKJ,MAAM1S,aAAaiD,UACjD,SAAAsD,GAAM,OAA2B,IAAvBA,EAAOxG,KAAKkB,SAEpB6R,KAAKJ,MAAM1S,aAAa8Z,GAAoBrC,QAC9C3E,KAAKJ,MAAMgF,MACTpY,EACAwT,KAAKJ,MAAM1S,aAAa8Z,GAAoB5U,Y,GAhIvBiO,iBCQhB4G,G,sLAVX,OACE,gBAAC,GAAD,CACEL,OAAQ5G,KAAKJ,MAAMgH,OACnB1Z,aAAc8S,KAAKJ,MAAM1S,aACzB0X,MAAO5E,KAAKJ,MAAMgF,Y,GANCvE,iBC4DZmC,mBA9Cf,SAAyBxT,EAAoB4Q,GAC3C,IAAMsH,EAA4B,CAChCvC,OAAQpU,EAAiBvB,EAAO4Q,EAAMtT,MAAO,IAC7C8F,KAAM6F,GAAkBjJ,GACxB/B,KAAM,IAGFka,EAASvX,EAAKgQ,EAAMtT,OAAOY,aAAaia,OAC5CnY,EAAMjC,OAAO6S,EAAMtT,OAAOY,cAEtBka,EAAQD,EACXnW,OAAO,SAACqW,EAAMC,GAAP,OAAeH,EAAOhU,QAAQkU,KAAUC,IAC/CnN,OAEGoN,EAAS,CACbX,OAAQ5X,EAAMjC,OAAO6S,EAAMtT,OAAOY,aAClCA,aAAcka,EAAMxW,IAAI,SAACpE,GACvB,MAAO,CACLmY,OAAQpU,EAAiBvB,EAAO4Q,EAAMtT,MAAOE,GAC7C4F,KAAM6F,GAAkBjJ,GACxB/B,KAAMT,MAKZ,OADA+a,EAAOra,aAAamD,KAAK6W,GAClBK,GAGT,SACE9E,EACA7C,GAEA,MAAO,CACLgF,MAAO,SAACpY,EAAoB4F,GAC1BqQ,EAASlF,GAA2BqC,EAAMtT,MAAOE,EAAY4F,OAKnE,SACEuQ,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIbyE,ICpDaO,I,6LAnBX,OACE,sBAAItH,UAAU,eACX9R,OAAOC,KAAKtB,GAAQ6D,IAAI,SAAC3D,GACxB,OACE,sBAAIuB,IAAKvB,EAAMiT,UAAU,QACvB,uBAAKA,UAAU,aACb,gBAAC,GAAD,CAAOjT,KAAMA,KAEf,uBAAKiT,UAAU,aACb,gBAAC,GAAD,CAAc5T,MAAOW,a,GAXhBoT,kBCgBNoH,G,sLAbX,OACE,2BACE,gBAAC,GAAD,KACE,gBAAC7D,GAAA,EAAD,CAAOC,YAAY,YAErB,gBAAC,GAAD,KACE,gBAAC,GAAD,Y,GARgBxD,iB,ICyEXqH,G,sLApCX,IAlBA,IAAMC,EAAoB3H,KAAKJ,MAAMvD,QAAQrL,OAC3C,SAAA+H,GAAC,M5C7B0B,sB4C6BtBA,EAAE/M,OAEH4b,EAAiB5H,KAAKJ,MAAMvD,QAAQrL,OACxC,SAAA+H,GAAC,M5C7BuB,mB4C6BnBA,EAAE/M,OAEHyD,EAAMD,KAAKC,IAAIkY,EAAkBxZ,OAAQyZ,EAAezZ,QAExD0Z,EAAO,CACX,uBAAKrZ,IAAI,UACP,2BACE,gBAAC,GAAD,CAAaqS,MAAM,wBAErB,2BACE,gBAAC,GAAD,CAAaA,MAAM,uBAIhBiH,EAAI,EAAGA,EAAIrY,EAAKqY,IAAK,CAC5B,IAAMC,EACJD,EAAIH,EAAkBxZ,OACpB,2BAAM6R,KAAKgI,aAAaL,EAAkBG,KAE1C,4BAEEG,EACJH,EAAIF,EAAezZ,OACjB,2BAAM6R,KAAKgI,aAAaJ,EAAeE,KAEvC,4BAGJD,EAAKxX,KACH,uBAAK7B,IAAK,WAAasZ,GACpBC,EACAE,IAIP,OAAO,2BAAMJ,EAAKjX,IAAI,SAAA/B,GAAC,OAAIA,O,mCAGR0N,GACnB,OACE,gBAAC,GAAD,CACEtP,KAAMsP,EAAOtP,KACblB,MAAOwQ,EAAOxQ,MACd4Y,OAAQpI,EAAOoI,QAAUpI,EAAOnK,KAAK8E,OACrC0N,MAAOrI,EAAOqI,Y,GAlDAvE,iBCqCPmC,mBAtCf,SAAyBxT,GACvB,MAAO,CACLqN,QAASrN,EAAMqN,QAAQzL,IAAI,SAAAmI,GACzB,MAAO,CACL4L,OAAQnI,GAAaxN,EAAO+J,EAAE9L,MAC9BmF,KAAM4G,GAAchK,GACpB/B,KAAM8L,EAAE9L,KACRjB,KAAM+M,EAAE/M,KACRD,MAAOgN,EAAEhN,WAMjB,SACE0W,GAEA,MAAO,CACLmC,MAAO,SAAC3X,EAAcmF,GAAf,OACLqQ,EChCC,SACLxV,EACAlB,EACAqG,GAEA,MAAO,CAAEpG,KAAMC,GAA2BgB,OAAMlB,QAAOqG,QD2B1CmL,CAAiBtQ,EAAM,EAAGmF,OAIzC,SACEuQ,EACAC,GAEA,IAAMhD,EAAuB,CAAEvD,QAAS,IAQxC,OANAsG,EAAetG,QAAQpN,QAAQ,SAAAiZ,GAC7B,IAAMC,EAAM/Z,OAAOyU,OAAO,GAAIqF,EAAU,CACtCtD,MAAO,kBAAMhC,EAAiBgC,MAAMsD,EAASjb,KAAMib,EAAS9V,SAE9DwN,EAAMvD,QAAQhM,KAAK8X,KAEdvI,GAGM4C,CAIbkF,IE/CaU,G,sLAXX,OACE,2BACE,gBAAC,GAAD,oBACA,gBAAC,GAAD,KACE,gBAAC,GAAD,Y,GANiB/H,iB,IC6CZgI,G,YAjCb,WAAYzI,GAAmB,IAAD,+BAC5B,8CAAMA,KACDgF,MAAQ,EAAKA,MAAM9E,KAAX,iBAFe,E,wEAK5B,IAAM7S,EACJ+S,KAAKJ,MAAM3S,KAAKqb,OAAO,GAAGC,cAAgBvI,KAAKJ,MAAM3S,KAAKmQ,MAAM,GAElE,OACE,uBAAK8C,UAAU,QACb,uBAAKA,UAAU,aACb,gBAAC,GAAD,CACEjT,KAAMA,EACNlB,MAAOiU,KAAKJ,MAAM7T,MAClB4Y,OAAQ3E,KAAKJ,MAAM+E,QAAU3E,KAAKJ,MAAM+E,OACxCC,MAAO5E,KAAK4E,SAGhB,uBAAK1E,UAAU,aACb,gBAAC,GAAD,CACEtD,OAAO,cACP7Q,MAAOiU,KAAKJ,MAAM1Q,YAAYkV,iB,8BAQtCpE,KAAKJ,MAAMgF,MAAM5E,KAAKJ,MAAMxN,U,GA9BdiO,iBCmCHmC,mBA1Bf,SAAyBxT,EAAoB4Q,GAC3C,MAAO,CACL+E,Q/EkBK,E+EjBLvS,KAAM8F,GAAWlJ,EAAO4Q,EAAM3S,MAC9BiC,YAAaF,EAAM5C,IAAIwT,EAAM3S,MAAMiC,YACnCjC,KAAM2S,EAAM3S,KACZlB,MAAOiD,EAAM5C,IAAIwT,EAAM3S,MAAMlB,QAIjC,SACE0W,EACA7C,GAEA,MAAO,CACLgF,MAAO,SAACxS,GAAD,OAAiBqQ,EC7BrB,SAAgBrW,EAAeL,EAAeqG,GACnD,MAAO,CAAEhG,MAAKgG,OAAMpG,KAAMC,EAAmBF,SD4BVwR,CAAeqC,EAAM3S,KAAM,EAAGmF,OAInE,SACEuQ,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIb6F,IEjCaG,G,sLAhBX,OACE,2BACG1Z,EAAS8B,IAAI,SAAC3D,GACb,OACE,uBAAKuB,IAAKvB,GACR,2BACE,gBAAC,GAAD,CAAKA,KAAMA,a,GATLoT,iBCePoI,G,sLAXX,OACE,2BACE,gBAAC,GAAD,sCACA,gBAAC,GAAD,KACE,gBAAC,GAAD,Y,GANapI,iBCSRqI,G,sLAZX,OACE,2BACE,qDACA,6DACA,2BACE,2BAAM1I,KAAKJ,MAAMW,gB,GAPDF,iBCkBXsI,G,sLAXX,OACE,2BACE,gBAAC,GAAD,oBACA,gBAAC,GAAD,KACE,gBAAC,GAAD,mC,GANmBtI,iBCaduI,G,sLAXX,OACE,2BACE,gBAAC,GAAD,oBACA,gBAAC,GAAD,KACE,gBAAC,GAAD,oC,GANoBvI,iBCEfwI,I,mBCYb,WAAYjJ,GAA4B,IAAD,+BACrC,8CAAMA,KAED5Q,MAAQ,CACX8Z,SAAU,EAAKlJ,MAAMtN,QAAQ1B,IAAI,SAAA6C,GAC/B,OAAIA,EAAOsV,KACFtV,EAAO4J,GAEP5J,EAAOoN,QAGlBmI,SAAU,EAAKpJ,MAAMqJ,YAAc,EAAKrJ,MAAMqJ,YAAc,IAG9D,EAAKC,WAAa,EAAKA,WAAWpJ,KAAhB,iBAClB,EAAKqJ,gBAAkB,EAAKA,gBAAgBrJ,KAArB,iBACvB,EAAKsJ,eAAiB,EAAKA,eAAetJ,KAApB,iBACtB,EAAKuJ,qBAAuB,EAAKA,qBAAqBvJ,KAA1B,iBAC5B,EAAKwJ,mBAAqB,EAAKA,mBAAmBxJ,KAAxB,iBAlBW,E,wEAsBrC,OACE,2BAASI,UAAU,iBACjB,yBAAOA,UAAU,aACdF,KAAKmJ,kBACLnJ,KAAKkJ,cAER,2BAAShJ,UAAU,cAAcF,KAAKoJ,qB,wCAM1C,OACE,uBAAKlJ,UAAU,aACb,yBACElU,KAAK,SACL6X,YAAY,oBACZtB,SAAUvC,KAAKsJ,wB,mCAMY,IAAD,OAChC,OACE,sBAAIpJ,UAAU,eACXF,KAAKhR,MAAM8Z,SACT9X,OAAO,SAAAqM,GAIN,YAAe9B,IAHA,EAAKqE,MAAMtN,QAAQd,KAAK,SAAA+X,GACrC,OAAOA,EAAKlM,KAAOA,MAOtBzM,IAAI,SAAAyM,GACH,IAAM5J,EAAS,EAAKmM,MAAMtN,QAAQd,KAAK,SAAA+X,GACrC,OAAOA,EAAKlM,KAAOA,IAErB,GAAK5J,EAAO+V,SAUV,OACE,sBAAItJ,UAAU,SAAS1R,IAAKiF,EAAO4J,IAChC5J,EAAOoN,OAXZ,IACMmI,GAAuD,IAA5C,EAAKha,MAAMga,SAAS7V,QAAQM,EAAO4J,IAEpD,OACE,sBAAI6C,UAAU,OAAOgC,QAJR,kBAAM,EAAKmH,qBAAqB5V,IAIPjF,IAAKiF,EAAO4J,IAC/C2L,EAAW,yBAAIvV,EAAOoN,OAAapN,EAAOoN,Y,uCAelB,IAAD,OACtC,OAAOb,KAAKhR,MAAMga,SAASpY,IAAI,SAAAoY,GAC7B,IAAMjT,EAAU,EAAK6J,MAAM6J,WAAWT,GACtC,OACE,2BAAS9I,UAAU,gBAAgB1R,IAAKwa,GACrCjT,O,2CAMoBsR,GAA4C,IAAD,OACtErH,KAAKC,SAAS,SAACyJ,GACb,IAAM5Y,EAAM4Y,EAAUV,SAAS7V,QAAQkU,EAAKhK,IACtCsM,EAAU,EAAK3a,MAAMga,SAAS5L,QAepC,OAbItM,EAAM,EACR6Y,EAAQ/R,OAAO,EAAG,EAAGyP,EAAKhK,IAE1BsM,EAAQ/R,OAAO9G,EAAK,GAGtB6Y,EAAQxP,KAAK,SAACuB,EAAGC,GACf,OACE,EAAKiE,MAAMtN,QAAQnC,UAAU,SAAA4D,GAAC,OAAIA,EAAEsJ,KAAO3B,IAC3C,EAAKkE,MAAMtN,QAAQnC,UAAU,SAAA4D,GAAC,OAAIA,EAAEsJ,KAAO1B,MAIxC,CACLqN,SAAUW,O,yCAKWzD,GACzB,IAAMb,EAAQa,EAAM5C,OAAOvX,MAAMsa,cACjCrG,KAAKC,SAAS,CACZ6I,SAAU9I,KAAKJ,MAAMtN,QAClBtB,OAAO,SAAAyC,GACN,OAAqB,IAAjB4R,EAAMlX,SAGNsF,EAAOsV,MAC2C,IAA7CtV,EAAOsV,KAAK1C,cAAcuD,OAAOvE,IAEa,IAA9C5R,EAAOoN,MAAMwF,cAAcuD,OAAOvE,MAG5CzU,IAAI,SAAA6C,GAAM,OAAIA,EAAO4J,W,GAxIHgD,kBCwBpB,SAAS9F,GACdrI,EACAuI,EACArI,GAIA,OAFAyX,GAA8BpP,GAC9BoP,GAA+BpP,EAAYvI,GACpC,CAAElG,KAAMC,GAA6BmG,OAAMF,MAAKuI,cAGlD,SAASqP,GACdxT,EACApE,EACAuI,EACArI,GAKA,OAHAyX,GAA8BpP,GAC9BoP,GAA+BpP,EAAYnE,GAC3CuT,GAAmCpP,EAAYnE,EAAUpE,GAClD,CACLE,OACAqI,aACAnE,WACAtK,KAAMC,GACNiG,OClCG,SAAS6X,GAAepU,GAC7B,OAAQA,EAAO3J,MACb,KAAKC,GACH,OACG0J,EAAOxG,SAAW,EAAI,IAAM,IAC7BwG,EAAOxG,SACP,OACAwG,EAAOrB,UAEX,KAAKrI,GACH,OAAO0J,EAAOlB,KAAK2P,WACrB,KAAKnY,GACH,OACG0J,EAAOd,YAAc,EAAI,IAAM,IAChCc,EAAOd,YACP,qB,ICgCOmV,G,YAvDb,WAAYpK,GAAuC,IAAD,+BAChD,8CAAMA,KAEDgF,MAAQ,EAAKA,MAAM9E,KAAX,iBACb,EAAKyB,aAAe,EAAKA,aAAazB,KAAlB,iBAJ4B,E,wEAQhD,IAAMmK,EAAYpT,GAChB7C,GACAgM,KAAKJ,MAAMtJ,SACX0J,KAAKJ,MAAM1N,KAEb,QAAkBqJ,IAAd0O,EAAJ,CAIA,IAAMtU,EAASoU,GAAeE,EAAUtU,QAExC,OACE,sBAAInH,IAAKyb,EAAU/X,IAAKmQ,KAAK,SAASH,QAASlC,KAAK4E,OAClD,0BAAKqF,EAAUhd,MACf,0BAAKgd,EAAU7X,MACf,0BACG6X,EAAU1b,YACVoH,EAAOxH,OAAS,EAAI,IAAMwH,EAAS,MAEtC,0BAAKqK,KAAKuB,oB,qCAMd,OAAIvB,KAAKJ,MAAM+E,QAAU3E,KAAKJ,MAAMxN,KAAK8E,OAErC,0BAAQiL,MAAM,WACZ,gBAAC,QAAD,CAAMlV,KAAK,oBAKb,0BAAQkV,MAAM,UACZ,gBAAC,QAAD,CAAMlV,KAAK,a,8BAOb+S,KAAKJ,MAAM+E,QAAU3E,KAAKJ,MAAMxN,KAAK8E,QACvC8I,KAAKJ,MAAMgF,MAAM5E,KAAKJ,MAAMxN,U,GAtDIiO,iBCyDvBmC,mBA1Cf,SAAyBxT,EAAoB4Q,GAC3C,MAAO,CACL+E,OAAQ3K,GACNhL,EAAMwL,OACNxG,GACA4L,EAAMtJ,SACNsJ,EAAM1N,KAERE,KAAM8G,GACJlK,EACAgF,GACA4L,EAAMtJ,SACNsJ,EAAM1N,KAERgY,MAAOxQ,GACL1K,EAAMwL,OACNxG,GACA4L,EAAMtJ,SACNsJ,EAAM1N,KAERoE,SAAUsJ,EAAMtJ,SAChBpE,IAAK0N,EAAM1N,MAIf,SACEuQ,EACA7C,GAEA,MAAO,CACLgF,MAAO,SAACxS,GAAD,OACLqQ,EAASqH,GAAalK,EAAMtJ,SAAUsJ,EAAM1N,IAAK8B,GAAiB5B,OAIxE,SACEuQ,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIbwH,ICkFaG,G,YA1Ib,WAAYvK,GAA8B,IAAD,+BACvC,8CAAMA,KAEDwK,aAAe,EAAKA,aAAatK,KAAlB,iBACpB,EAAKuK,YAAc,EAAKA,YAAYvK,KAAjB,iBACnB,EAAKwK,iBAAmB,EAAKA,iBAAiBxK,KAAtB,iBACxB,EAAKyB,aAAe,EAAKA,aAAazB,KAAlB,iBANmB,E,wEAUvC,IAAMlQ,EAAO+G,GACX3C,GACAgM,KAAKJ,MAAM1N,KAEb,OACE,2BACE,2BACE,2BAAM8N,KAAKoK,aAAaxa,Q,mCAMXA,GACnB,OACE,2BACE,uBAAKsQ,UAAU,OAAOO,MAAO,CAAE8J,eAAgB,kBAC7C,0BAAK3a,EAAK3C,MACV,wBAAMwT,MAAO,CAAE8J,eAAgB,aAC5BvK,KAAKuB,iBAGV,uBAAKrB,UAAU,QACb,qCACA,yBACGtQ,EAAKoF,QAAQpE,IAAI,SAAA4Z,GAAC,OACjB,0BAAQhc,IAAKgc,EAAGhB,UAAU,GACvBgB,OAKT,uBAAKtK,UAAU,QACb,uBAAKA,UAAU,aACb,uBAAKA,UAAU,QACb,uCACCtQ,EAAKmF,UAAUnE,IAAI,SAAC6Z,EAAG3C,GAAJ,OAClB,qBAAGtZ,IAAKsZ,GAAI2C,MAGhB,uBAAKvK,UAAU,QACb,oCACA,yBAAItQ,EAAKqF,UAEX,uBAAKiL,UAAU,QACb,mCACA,yBAAItQ,EAAKsF,SAGb,uBAAKgL,UAAU,YAAYO,MAAO,CAAEiK,SAAU,IAC3C1K,KAAKqK,gBAGV,2BACE,wCACCrK,KAAKsK,iBAAiB1a,O,oCAMK,IAAD,OACjC,OACE,6BACE,6BACGxB,OAAOC,KAAK2R,KAAKJ,MAAMzK,YAAYvE,IAClC,SAACoH,GACC,OACE,sBAAIxJ,IAAKwJ,GACP,0BAAKA,GACL,0BAAK,EAAK4H,MAAMzK,WAAW6C,W,uCAUlBpI,GACvB,OACE,6BACE,6BACE,0BACE,kCACA,kCACA,oCACA,6BAGJ,6BACGA,EAAK8F,WAAW9E,IAAI,SAAAoG,GAAC,OACpB,gBAAC,GAAD,CACExI,IAAKwI,EAAE9E,IACPoE,SAAU1G,EAAKsC,IACfA,IAAK8E,EAAE9E,Y,qCAQkB,IAAD,OAElC,OAAI8N,KAAKJ,MAAM+K,SAAW3K,KAAKJ,MAAMxN,KAAK8E,OAEtC,0BAAQiL,MAAM,UAAUD,QAHZ,kBAAM,EAAKtC,MAAMgL,OAAO,EAAKhL,MAAMxN,QAI7C,gBAAC,QAAD,CAAMnF,KAAK,oBAGN+S,KAAKJ,MAAMG,OAElB,0BAAQoC,MAAM,UAAUqH,UAAU,GAChC,gBAAC,QAAD,CAAMvc,KAAK,aAKb,0BAAQkV,MAAM,UACZ,gBAAC,QAAD,CAAMlV,KAAK,e,GApIQoT,iBC6CdmC,mBA9Bf,SAAyBxT,EAAoB4Q,GAC3C,IAAMG,EAASvG,GAAexK,EAAMwL,OAAQxG,GAAiB4L,EAAM1N,KAEnE,MAAO,CACLyY,QAAS5Q,GAAc/K,EAAMwL,OAAQxG,GAAiB4L,EAAM1N,KAC5DE,KAAM6G,GAAmBjK,GACzB+Q,SACA8K,gBAAiB9K,EAAS/Q,EAAMwL,OAAOxG,IAAiB4L,EAAM1N,KAAO,GACrEiD,WAAYyE,GAA4B5K,EAAMwL,OAAQoF,EAAM1N,KAC5DA,IAAK0N,EAAM1N,MAIf,SACEuQ,EACA7C,GAEA,MAAO,CACLgL,OAAQ,SAACxY,GAAD,OACNqQ,EAASlI,GAAUqF,EAAM1N,IAAK8B,GAAiB5B,OAIrD,SACEuQ,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIb2H,ICMaW,G,YAvDb,WAAYlL,GAAuC,IAAD,+BAChD,8CAAMA,KAEDgF,MAAQ,EAAKA,MAAM9E,KAAX,iBACb,EAAKyB,aAAe,EAAKA,aAAazB,KAAlB,iBAJ4B,E,wEAQhD,IAAMmK,EAAYpT,GAChB5C,GACA+L,KAAKJ,MAAMtJ,SACX0J,KAAKJ,MAAM1N,KAEb,QAAkBqJ,IAAd0O,EAAJ,CAIA,IAAMtU,EAASoU,GAAeE,EAAUtU,QAExC,OACE,sBAAInH,IAAKyb,EAAU/X,IAAKmQ,KAAK,SAASH,QAASlC,KAAK4E,OAClD,0BAAKqF,EAAUhd,MACf,0BAAKgd,EAAUjU,OACf,0BACGiU,EAAU1b,YACVoH,EAAOxH,OAAS,EAAI,IAAMwH,EAAS,MAEtC,0BAAKqK,KAAKuB,oB,qCAMd,OAAIvB,KAAKJ,MAAM+E,QAAU3E,KAAKJ,MAAMxN,KAAK8E,OAErC,0BAAQiL,MAAM,WACZ,gBAAC,QAAD,CAAMlV,KAAK,oBAKb,0BAAQkV,MAAM,UACZ,gBAAC,QAAD,CAAMlV,KAAK,a,8BAOb+S,KAAKJ,MAAM+E,QAAU3E,KAAKJ,MAAMxN,KAAK8E,QACvC8I,KAAKJ,MAAMgF,MAAM5E,KAAKJ,MAAMxN,U,GAtDIiO,iBCyDvBmC,mBA1Cf,SAAyBxT,EAAoB4Q,GAC3C,MAAO,CACL+E,OAAQ3K,GACNhL,EAAMwL,OACNvG,GACA2L,EAAMtJ,SACNsJ,EAAM1N,KAERE,KAAM8G,GACJlK,EACAiF,GACA2L,EAAMtJ,SACNsJ,EAAM1N,KAERgY,MAAOxQ,GACL1K,EAAMwL,OACNvG,GACA2L,EAAMtJ,SACNsJ,EAAM1N,KAERoE,SAAUsJ,EAAMtJ,SAChBpE,IAAK0N,EAAM1N,MAIf,SACEuQ,EACA7C,GAEA,MAAO,CACLgF,MAAO,SAACxS,GAAD,OACLqQ,EAASqH,GAAalK,EAAMtJ,SAAUsJ,EAAM1N,IAAK+B,GAAiB7B,OAIxE,SACEuQ,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIbsI,IC2BaC,G,YAxFb,WAAYnL,GAA8B,IAAD,+BACvC,8CAAMA,KAED0K,iBAAmB,EAAKA,iBAAiBxK,KAAtB,iBACxB,EAAKyB,aAAe,EAAKA,aAAazB,KAAlB,iBAJmB,E,wEAQvC,IAAMlQ,EAAO+G,GACX1C,GACA+L,KAAKJ,MAAM1N,KAEb,OACE,2BACE,uBAAKgO,UAAU,OAAOO,MAAO,CAAE8J,eAAgB,kBAC7C,0BAAK3a,EAAK3C,MACV,wBAAMwT,MAAO,CAAE8J,eAAgB,aAC5BvK,KAAKuB,iBAGV,2BACE,yCACA,yBAAI3R,EAAKrB,cAEX,uBAAK2R,UAAU,QACb,qCACA,yBACE,0BAAQsJ,UAAU,GAAO5Z,EAAKmG,WAGlC,2BACE,yCAEDiK,KAAKsK,iBAAiB1a,M,uCAKJA,GACvB,OACE,6BACE,6BACE,0BACE,kCACA,mCACA,oCACA,6BAGJ,6BACGA,EAAK8F,WACHyE,KAAK,SAACuB,EAAGC,GAAJ,OAAUD,EAAE1F,MAAQ2F,EAAE3F,QAC3BpF,IAAI,SAAAoG,GAAC,OACJ,gBAAC,GAAD,CACExI,IAAKwI,EAAE9E,IACPoE,SAAU1G,EAAKsC,IACfA,IAAK8E,EAAE9E,Y,qCAQgB,IAAD,OAElC,OAAI8N,KAAKJ,MAAM+K,SAAW3K,KAAKJ,MAAMxN,KAAK8E,OAEtC,0BAAQiL,MAAM,UAAUD,QAHZ,kBAAM,EAAKtC,MAAMgL,OAAO,EAAKhL,MAAMxN,QAI7C,gBAAC,QAAD,CAAMnF,KAAK,oBAGN+S,KAAKJ,MAAMG,OAElB,0BAAQoC,MAAM,UAAUqH,UAAU,GAChC,gBAAC,QAAD,CAAMvc,KAAK,aAKb,0BAAQkV,MAAM,UACZ,gBAAC,QAAD,CAAMlV,KAAK,e,GAlFQoT,iBCyCdmC,mBA7Bf,SAAyBxT,EAAoB4Q,GAC3C,IAAMG,EAASvG,GAAexK,EAAMwL,OAAQvG,GAAiB2L,EAAM1N,KAEnE,MAAO,CACLyY,QAAS5Q,GAAc/K,EAAMwL,OAAQvG,GAAiB2L,EAAM1N,KAC5DE,KAAM6G,GAAmBjK,GACzB+Q,SACA8K,gBAAiB9K,EAAS/Q,EAAMwL,OAAOvG,IAAiB2L,EAAM1N,KAAO,GACrEA,IAAK0N,EAAM1N,MAIf,SACEuQ,EACA7C,GAEA,MAAO,CACLgL,OAAQ,SAACxY,GAAD,OACNqQ,EAASlI,GAAUqF,EAAM1N,IAAK+B,GAAiB7B,OAIrD,SACEuQ,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIbuI,ICWaC,G,YA3Db,WAAYpL,GAAY,IAAD,+BACrB,8CAAMA,KAED6J,WAAa,EAAKA,WAAW3J,KAAhB,iBAHG,E,wEAOrB,IAAMmL,EAAuB/U,GAAetF,IAAI,SAAA2F,GAAE,MAAK,CACrDiT,UAAU,EACVnM,GAAI9G,EAAGrE,IACP2O,MAAOtK,EAAGtJ,KACV8b,KAAMxS,EAAGtJ,KAAO,eAEZie,EAAuB/U,GAAevF,IAAI,SAAA2F,GAAE,MAAK,CACrDiT,UAAU,EACVnM,GAAI9G,EAAGrE,IACP2O,MAAOtK,EAAGtJ,KACV8b,KAAMxS,EAAGtJ,KAAO,eAoBlB,OACE,gBAAC,GAAD,CACEqF,QAnB8B,CAChC,CACEkX,UAAU,EACVnM,GAAI,kBACJwD,MAAO,kBACPkI,KAAM,aAeH5B,OAAO8D,GACP9D,OAb2B,CAChC,CACEqC,UAAU,EACVnM,GAAI,kBACJwD,MAAO,kBACPkI,KAAM,cASH5B,OAAO+D,GACVjC,YAAa,GACbQ,WAAYzJ,KAAKyJ,e,iCAKJvX,GAEjB,O/EkCG,SAAuBoE,GAC5B,IAAM6U,EAAcjV,GAAe/F,UAAU,SAAAoG,GAAE,OAAIA,EAAGrE,MAAQoE,IACxD8U,EAAcjV,GAAehG,UAAU,SAAAoG,GAAE,OAAIA,EAAGrE,MAAQoE,IAC9D,IAAqB,IAAjB6U,EACF,OAAOnX,GACF,IAAqB,IAAjBoX,EACT,OAAOnX,GAEP,MAAM,IAAIhE,MAAM,kBAAoBqG,G+E3CvB+U,CAAcnZ,KACd8B,GACJ,gBAAC,GAAD,CAAgB9B,IAAKA,IAErB,gBAAC,GAAD,CAAgBA,IAAKA,Q,GAvDTmO,iBCMViL,G,sLAXX,OACE,2BACE,gBAAC,GAAD,oBACA,gBAAC,GAAD,KACE,gBAAC,GAAD,Y,GANgBjL,iB,8RC0LXkL,G,YA3Ib,WAAY3L,GAAoC,IAAD,uBAG7C,IAAM4L,EAAwC,GAHD,OAId,KAH/B,8CAAM5L,KAGGA,MAAMxN,KAAKjE,SAClBqd,EAAUpZ,KAAO,EAAKwN,MAAMxN,KAAK,IAEnC,EAAKpD,MAAQwc,EAEb,EAAKC,kBAAoB,EAAKA,kBAAkB3L,KAAvB,iBACzB,EAAK4L,cAAgB,EAAKA,cAAc5L,KAAnB,iBACrB,EAAK6L,eAAiB,EAAKA,eAAe7L,KAApB,iBAXuB,E,wEAc9B,IAAD,OACRlQ,EAAOgE,GAAuBoM,KAAKJ,MAAMrM,MAAOyM,KAAKJ,MAAM1N,KAC3DO,EAA2B7C,EAAK6C,QAClCuN,KAAK0L,cAAc9b,EAAK6C,cACxB8I,EACEqQ,EAA2Bhc,EAAKnB,MAAMmC,IAAI,SAACc,EAAU2L,GAAX,OAC9C,EAAKwO,mBAAmBna,EAAG2L,KAEvByO,EACiB,kBAAdlc,EAAKwC,UAAoBmJ,EAAYyE,KAAKyL,oBACnD,OACE,gBAACM,GAAA,EAAD,CAAOhM,OAAQC,KAAKJ,MAAMG,QACxB,gBAACiM,GAAA,EAAD,CAAanM,OAAQG,KAAKJ,MAAMC,QAASjQ,EAAK5D,MAC9C,gBAACigB,GAAA,EAAD,KACGrc,EAAKrB,YACN,2BACC,CAACkE,EAASmZ,EAASE,IAEtB,gBAACI,GAAA,EAAD,KAAclM,KAAKmM,sB,yCAKEC,EAAa5d,GACtC,GAAI4d,EAAKpgB,OAASqF,EAAlB,CAGA,IAAMkR,EAAW,SAAC8J,GAEhBhN,QAAQC,IAAI+M,EAAI/I,OAAOvX,QAEzB,OACE,uBAAKyC,IAAK,SAAWA,GAClBJ,OAAOC,KAAK+d,EAAK/a,SAAST,IAAI,SAAC0b,GAAD,OAC7B,uBAAK9d,IAAK8d,GACR,yBACEtgB,KAAK,QACLwC,IAAK,eAAiBA,EACtBvB,KAAM,SAAWuB,EACjB+T,SAAUA,IAhFxB,SAA2B5T,GACzB,OAAQA,EAAM3C,MACZ,KAAKqF,EACH,MAAO,YAAc1C,EAAM5C,MAC7B,KAAKsF,EACH,MAAO,iBAAmB1C,EAAM5C,MAClC,KAAKsF,EACH,OAAO1C,EAAMvC,IAAM,SAAWuC,EAAM5C,MACtC,KAAKsF,EACH,OAAO1C,EAAMvC,IAAM,qBAAuBuC,EAAM5C,MAClD,KAAKsF,EACH,MAAM,IAAIpB,MACR,qCAAuCsc,KAAKC,UAAU7d,IAE1D,KAAK0C,EACH,MAAO,SAAW1C,EAAMrC,MAAQ,MAClC,KAAK+E,EACH,MAAO,SAAW1C,EAAMrC,MAAQ,sBAAwBqC,EAAMnC,WAChE,QACE,MAAO,MA+DAigB,CAAkBL,EAAK/a,QAAQib,W,oCAOpB7Z,GAAmC,IAAD,OAQtD,OACE,gBAAC,GAAD,CACEjE,IAAK,UACLoO,OAAQnK,EACRwO,QAASjB,KAAKhR,MAAMyD,QACpB4Q,SANY,SAACrL,GAAD,OAAeA,EAAE7J,OAAS,GAOtC2T,SAba,SAACpQ,GAChB,EAAKuO,SAAS,CACZ7N,KAAM,EAAKpD,MAAMoD,KACjBK,QAASf,S,0CAe+B,IAAD,OAQvCgb,EAAQ,GAUZ,OATA1M,KAAKJ,MAAMxN,KAAKnD,QAAQ,SAACmD,EAAatB,GACpC,IAAM6b,EAAQ,gBACX7b,EAAM,CACL+P,MAAOzO,EAAK+E,SAASiN,WACrB3D,MAAO,CAAE0B,MAAO/P,EAAK8E,OAAS,QAAU,gBAG5CwV,E,wVAAK,IAAQA,EAAR,GAAkBC,KAGvB,uBAAKne,IAAI,QACP,gBAAC,KAAD,CACEkE,IAAK,EACLjD,IAAKuQ,KAAKJ,MAAMxN,KAAKjE,OAAS,EAC9Bue,MAAOA,EACPE,UAAU,EACVrK,SAxBW,SAACzR,GAChB,EAAKmP,SAAS,CACZ7N,KAAM,EAAKwN,MAAMxN,KAAKtB,GACtB2B,QAAS,EAAKzD,MAAMyD,WAsBlBoa,KAAM,OAER,8B,wCAMJ,IAGMC,KAHOlZ,GAAuBoM,KAAKJ,MAAMrM,MAAOyM,KAAKJ,MAAM1N,KAEpBO,SAEvBuN,KAAKhR,MAAMyD,SAAWuN,KAAKhR,MAAMyD,QAAQtE,OAAS,EAClE4e,IAAa/M,KAAKhR,MAAMoD,MAAO4N,KAAKhR,MAAMoD,KAAK8E,OAC/C8V,EAASF,GAAiBC,EAEhC,OACE,gBAACvJ,GAAA,EAAD,CAAQgG,UAAWwD,EAAQ7K,MAAM,OAAOD,QAASlC,KAAK2L,gBAAtD,S,uCAOE3L,KAAKhR,MAAMoD,MAAQ4N,KAAKhR,MAAMoD,KAAK8E,SACrC8I,KAAKJ,MAAMgF,MAAM5E,KAAKhR,MAAMoD,KAAM4N,KAAKhR,MAAMyD,SAC7CuN,KAAKJ,MAAMC,SACXG,KAAKC,SAAS,S,GA1IeI,iBC2FpB4M,G,YArHb,WAAYrN,GAA+B,IAAD,+BACxC,8CAAMA,KAED5Q,MAAQ,CAAEke,aAAa,GAE5B,EAAK3L,aAAe,EAAKA,aAAazB,KAAlB,iBAEpB,EAAKqN,YAAc,EAAKA,YAAYrN,KAAjB,iBACnB,EAAKsN,eAAiB,EAAKA,eAAetN,KAApB,iBACtB,EAAKuN,cAAgB,EAAKA,cAAcvN,KAAnB,iBACrB,EAAKwN,YAAc,EAAKA,YAAYxN,KAAjB,iBAVqB,E,wEAazB,IAAD,OACRlQ,EAAOgE,GAAuBoM,KAAKJ,MAAMrM,MAAOyM,KAAKJ,MAAM1N,KACjE,QAAaqJ,IAAT3L,EAAJ,CAGA,IAAMsa,EAAQlK,KAAKJ,MAAM2N,SAAS3c,IAAI,SAAC6B,EAASQ,GAAV,OACpC,EAAKka,YAAY1a,EAASQ,KAE5B,OAAIiX,EAAM/b,OAAS,GAAKyB,EAAK2C,WACpB2X,EAAM/C,OAAOnH,KAAKoN,kBAChBlD,EAAM/b,OAAS,EACjB+b,EAEAlK,KAAKoN,oB,mCAIKzI,GACnB,OAAIA,EAEA,0BAAQxC,MAAM,WACZ,gBAAC,QAAD,CAAMlV,KAAK,oBAKb,0BAAQkV,MAAM,UACZ,gBAAC,QAAD,CAAMlV,KAAK,a,uCAMMmF,GACvB,MAAoB,kBAATA,EACFA,EAEAA,EAAKM,IAAM,IAAMN,EAAK3C,M,kCAIbgD,EAAcQ,GAChC,IAAMrD,EAAOgE,GAAuBoM,KAAKJ,MAAMrM,MAAOyM,KAAKJ,MAAM1N,KACjE,OACE,sBAAI1D,IAAK,SAAWoB,EAAKsC,IAAM,IAAMe,GACnC,0BAAKrD,EAAK5D,MACV,0BAAKgU,KAAKwN,iBAAiB5d,EAAKwC,OAChC,0BAAKxC,EAAKrB,aACV,8B,uCAMJ,IAAMqB,EAAOgE,GAAuBoM,KAAKJ,MAAMrM,MAAOyM,KAAKJ,MAAM1N,KAC3Dub,EACJzN,KAAKJ,MAAM+E,QACX3E,KAAKJ,MAAMxN,KACRxB,IAAI,SAAAwB,GAAI,OAAIA,EAAK8E,SACjB8E,OACC,SAAC0R,EAAeC,GAAhB,OAAiCD,GAAiBC,IAClD,GAEN,OACE,sBACEnf,IAAK,WAAaoB,EAAKsC,IACvBmQ,KAAK,SACLH,QAASlC,KAAKqN,eAEd,gBAAC,GAAD,CACE9Z,MAAOyM,KAAKJ,MAAMrM,MAClBrB,IAAK8N,KAAKJ,MAAM1N,IAChBE,KAAM4N,KAAKJ,MAAMxN,KACjBwS,MAAO5E,KAAKJ,MAAMgF,MAClB7E,OAAQC,KAAKhR,MAAMke,YACnBrN,OAAQG,KAAKsN,cAEf,0BAAK1d,EAAK5D,MACV,0BAAKgU,KAAKwN,iBAAiB5d,EAAKwC,OAChC,0BAAKxC,EAAKrB,aACV,0BAAKyR,KAAKuB,aAAakM,O,sCAOzBzN,KAAKJ,MAAM+E,QACX3E,KAAKJ,MAAMxN,KACRxB,IAAI,SAAAwB,GAAI,OAAIA,EAAK8E,SACjB8E,OACC,SAAC0R,EAAeC,GAAhB,OAAiCD,GAAiBC,IAClD,KAEkB3N,KAAKhR,MAAMke,aACjClN,KAAKsN,gB,oCAKPtN,KAAKC,SAAS,CAAEiN,aAAclN,KAAKhR,MAAMke,kB,GArHf7M,iBCgDfmC,mBAlCf,SAAyBxT,EAAoB4Q,GAC3C,IAAMgO,EAAU5e,EAAMiD,WAAW2N,EAAMrM,OACjCga,OACQhS,IAAZqS,EACI,GACAA,EAAQ5c,OAAO,SAAA+C,GAAC,OAAIA,EAAE7B,MAAQ0N,EAAM1N,MAAKtB,IAAI,SAAAmD,GAAC,OAAIA,EAAEtB,UAE1D,MAAO,CACLkS,OAAQ9I,GAAsB7M,EAAMiD,WAAY2N,EAAMrM,MAAOqM,EAAM1N,KACnEE,KAAMuG,GAA0B3J,EAAO4Q,EAAMrM,MAAOqM,EAAM1N,KAC1DgY,MAAO7O,GAAyBrM,EAAMiD,WAAY2N,EAAMrM,MAAOqM,EAAM1N,KACrEqB,MAAOqM,EAAMrM,MACbga,WACArb,IAAK0N,EAAM1N,MAIf,SACEuQ,EACA7C,GAEA,MAAO,CACLgF,MAAO,SAACxS,EAAaK,GAAd,OACLgQ,EChCC,SACLlP,EACArB,EACAE,EACAK,GAGA,OADAob,EAAuCta,EAAOrB,GACvC,CAAEE,OAAMmB,QAAOvH,KAAMC,GAAgCiG,MAAKO,WDyBpDqb,CAAUlO,EAAMrM,MAAOqM,EAAM1N,IAAKE,EAAMK,OAIvD,SACEkQ,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIbyK,IEcac,G,YArEb,WAAYnO,GAAyB,IAAD,+BAClC,8CAAMA,KAEDoO,cAAgB,EAAKA,cAAclO,KAAnB,iBACrB,EAAKyB,aAAe,EAAKA,aAAazB,KAAlB,iBAJc,E,wEAQlC,IAAMlQ,EAAO8D,GAAiBsM,KAAKJ,MAAM1N,KACzC,OACE,2BACE,uBAAKgO,UAAU,OAAOO,MAAO,CAAE8J,eAAgB,kBAC7C,0BAAK3a,EAAK3C,MACV,wBAAMwT,MAAO,CAAE8J,eAAgB,aAC5BvK,KAAKuB,iBAGV,2BACE,yBAAI3R,EAAKrB,cAEX,2BAAMyR,KAAKgO,cAAcpe,O,oCAKTA,GACpB,OACE,6BACE,6BACE,0BACE,kCACA,kCACA,oCACA,6BAGJ,6BACGA,EAAK0C,QAAQ1B,IAAI,SAAAmD,GAAC,OACjB,gBAAC,GAAD,CAAiBvF,IAAKuF,EAAE7B,IAAKqB,MAAO3D,EAAKsC,IAAKA,IAAK6B,EAAE7B,Y,qCAO1B,IAAD,OAElC,OAAI8N,KAAKJ,MAAM+K,SAAW3K,KAAKJ,MAAMxN,KAAK8E,OAEtC,0BAAQiL,MAAM,UAAUD,QAHZ,kBAAM,EAAKtC,MAAMgL,OAAO,EAAKhL,MAAMxN,QAI7C,gBAAC,KAAD,CAAMnF,KAAK,oBAGN+S,KAAKJ,MAAMsK,MAElB,0BAAQ/H,MAAM,UAAUqH,UAAU,GAChC,gBAAC,KAAD,CAAMvc,KAAK,aAKb,0BAAQkV,MAAM,UACZ,gBAAC,KAAD,CAAMlV,KAAK,e,GA/DGoT,iBCqCTmC,mBAzBf,SAAyBxT,EAAoB4Q,GAC3C,MAAO,CACL+K,QAASnP,GAAiBxM,EAAO4Q,EAAM1N,KACvCE,KAAMkG,GAAqBtJ,EAAO4Q,EAAM1N,KACxCgY,MAAOhP,GAAmBlM,EAAMiD,WAAY2N,EAAM1N,KAClDA,IAAK0N,EAAM1N,MAIf,SACEuQ,EACA7C,GAEA,MAAO,CACLgL,OAAQ,SAACxY,GAAD,OAAiBqQ,EFtBtB,SAAcvQ,EAAaE,GAEhC,OADAyb,EAAiC3b,GAC1B,CAAEE,OAAMpG,KAAMC,GAA0BiG,OEoBX+b,CAAKrO,EAAM1N,IAAKE,OAItD,SACEuQ,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIbuL,ICPaG,G,YAtCb,WAAYtO,GAAY,IAAD,+BACrB,8CAAMA,KAED6J,WAAa,EAAKA,WAAW3J,KAAhB,iBAHG,E,wEAMN,IAAD,EACRqO,EAAgBpb,EAAqBnC,IAAI,SAAAuB,GAC7C,IAAMic,EAAwB,CAC5B,CAAE/Q,GAAIlL,EAAU0O,MAAO1O,EAAUqX,UAAU,IAEvC6E,EAA0Bpc,EAC7BjB,OAAO,SAACgC,GAAD,OAAwBA,EAAGb,WAAaA,IAC/CvB,IAAI,SAACoC,GAAD,MAAyB,CAC5BwW,UAAU,EACVnM,GAAIrK,EAAGd,IACP2O,MAAO7N,EAAG/F,KACV8b,KAAM/V,EAAG/F,KAAO,IAAMkF,KAE1B,OAAOic,EAAWjH,OAAOkH,KAGrB/b,GAAW,MAAiB6U,OAAlB,qBAA4BgH,IAE5C,OACE,gBAAC,GAAD,CACE7b,QAASA,EACT2W,YAAa,GACbQ,WAAYzJ,KAAKyJ,e,iCAKJvX,GACjB,OAAO,gBAAC,GAAD,CAAWA,IAAKA,Q,GAnCEmO,iBCSdiO,G,sLAXX,OACE,2BACE,gBAAC,GAAD,oBACA,gBAAC,GAAD,KACE,gBAAC,GAAD,Y,GANoBjO,iBC6CfkO,G,YAtCb,WAAY3O,GAAuB,IAAD,+BAChC,8CAAMA,KAED5Q,MAAQ,CACXwf,WAAY,EAAK5O,MAAMjF,QAAQxM,QAGjC,EAAKsgB,oBAAoB3O,KAAzB,iBACA,EAAK4O,gBAAgB5O,KAArB,iBARgC,E,wEAWjB,IAAD,OACd,OACE,uBAAKI,UAAU,WACb,2BACGF,KAAKJ,MAAMjF,QAAQ/J,IAAI,SAAC0J,EAAiBrH,GAAlB,OACtB,EAAKwb,oBAAoBnU,EAAQrH,S,0CAOfqH,EAAiBrH,GAA6B,IAAD,OAEvE,OACE,uBAAKzE,IAAK,cAAgByE,EAAOiP,QAFnB,kBAAM,EAAKwM,gBAAgBzb,KAGvC,2BAAMA,EAAQ,EAAI,IAAMqH,EAAOtO,MAC/B,2BAAMugB,KAAKC,UAAUlS,O,sCAKHrH,GACtB+M,KAAKJ,MAAM+O,SAAS1b,O,GAnCFoN,iBCyBPmC,mBArBf,SAAyBxT,GACvB,MAAO,CAAE2L,QAAS3L,EAAM2L,UAG1B,SACE8H,GAEA,MAAO,CACLkM,SAAU,SAACtR,GACToF,ECjBC,SAA2BpF,GAChC,MAAO,CAAErR,KAAMC,GAA0BoR,MDgB5BE,CAA0BF,OAKzC,SACEsF,EACAC,GAEA,OAAOxU,OAAOyU,OAAO,GAAIF,EAAgBC,IAG5BJ,CAIb+L,IEtBaK,G,sLAXX,OACE,2BACE,gBAAC,GAAD,oBACA,gBAAC,GAAD,KACE,gBAAC,GAAD,Y,GANiBvO,iBCiCZwO,G,sLAnBX,OACE,gBAACC,GAAA,EAAD,KACE,uBAAK5O,UAAU,UACb,gBAAC,GAAD,MACA,gBAAC6O,GAAA,EAAD,CAAO5I,OAAO,EAAM6I,KAAK,IAAIC,UAAWzK,KACxC,gBAACuK,GAAA,EAAD,CAAO5I,OAAO,EAAM6I,KAAK,UAAUC,UAAWzH,KAC9C,gBAACuH,GAAA,EAAD,CAAO5I,OAAO,EAAM6I,KAAK,OAAOC,UAAW5G,KAC3C,gBAAC0G,GAAA,EAAD,CAAO5I,OAAO,EAAM6I,KAAK,WAAWC,UAAWvH,KAC/C,gBAACqH,GAAA,EAAD,CAAO5I,OAAO,EAAM6I,KAAK,aAAaC,UAAWC,KACjD,gBAACH,GAAA,EAAD,CAAO5I,OAAO,EAAM6I,KAAK,cAAcC,UAAWE,KAClD,gBAACJ,GAAA,EAAD,CAAO5I,OAAO,EAAM6I,KAAK,UAAUC,UAAWG,KAC9C,gBAACL,GAAA,EAAD,CAAO5I,OAAO,EAAM6I,KAAK,cAAcC,UAAWI,KAClD,gBAACN,GAAA,EAAD,CAAO5I,OAAO,EAAM6I,KAAK,WAAWC,UAAWV,W,GAdvClO,iBCJZiP,GAAQC,sBACZ7S,GvE0BK,WACL,IAAMO,EAAUc,KACVR,EAAU,CACdrM,GAAQ,YACRwM,GAAa,WACbI,GAAmB,YAAa,OAAQ7G,IACxC6G,GAAmB,YAAa,QAAS7G,KAG3C,OADAgG,EAAQpL,SAAW,GACZsL,GAAcF,EAASM,GuElC9BiS,GACAC,2BAAiB,KAWnBC,SACE,2BACE,gBAAC,IAAD,CAAUJ,MAAOA,IACf,gBAAC,GAAD,QAGJK,SAASC,eAAe,SrELnB,SAAkBlR,GACvB,GAA6C,kBAAmBC,UAAW,CAMzE,GAJkB,IAAIkR,IACnBC,UACD1R,OAAOC,SAAS0R,MAEJC,SAAW5R,OAAOC,SAAS2R,OAIvC,OAGF5R,OAAO6R,iBAAiB,OAAQ,WAC9B,IAAMxR,EAAK,UAAMqR,UAAN,sBAEP5R,KAgEV,SAAiCO,EAAeC,GAE9CwR,MAAMzR,GACHK,KAAK,SAAAqR,GAEJ,IAAMC,EAAcD,EAASE,QAAQC,IAAI,gBAEnB,MAApBH,EAASI,QACO,MAAfH,IAA8D,IAAvCA,EAAYjd,QAAQ,cAG5CwL,UAAUC,cAAc4R,MAAM1R,KAAK,SAAAC,GACjCA,EAAa0R,aAAa3R,KAAK,WAC7BV,OAAOC,SAASqS,aAKpBlS,GAAgBC,EAAOC,KAG1Be,MAAM,WACLJ,QAAQC,IACN,mEArFAqR,CAAwBlS,EAAOC,GAI/BC,UAAUC,cAAc4R,MAAM1R,KAAK,WACjCO,QAAQC,IACN,+GAMJd,GAAgBC,EAAOC,MqEvB/BE,K","file":"static/js/main.df729081.chunk.js","sourcesContent":["export const INITIAL_STATE = 'INITIAL_STATE';\nexport type INITIAL_STATE = typeof INITIAL_STATE;\n","export const HEADER_SET_NAME = 'HEADER_SET_NAME';\nexport type HEADER_SET_NAME = typeof HEADER_SET_NAME;\n\nexport const HEADER_SET_CONCEPT = 'HEADER_SET_CONCEPT';\nexport type HEADER_SET_CONCEPT = typeof HEADER_SET_CONCEPT;\n\nexport const HEADER_SET_ARCHETYPE = 'HEADER_SET_ARCHETYPE';\nexport type HEADER_SET_ARCHETYPE = typeof HEADER_SET_ARCHETYPE;\n\nexport const HEADER_SET_RANK = 'HEADER_SET_RANK';\nexport type HEADER_SET_RANK = typeof HEADER_SET_RANK;\n","export const BONUS_DISCOUNT = 'BONUS_DISCOUNT';\nexport type BONUS_DISCOUNT = typeof BONUS_DISCOUNT;\n\nexport const BONUS_DESTINY = 'BONUS_DESTINY';\nexport type BONUS_DESTINY = typeof BONUS_DESTINY;\n\nexport const BONUS_ENTANGLEMENT = 'BONUS_ENTANGLEMENT';\nexport type BONUS_ENTANGLEMENT = typeof BONUS_ENTANGLEMENT;\n\nexport const BONUS_CHI = 'BONUS_CHI';\nexport type BONUS_CHI = typeof BONUS_CHI;\n\nexport const BONUS_CULTIVATION = 'BONUS_CULTIVATION';\nexport type BONUS_CULTIVATION = typeof BONUS_CULTIVATION;\n\nexport const BONUS_ONE_AMONG_N = 'BONUS_ONE_AMONG_N';\nexport type BONUS_ONE_AMONG_N = typeof BONUS_ONE_AMONG_N;\n\nexport const BONUS_SKILL_RANK = 'BONUS_SKILL_RANK';\nexport type BONUS_SKILL_RANK = typeof BONUS_SKILL_RANK;\n\nexport const BONUS_SPECIALITY = 'BONUS_SPECIALITY';\nexport type BONUS_SPECIALITY = typeof BONUS_SPECIALITY;\n","import {\n  IBonus,\n  IBonusChi,\n  IBonusCultivation,\n  IBonusDestiny,\n  IBonusEntanglement,\n  IBonusOneAmongN,\n  IBonusSkillRank,\n  IBonusSpeciality\n} from \"../../../perks/bonuses\";\nimport * as constants from \"../../../perks/constants/bonuses\";\n\nimport * as dataChi from \"../../../data/chi\";\nimport * as dataSkill from \"../../../data/skills\";\n\nexport function bonusDestiny(value: number): IBonusDestiny {\n  return { type: constants.BONUS_DESTINY, value };\n}\n\nexport function bonusEntanglement(value: number): IBonusEntanglement {\n  return { type: constants.BONUS_ENTANGLEMENT, value };\n}\n\nexport function bonusChi(value: number, chiName: dataChi.TChiName): IBonusChi {\n  return { type: constants.BONUS_CHI, chi: chiName, value };\n}\n\nexport function bonusCultivation(\n  chiName: dataChi.TChiName,\n  value: number\n): IBonusCultivation {\n  return { type: constants.BONUS_CULTIVATION, value, chi: chiName };\n}\n\nexport function bonusOneAmongN(\n  bonuses: { [key in string]: IBonus }\n): IBonusOneAmongN | IBonus {\n  if (Object.keys(bonuses).length === 0) {\n    throw new Error(\"Can not create one out of zero\");\n  }\n  if (Object.keys(bonuses).length === 1) {\n    return Object.values(bonuses)[0];\n  }\n  return { type: constants.BONUS_ONE_AMONG_N, bonuses };\n}\n\nexport function bonusSkillRank(skill: dataSkill.TSkillName): IBonusSkillRank {\n  return { type: constants.BONUS_SKILL_RANK, skill };\n}\n\nexport function bonusSpeciality(\n  skill: dataSkill.TSkillName,\n  specialityName: string\n): IBonusSpeciality {\n  return {\n    skill,\n    speciality: specialityName,\n    type: constants.BONUS_SPECIALITY\n  };\n}\n","export const DISCOUNT_CHI = \"DISCOUNT_CHI\";\nexport type DISCOUNT_CHI = typeof DISCOUNT_CHI;\n\nexport const DISCOUNT_SKILL = \"DISCOUNT_SKILL\";\nexport type DISCOUNT_SKILL = typeof DISCOUNT_SKILL;\n\nexport const DISCOUNT_LORESHEET = \"DISCOUNT_LORESHEET\";\nexport type DISCOUNT_LORESHEET = typeof DISCOUNT_LORESHEET;\n\nexport const DISCOUNT_LORESHEET_OPTION = \"DISCOUNT_LORESHEET_OPTION\";\nexport type DISCOUNT_LORESHEET_OPTION = typeof DISCOUNT_LORESHEET_OPTION;\n\nexport const DISCOUNT_KUNGFU_STYLE = \"DISCOUNT_KUNGFU_STYLE\";\nexport type DISCOUNT_KUNGFU_STYLE = typeof DISCOUNT_KUNGFU_STYLE;\n\nexport const DISCOUNT_KUNGFU_TECHNIQUE = \"DISCOUNT_KUNGFU_TECHNIQUE\";\nexport type DISCOUNT_KUNGFU_TECHNIQUE = typeof DISCOUNT_KUNGFU_TECHNIQUE;\n","export type TSkillName =\n  | \"Awareness\"\n  | \"Confidence\"\n  | \"Crafting\"\n  | \"Finesse\"\n  | \"Hardiness\"\n  | \"Inspire\"\n  | \"Learning\"\n  | \"Medicine\"\n  | \"Might\"\n  | \"Perform\"\n  | \"Politics\"\n  | \"Ride\"\n  | \"Stealth\"\n  | \"Survival\"\n  | \"Tactics\"\n  | \"Wu Wei\";\n\ninterface IDataSkill {\n  name: TSkillName;\n  specialities: string[];\n}\n\nexport type TDataSkills = { [key in TSkillName]: IDataSkill };\n\nexport const skills: TDataSkills = {\n  Awareness: {\n    name: \"Awareness\",\n    specialities: [\"Hear\", \"See\", \"Smell\", \"Taste\", \"Touch\"]\n  },\n  Confidence: {\n    name: \"Confidence\",\n    specialities: [\n      \"Appear steadfast\",\n      \"Focus on Breath (for Courtiers)\",\n      \"Recover from the Disorient Marvel\",\n      \"Resist Courtiers Arts\"\n    ]\n  },\n  Crafting: {\n    name: \"Crafting\",\n    specialities: [\n      \"Armor\",\n      \"Buildings\",\n      \"Cloth\",\n      \"Cooking\",\n      \"Gardening\",\n      \"Painting\",\n      \"Tools\",\n      \"Weapons\"\n    ]\n  },\n  Finesse: {\n    name: \"Finesse\",\n    specialities: [\n      \"Acrobatics\",\n      \"Cheating\",\n      \"Escaping Bonds\",\n      \"Picking Pockets\",\n      \"Sleight of Hand\"\n    ]\n  },\n  Hardiness: {\n    name: \"Hardiness\",\n    specialities: [\n      \"Disease\",\n      \"Focusing on Breath (for Warriors)\",\n      \"Poison\",\n      \"Recovering From Injuries\",\n      \"Staying Awake\",\n      \"Enduring Torture\"\n    ]\n  },\n  Inspire: {\n    name: \"Inspire\",\n    specialities: [\n      \"Debating\",\n      \"Intimidation\",\n      \"Outright Lies\",\n      \"Public Speeches\",\n      \"Specific Courtiers Arts techniques\",\n      \"Spinning the Facts\"\n    ]\n  },\n  Learning: {\n    name: \"Learning\",\n    specialities: [\n      \"Calligraphy\",\n      \"Focus on Breath (for Scholars)\",\n      \"History\",\n      \"Math\",\n      \"Other Cultures\",\n      \"Philosophy\",\n      \"Specific Scholars Arts Techniques\"\n    ]\n  },\n  Medicine: {\n    name: \"Medicine\",\n    specialities: [\n      \"Disease\",\n      \"Focus on Breath (for Doctors)\",\n      \"Injuries\",\n      \"Poison\",\n      \"Pressure Points\",\n      \"Specific Doctors Arts Techniques\"\n    ]\n  },\n  Might: {\n    name: \"Might\",\n    specialities: [\"Breaking\", \"Lifting\", \"Pushing\", \"Throwing\"]\n  },\n  Perform: {\n    name: \"Perform\",\n    specialities: [\n      \"Acting\",\n      \"Ceremonial Performances\",\n      \"Dancing\",\n      \"Poetry\",\n      \"Singing\",\n      \"Music\"\n    ]\n  },\n  Politics: {\n    name: \"Politics\",\n    specialities: [\"Specific region or faction\"]\n  },\n  Ride: {\n    name: \"Ride\",\n    specialities: [\n      \"Caring for Your Horse\",\n      \"Coaxing Your Horse into Dangerous Terrain\",\n      \"Racing\"\n    ]\n  },\n  Stealth: {\n    name: \"Stealth\",\n    specialities: [\n      \"Camouflage\",\n      \"Deception\",\n      \"Eavesdropping\",\n      \"In Shadows\",\n      \"Silence\",\n      \"Smuggling\"\n    ]\n  },\n  Survival: {\n    name: \"Survival\",\n    specialities: [\n      \"At Sea\",\n      \"Cities\",\n      \"Deserts\",\n      \"Forests\",\n      \"Mountains\",\n      \"Prisons\"\n    ]\n  },\n  Tactics: {\n    name: \"Tactics\",\n    specialities: [\n      \"Battlefield Analysis\",\n      \"Disruption\",\n      \"Escorting Caravans\",\n      \"Sieging Fortresses\",\n      \"Specific Warriors Arts Techniques\"\n    ]\n  },\n  \"Wu Wei\": {\n    name: \"Wu Wei\",\n    specialities: [\n      \"Focusing on Breath (for Priests)\",\n      \"Resisting Curses\",\n      \"Sensing Chi\",\n      \"Social Perception\",\n      \"Specific Priests Arts Techniques\"\n    ]\n  }\n};\n","import * as constants from \"../../../perks/constants/discounts\";\nimport { IDiscountSkill } from \"../../../perks/discounts\";\n\nimport { skills, TSkillName } from \"../../../data/skills\";\n\nexport function discountSkillFactory(\n  value: number,\n  subset?: TSkillName[]\n): IDiscountSkill {\n  if (subset && subset.length > 0) {\n    return { skills: subset, type: constants.DISCOUNT_SKILL, value };\n  } else {\n    return {\n      skills: Object.keys(skills) as TSkillName[],\n      type: constants.DISCOUNT_SKILL,\n      value\n    };\n  }\n}\n","/* tslint:disable:max-line-length */\nimport { bonusChi, bonusDestiny } from \"../state/actions/perks/bonuses\";\nimport { discountSkillFactory } from \"../state/actions/perks/discounts\";\n\nimport { IBonus } from \"../perks/bonuses\";\nimport { IDiscount } from \"../perks/discounts\";\n\nexport interface IDataRank {\n  name: string;\n  description: string;\n  key: string;\n  value: 0 | 1 | 2 | 3 | 4 | 5 | 6;\n  perks: Array<IBonus | IDiscount>;\n}\n\nexport interface IDataRanks extends Array<IDataRank> {}\n\nexport const ranks: IDataRanks = [\n  {\n    description:\n      \"River size and Joss limit are 1, no Aura or Chi replenishment, Lake is 5, maximum skill bonus is +5.\",\n    key: \"unranked\",\n    name: \"Unranked\",\n    perks: [bonusDestiny(10), discountSkillFactory(10), bonusChi(8, \"general\")],\n    value: 0\n  },\n  {\n    description:\n      \"River size, Joss, Chi replenishment and Chi Aura limit are 1. Lake size is 6. Maximum skill bonus is +5.\",\n    key: \"5th_rank\",\n    name: \"5th Rank\",\n    perks: [bonusDestiny(15), discountSkillFactory(10), bonusChi(8, \"general\")],\n    value: 1\n  },\n  {\n    description:\n      \"River size, Joss, Chi replenishment and Chi Aura limit are 2. Lake size is 7. Maximum skill bonus is +10.\",\n    key: \"4th_rank\",\n    name: \"4th Rank\",\n    perks: [\n      bonusDestiny(20),\n      discountSkillFactory(20),\n      bonusChi(10, \"general\")\n    ],\n    value: 2\n  },\n  {\n    description:\n      \"River size, Joss, Chi replenishment and Chi Aura limit are 3. Lake size is 8. Maximum skill bonus is +15.\",\n    key: \"3rd_rank\",\n    name: \"3rd Rank\",\n    perks: [\n      bonusDestiny(50),\n      discountSkillFactory(20),\n      bonusChi(10, \"general\")\n    ],\n    value: 3\n  },\n  {\n    description:\n      \"River size, Joss, Chi replenishment and Chi Aura limit are 4. Lake size is 9. Maximum skill bonus is +20.\",\n    key: \"2nd_rank\",\n    name: \"2nd Rank\",\n    perks: [\n      bonusDestiny(100),\n      discountSkillFactory(20),\n      bonusChi(10, \"general\")\n    ],\n    value: 4\n  },\n  {\n    description:\n      \"River size, Joss, Chi replenishment and Chi Aura limit are 5. Lake size is 10. Maximum skill bonus is +25.\",\n    key: \"1st_rank\",\n    name: \"1st Rank\",\n    perks: [\n      bonusDestiny(150),\n      discountSkillFactory(20),\n      bonusChi(10, \"general\")\n    ],\n    value: 5\n  }\n];\n\nexport function validateRank(rank: string): void {\n  const foundRank = ranks.find((dataRank: IDataRank) => dataRank.key === rank);\n  if (!foundRank) {\n    throw new Error('Invalid rank \"' + rank + '\"');\n  }\n}\n\nexport function getRank(rank: string): IDataRank {\n  const foundRank = ranks.find((dataRank: IDataRank) => dataRank.key === rank);\n  if (!foundRank) {\n    throw new Error('Invalid rank \"' + rank + '\"');\n  }\n  return foundRank;\n}\n","import { TChiName } from \"../data/chi\";\nimport { TSkillName } from \"../data/skills\";\nimport * as constants from \"./constants/bonuses\";\n\nexport interface IBonusDestiny {\n  type: constants.BONUS_DESTINY;\n  value: number;\n}\n\nexport interface IBonusEntanglement {\n  type: constants.BONUS_ENTANGLEMENT;\n  value: number;\n}\n\nexport interface IBonusChi {\n  type: constants.BONUS_CHI;\n  chi: TChiName;\n  value: number;\n}\n\nexport interface IBonusCultivation {\n  type: constants.BONUS_CULTIVATION;\n  chi: TChiName;\n  value: number;\n}\n\nexport interface IBonusOneAmongN {\n  type: constants.BONUS_ONE_AMONG_N;\n  bonuses: { [key in string]: IBonus };\n}\n\n// TODO : validity & auto resolution ?\nexport interface IBonusSkillRank {\n  type: constants.BONUS_SKILL_RANK;\n  skill: TSkillName;\n}\n\nexport interface IBonusSpeciality {\n  type: constants.BONUS_SPECIALITY;\n  skill: TSkillName;\n  speciality: string;\n}\n\nexport type IBonus =\n  | IBonusDestiny\n  | IBonusEntanglement\n  | IBonusChi\n  | IBonusCultivation\n  | IBonusOneAmongN\n  | IBonusSkillRank\n  | IBonusSpeciality;\n\nexport function isBonus(bonus: any): boolean {\n  switch (bonus.type) {\n    case constants.BONUS_DESTINY:\n    case constants.BONUS_ENTANGLEMENT:\n    case constants.BONUS_CHI:\n    case constants.BONUS_CULTIVATION:\n    case constants.BONUS_ONE_AMONG_N:\n    case constants.BONUS_SKILL_RANK:\n    case constants.BONUS_SPECIALITY:\n      return true;\n    case constants.BONUS_DISCOUNT:\n    default:\n      return false;\n  }\n}\n","import { TChiName } from \"../data/chi\";\nimport { KUNGFU_TYPE } from \"../data/kungfu/types\";\nimport { TSkillName } from \"../data/skills\";\nimport * as constants from \"./constants/discounts\";\n\nexport interface IDiscountSkill {\n  type: constants.DISCOUNT_SKILL;\n  skills: TSkillName[];\n  value: number;\n}\n\nexport interface IDiscountChi {\n  type: constants.DISCOUNT_CHI;\n  chis: TChiName[];\n  value: number;\n}\n\nexport interface IDiscountLoresheet {\n  type: constants.DISCOUNT_LORESHEET;\n  uids: string[];\n  value: number;\n}\n\nexport interface IDiscountLoresheetOption {\n  type: constants.DISCOUNT_LORESHEET_OPTION;\n  uids: Array<{ lsUid: string; optUid: string[] }>;\n  value: number;\n}\n\nexport interface IDiscountKungfu {\n  type: constants.DISCOUNT_KUNGFU_STYLE;\n  uids: string[];\n  kfType: KUNGFU_TYPE[];\n  value: number;\n}\n\nexport interface IDiscountKungfuTechnique {\n  type: constants.DISCOUNT_KUNGFU_TECHNIQUE;\n  uids: Array<{ styleUid: string }>;\n  kfType: KUNGFU_TYPE[];\n  value: number;\n}\n\nexport type IDiscount =\n  | IDiscountSkill\n  | IDiscountChi\n  | IDiscountLoresheet\n  | IDiscountLoresheetOption\n  | IDiscountKungfu\n  | IDiscountKungfuTechnique;\n\nexport function isDiscount(r: any): boolean {\n  switch (r.type) {\n    case constants.DISCOUNT_CHI:\n    case constants.DISCOUNT_SKILL:\n    case constants.DISCOUNT_LORESHEET:\n    case constants.DISCOUNT_LORESHEET_OPTION:\n    case constants.DISCOUNT_KUNGFU_STYLE:\n    case constants.DISCOUNT_KUNGFU_TECHNIQUE:\n      return true;\n    default:\n      return false;\n  }\n}\n\nexport type TDiscountsState = IDiscount[];\n\nexport function createState(): TDiscountsState {\n  return [];\n}\n","export type TChiName = 'general' | 'wood' | 'fire' | 'earth' | 'water' | 'metal' | 'enlightened' | 'corrupt';\n\nexport const chiNames: TChiName[] =\n[ 'general' , 'wood' , 'fire' , 'earth' , 'water' , 'metal' , 'enlightened' , 'corrupt' ];\n","import { chiNames, TChiName } from \"../data/chi\";\n\nexport type TChiState = {\n  [chi in TChiName]: { value: number; cultivation: number };\n};\n\nexport function createState(): TChiState {\n  const state = {} as TChiState;\n  chiNames.forEach((chi: TChiName) => {\n    state[chi] = { value: 0, cultivation: 0 };\n  });\n  return state;\n}\n\nexport function increase(\n  state: TChiState,\n  name: TChiName,\n  value: number\n): void {\n  state[name].value += value;\n}\n\nexport function increaseCultivation(\n  state: TChiState,\n  name: TChiName,\n  increaseValue: number\n): void {\n  let cultivation = state[name].cultivation + increaseValue;\n  let chiValue = state[name].value;\n\n  const costMultiplier =\n    name === \"enlightened\" || name === \"corrupt\"\n      ? 10\n      : name !== \"general\"\n      ? 5\n      : 1;\n\n  while (cultivation - costMultiplier * Math.max(1, chiValue) >= 0) {\n    cultivation -= costMultiplier * Math.max(1, chiValue);\n    chiValue++;\n  }\n\n  state[name].value = chiValue;\n  state[name].cultivation = cultivation;\n}\n\nexport function canBuyChi(): boolean {\n  return true;\n}\n","import { IStoreState } from \"./type\";\n\nexport function chiAura(state: IStoreState): number {\n  if (state.rank) {\n    return state.rank.value;\n  }\n  return 0;\n}\n\nexport function chiResplenish(state: IStoreState): number {\n  if (state.rank) {\n    return state.rank.value;\n  }\n  return 0;\n}\n\nexport function lake(state: IStoreState): number {\n  if (state.rank) {\n    return state.rank.value + 5;\n  }\n  return 5;\n}\n\nexport function river(state: IStoreState): number {\n  if (state.rank) {\n    return Math.max(1, state.rank.value);\n  }\n  return 1;\n}\n\nexport function joss(state: IStoreState): number {\n  if (state.rank) {\n    return Math.max(1, state.rank.value);\n  }\n  return 1;\n}\n\nexport function maxSkillBonus(state: IStoreState): number {\n  if (state.rank) {\n    return Math.max(5, 5 * state.rank.value);\n  }\n  return 5;\n}\n","import { skills as data, TSkillName } from \"../data/skills\";\nimport { maxSkillBonus } from \"./derived\";\nimport { IStoreState } from \"./type\";\n\ninterface ISkill {\n  name: string;\n  specialities: string[];\n  value: number;\n}\n\nexport type TSkillsState = { [skill in TSkillName]: ISkill };\n\nexport function createState(): TSkillsState {\n  const state = {};\n  Object.keys(data).forEach(skill => {\n    Object.defineProperty(state, skill, {\n      value: {\n        name: skill,\n        specialities: [],\n        value: 0\n      },\n      writable: true\n    });\n  });\n  return state as TSkillsState;\n}\n\nexport function increase(\n  state: TSkillsState,\n  skillName: TSkillName,\n  maxSkillValue: number\n): void {\n  const old = state[skillName].value;\n  if (old + 5 > maxSkillValue) {\n    throw new Error(\"Skill \" + skillName + \" overflow\");\n  }\n  state[skillName].value += 5;\n}\n\nexport function isSpecialityPresent(\n  state: TSkillsState,\n  skillName: TSkillName,\n  specialityName: string\n): boolean {\n  const specialityIndex = state[skillName].specialities.findIndex(\n    (speciality: string) => speciality === specialityName\n  );\n  return specialityIndex !== -1;\n}\n\nexport function addSpeciality(\n  state: TSkillsState,\n  skillName: TSkillName,\n  specialityName: string\n): void {\n  if (isSpecialityPresent(state, skillName, specialityName)) {\n    throw new Error(\n      'Something went wrong, speciality \"' +\n        specialityName +\n        '\" for skill \"' +\n        skillName +\n        '\" already bought'\n    );\n  }\n  state[skillName].specialities.push(specialityName);\n}\n\nexport function canBuySkill(\n  state: IStoreState,\n  skillName: TSkillName\n): boolean {\n  const value = state.skills[skillName].value;\n  const max = maxSkillBonus(state);\n  return !(value + 5 > max);\n}\n\nexport function canBuySpeciality(\n  state: IStoreState,\n  skillName: TSkillName,\n  speciality: string\n): boolean {\n  return !isSpecialityPresent(state.skills, skillName, speciality);\n}\n","import { ICost } from \"./costs\";\nimport { IStoreState } from \"./type\";\n\nimport { IDiscount, isDiscount } from \"../perks/discounts\";\n\nexport type TDiscountsState = IDiscount[];\n\nexport function createState(): TDiscountsState {\n  return [];\n}\n\nexport function pushToDiscounts(\n  state: IStoreState,\n  discounts: IDiscount[]\n): void {\n  discounts\n    .filter((r: IDiscount) => isDiscount(r))\n    .forEach((r: IDiscount) => {\n      state.discounts.push(r);\n    });\n}\n\nexport function getDiscountIndexes(\n  state: IStoreState,\n  predicate: (d: IDiscount) => boolean\n) {\n  const discountIdx = state.discounts\n    .map((discount: IDiscount, idx: number) => {\n      if (predicate(discount)) {\n        return idx;\n      }\n      return NaN;\n    })\n    .filter((value: number) => !isNaN(value));\n  if (discountIdx) {\n    return discountIdx;\n  } else {\n    return [];\n  }\n}\n\nexport function updateDiscounts(state: IStoreState, cost: ICost): void {\n  // Update the discount\n  if (!cost.discounts) {\n    return;\n  }\n\n  cost.discounts.forEach(costDiscount => {\n    state.discounts[costDiscount.idx].value = costDiscount.newValue;\n\n    if (costDiscount.newValue === 0) {\n      // Remove the empty discount\n      state.discounts.splice(costDiscount.idx, 1);\n    }\n  });\n}\n","import { getRank } from \"../data/ranks\";\nimport { IStoreState } from \"./type\";\n\n// Sub Reducers\nimport { IBonus, isBonus } from \"../perks/bonuses\";\nimport { IDiscount, isDiscount } from \"../perks/discounts\";\nimport { applyBonuses } from \"./bonuses\";\nimport { pushToDiscounts } from \"./discounts\";\n\nexport function setRank(state: IStoreState, rankKey: string): void {\n  const dataRank = getRank(rankKey);\n  state.rank = { name: dataRank.name, value: dataRank.value };\n  applyBonuses(state, dataRank.perks.filter(p => isBonus(p)) as IBonus[]);\n  pushToDiscounts(state, dataRank.perks.filter(p =>\n    isDiscount(p)\n  ) as IDiscount[]);\n}\n","import produce from \"immer\";\n\nimport { IBonus, isBonus } from \"../perks/bonuses\";\n\nimport * as chi from \"./chi\";\nimport { maxSkillBonus } from \"./derived\";\nimport * as skills from \"./skills\";\n\nimport { IStoreState } from \"./type\";\n\nimport * as constants from \"../perks/constants/bonuses\";\n\nexport type TBonusesState = IBonus[];\n\nexport function createState(): TBonusesState {\n  return [];\n}\n\nexport function applyBonuses(\n  baseState: IStoreState,\n  bonuses: IBonus[]\n): IStoreState {\n  const nextState = produce(baseState, draftState => {\n    bonuses\n      .filter((bonus: IBonus) => isBonus(bonus))\n      .forEach((bonus: IBonus) => {\n        switch (bonus.type) {\n          case constants.BONUS_DESTINY:\n            draftState.destiny += bonus.value;\n            break;\n          case constants.BONUS_ENTANGLEMENT:\n            draftState.entanglement += bonus.value;\n            break;\n          case constants.BONUS_CHI:\n            chi.increase(draftState.chi, bonus.chi, bonus.value);\n            break;\n          case constants.BONUS_CULTIVATION:\n            chi.increaseCultivation(draftState.chi, bonus.chi, bonus.value);\n            break;\n          case constants.BONUS_SKILL_RANK:\n            const max = maxSkillBonus(draftState);\n            // TODO : overflows\n            skills.increase(draftState.skills, bonus.skill, max);\n            break;\n          case constants.BONUS_SPECIALITY:\n            // TODO : already speciality\n            skills.addSpeciality(\n              draftState.skills,\n              bonus.skill,\n              bonus.speciality\n            );\n            break;\n          default:\n            return;\n        }\n      });\n  });\n  return nextState;\n}\n","export const CHI_BUY = 'CHI_BUY';\nexport type CHI_BUY = typeof CHI_BUY;\n","/* tslint:disable:import-sources-order named-imports-order ordered-imports*/\n/* eslint-disable import/first */\nimport { IBonus } from \"../../perks/bonuses\";\nimport { IDiscount } from \"../../perks/discounts\";\nimport { IEffect } from \"../../perks/effects\";\n\nexport type IPerk = IBonus | IDiscount | IEffect;\n\nexport interface IDataLoresheetOptionPrerequisiteAND {\n  type: \"AND\";\n  prerequisites: string[];\n}\n\nexport interface IDataLoresheetOptionPrerequisiteOR {\n  type: \"OR\";\n  prerequisites: string[];\n}\n\nexport type IDataLoresheetOptionPrerequisite =\n  | string\n  | IDataLoresheetOptionPrerequisiteOR\n  | IDataLoresheetOptionPrerequisiteAND;\n\nexport interface IDataLoresheetOption {\n  uid: string;\n  type: string;\n  cost: number | { min: number; max: number };\n  description: string;\n  repeatable: boolean;\n  prerequisites: IDataLoresheetOptionPrerequisite[];\n  perks: IPerk[];\n  payload?: string;\n}\n\nexport interface IDataLoresheet {\n  uid: string;\n  name: string;\n  category: string;\n  cost: number;\n  description: string;\n  ruleset: string;\n  options: IDataLoresheetOption[];\n}\n\n// Core rulebook //\n// Rivers and Lakes\nimport { jianghu } from \"./core/riversandlakes/jianghu\";\nimport { crouchingtigersandhiddendragons } from \"./core/riversandlakes/crouchingtigersandhiddendragons\";\nimport { wulin } from \"./core/riversandlakes/wulin\";\nimport { wulinsage } from \"./core/riversandlakes/wulinsage\";\n// Wulin Factions\n// Orthodox Factions\n// Unorthodox Factions\n// The Wulin Greats\n// Forest and Mountains\n// The Philosophies of Shen Zhou\n// Relationship in Shen Zhou\n// Heretic Lores\n// Secrets Arts\nexport const loresheets: IDataLoresheet[] = [\n  jianghu,\n  crouchingtigersandhiddendragons,\n  wulin,\n  wulinsage\n];\n\nexport const loresheetsCategories: string[] = loresheets\n  .map(ls => ls.category)\n  .filter(\n    (value: string, index: number, self: string[]) =>\n      self.indexOf(value) === index\n  );\n\nexport function validateLoresheet(uid: string): void {\n  if (!loresheets.find((loresheet: IDataLoresheet) => loresheet.uid === uid)) {\n    throw new Error('Invalid loresheet \"' + uid + '\"');\n  }\n}\n\nexport function validateLoresheetOption(lsUid: string, uid: string): void {\n  validateLoresheet(lsUid);\n  const loresheetIndex = loresheets.findIndex(\n    (ls: IDataLoresheet) => ls.uid === lsUid\n  );\n  if (\n    !loresheets[loresheetIndex].options.find(\n      (option: IDataLoresheetOption) => option.uid === uid\n    )\n  ) {\n    throw new Error('Invalid loresheet option \" + uid + \"');\n  }\n}\n\nexport function getLoresheetData(lsUid: string): IDataLoresheet {\n  const idxLS = loresheets.findIndex(ls => ls.uid === lsUid);\n  return loresheets[idxLS];\n}\n\nexport function getLoresheetOptionData(\n  lsUid: string,\n  optUid: string\n): IDataLoresheetOption {\n  const idxLS = loresheets.findIndex(ls => ls.uid === lsUid);\n  const idxOpt = loresheets[idxLS].options.findIndex(o => o.uid === optUid);\n  return loresheets[idxLS].options[idxOpt];\n}\n","import { IDataLoresheet } from \"../../../loresheets\";\n\n/* tslint:disable:max-line-length */\n/* tslint:disable:object-literal-sort-keys */\nexport const jianghu: IDataLoresheet = {\n  uid: \"jianghu\",\n  name: \"The Jiang Hu\",\n  category: \"Rivers and Lakes\",\n  cost: 0,\n  ruleset: \"core\",\n  description:\n    \"Within Shen Zhou, there is a parallel world of outsiders and outcasts. Some are born into this world, others are forced into it, and many more choose to live in it to escape the boundaries and limitations imposed on them by regular society. The heroes and rogues within this world are abjured by the common people as threats to an orderly life, but for many they represent a hope of escape, or advancement, from a life controlled by tradition.\",\n  options: [\n    {\n      uid: \"familiarity\",\n      cost: 2,\n      type: \"Bonus\",\n      description:\n        \"You know how to navigate the Rivers and Lakes outside the Wulin organizations, in other Jiang Hu communities like the criminal underground, the ferrymen guilds, or the pleasure trade. Pick one such group; you get a +5 bonus to social rolls where familiarity with that subculture matters.\",\n      repeatable: true,\n      prerequisites: [],\n      perks: [],\n      payload: \"an organization\"\n    },\n    {\n      uid: \"knunderground\",\n      cost: { min: 2, max: 10 },\n      type: \"Fortune\",\n      description:\n        \"Once per session, upon arriving in a new location, you may declare to have basic knowledge of the local Jiang Hu underground, including important organizations and whos in charge. This includes Wulin factions.\",\n      repeatable: true,\n      prerequisites: [],\n      perks: []\n    },\n    {\n      uid: \"statusunderground\",\n      cost: { min: 1, max: 5 },\n      description:\n        \"You are already known within one or more of the aforementioned organizations, and have some Status with them.\",\n      type: \"Status\",\n      repeatable: true,\n      prerequisites: [\n        { type: \"OR\", prerequisites: [\"familiarity\", \"knunderground\"] }\n      ],\n      perks: [],\n      payload: \"an organization\"\n    }\n  ]\n};\n","import {\n  bonusOneAmongN,\n  bonusSpeciality\n} from \"../../../../state/actions/perks/bonuses\";\nimport { IDataLoresheet } from \"../../../loresheets\";\n\n/* tslint:disable:max-line-length */\n/* tslint:disable:object-literal-sort-keys */\nexport const crouchingtigersandhiddendragons: IDataLoresheet = {\n  uid: \"tigersanddragons\",\n  name: \"Crouching Tigers and Hidden Dragons\",\n  category: \"Rivers and Lakes\",\n  cost: 1,\n  ruleset: \"core\",\n  description:\n    \"The saying goes, The Jiang Hu is full of Crouching Tigers and Hidden Dragons. So many in the martial community have every reason to hide their true face, and their true power. Who knows who might prove to be a powerful fighter in seclusion?\",\n  options: [\n    {\n      uid: \"hiddenid\",\n      cost: { min: 0, max: 5 },\n      type: \"Disadvantage\",\n      description:\n        \"You are hiding your true identity behind a disguise. Are you a noble passing as a beggar? Are you masquerading as someone of the opposite gender? Do you pretend to be a member of a certain organization while in reality serving another? Once a session, whenever the veil of your disguise seems to be pierced and protecting your fake identity gets you in trouble, earn 1 additional Destiny. If this is your first or second disadvantage you can get it for free, otherwise it costs 5 Destiny.\",\n      repeatable: false,\n      prerequisites: [],\n      perks: [],\n      payload: \"an hidden identity\"\n    },\n    {\n      uid: \"stabbingguesttechnique\",\n      cost: 3,\n      description:\n        \"Following in the traditions of the Cike of the past, you learn or develop the Stabbing Guest Technique. This helps you when you seek to gain the trust of someone that you seek to hurt, damage, or destroy! As long as you have this stated purpose and make sure to describe your actions as fitting with your devious plans, you get a +5 Action Bonus to all appropriate social rolls to gain their trust, appear friendly and harmless, and enter into their confidence. This bonus is lost if you stop harboring bad intentions.\",\n      type: \"Secret\",\n      repeatable: false,\n      prerequisites: [],\n      perks: []\n    },\n    {\n      uid: \"sensechi\",\n      cost: 3,\n      description:\n        \"Get the Wu Wei Specialty: Sense Chi or the Stealth Specialty: Hide Killer Intent for free\",\n      type: \"Bonus\",\n      repeatable: false,\n      prerequisites: [],\n      perks: [\n        bonusOneAmongN({\n          sensechi: bonusSpeciality(\"Wu Wei\", \"Sense Chi\"),\n          hidekillerintent: bonusSpeciality(\"Wu Wei\", \"Hide Killer Intent\")\n        })\n      ]\n    }\n  ]\n};\n","import { IDataLoresheet } from \"../../../../data/loresheets\";\n\n/* tslint:disable:max-line-length */\n/* tslint:disable:object-literal-sort-keys */\nexport const wulin: IDataLoresheet = {\n  uid: \"wulin\",\n  name: \"The Wulin\",\n  category: \"Rivers and Lakes\",\n  cost: 0,\n  ruleset: \"core\",\n  description:\n    \"The Wulin is considered a greater family for those who dedicate their lives to the martial arts, regardless of their origins and goals, for only a warrior can truly understand another warrior, even if they stand on opposite sides of the battlefield. It is said that Heaven has a place assigned for everyone. The path of Kung Fu is for those who reject this idea, who believe that fate is in their hands, and that their fortunes are forged by the strength of their spirit and the fire of their passion.\",\n  options: [\n    {\n      uid: \"tieswithanother\",\n      cost: { min: 1, max: 10 },\n      type: \"Involvement\",\n      description:\n        \"The World of Martial Arts is full of heroes. Some heroes become teachers, friends closer than brothers, lovers, or soul mates, while others become sworn rivals or hated enemies. Spend destiny to tie your fate to that of any other character that may appeal to you. In order to declare an existing relationship between the two of you, make a current action (such as defeating them in battle or showing up to assist them), or make sure that you will develop such a relationship shortly. As usual, refer to Introduction to Loresheets for costs.\",\n      repeatable: true,\n      prerequisites: [],\n      perks: [],\n      payload: \"a hero\"\n    },\n    {\n      uid: \"historicalfact\",\n      cost: { min: 3, max: 15 },\n      type: \"Fortune\",\n      description:\n        \"The history of the Wulin is shrouded in the mists of legends and myths, but you manage to shine a light on one particular facet! Introduce a historical fact of your own design that pertains to your current situation and which gives you an advantage of some sort, such as an alternative solution to a problem. This might concern a person, an organization, or even the Wulin as a whole. Needless to say, the Sage is the final arbitrator of cost.\",\n      repeatable: true,\n      prerequisites: [],\n      perks: [],\n      payload: \"an historical fact\"\n    }\n  ]\n};\n","import { IDataLoresheet } from \"../../../../data/loresheets\";\n\n/* tslint:disable:max-line-length */\n/* tslint:disable:object-literal-sort-keys */\nexport const wulinsage: IDataLoresheet = {\n  uid: \"wulinsage\",\n  name: \"The Wulin Sage\",\n  category: \"Rivers and Lakes\",\n  cost: 0,\n  ruleset: \"core\",\n  description:\n    \"Legends speak of a mythical figure that oversees the Wulin on behalf of Heaven. The Sage records all of the history and affairs of the martial world; he decides who is worthy of advancement and reports to the Celestial Order on the advancement and deeds of Chivalrous heroes, and to the Hellish Courts on those of the selfish. He sees that those who seek greater challenges reap greater glory and attain higher power.\",\n  options: [\n    {\n      uid: \"fact\",\n      cost: { min: 5, max: 15 },\n      type: \"Fortune\",\n      description:\n        \"With Sage approval, you may introduce a fact about the truth behind the Wulin Sage that would influence the current story.\",\n      repeatable: true,\n      prerequisites: [],\n      perks: [],\n      payload: \"a fact\"\n    },\n    {\n      uid: \"tieswithsage\",\n      cost: { min: 5, max: 10 },\n      type: \"Involvement\",\n      description: \"Your destiny will be tied to the figure of the Wulin Sage.\",\n      repeatable: false,\n      prerequisites: [],\n      perks: []\n    },\n    {\n      uid: \"tiensnpcwithsage\",\n      cost: { min: 3, max: 10 },\n      type: \"Involvement\",\n      description:\n        \"The Destiny of an NPC of your choice will be or is tied to the figure of the Wulin Sage.\",\n      repeatable: true,\n      prerequisites: [],\n      perks: [],\n      payload: \"a NPC\"\n    }\n  ]\n};\n","import { IEffect } from \"../../state/effects\";\nimport { TChiName } from \"../chi\";\nimport { WEAPON_TYPE } from \"../weapons\";\n\n// Constants used to differentiate between kungfu\nexport const KUNGFU_EXTERNAL = \"KUNGFU_EXTERNAL\";\nexport type KUNGFU_EXTERNAL = typeof KUNGFU_EXTERNAL;\n\nexport const KUNGFU_INTERNAL = \"KUNGFU_INTERNAL\";\nexport type KUNGFU_INTERNAL = typeof KUNGFU_INTERNAL;\n\nexport type KUNGFU_TYPE = KUNGFU_INTERNAL | KUNGFU_EXTERNAL;\n\nexport interface IDataExternalKungfuStatistics {\n  [index: string]: number;\n  speed: number;\n  footwork: number;\n  strike: number;\n  damage: number;\n  block: number;\n  toughness: number;\n}\n\nexport interface IDataExternalKungfuPrerequisite {\n  uid: string;\n}\n\nexport interface IDataExternalKungfuTechnique {\n  name: string;\n  cost: number;\n  description: string;\n  effect: IEffect;\n  uid: string;\n  prerequisites?: IDataExternalKungfuPrerequisite[];\n}\n\nexport interface IDataInternalKungfuTechnique {\n  name: string;\n  level: number; // 1 | 2 | 3 | 4 | 5;\n  description: string;\n  effect: IEffect;\n  uid: string;\n}\n\nexport interface IDataExternalKungfu {\n  name: string;\n  qualities: string[];\n  laugths: string;\n  fears: string;\n  weapons: WEAPON_TYPE[];\n  statistics: IDataExternalKungfuStatistics;\n  techniques: IDataExternalKungfuTechnique[];\n  uid: string;\n}\n\nexport interface IDataInternalKungfu {\n  name: string;\n  element: TChiName;\n  description: string;\n  techniques: IDataInternalKungfuTechnique[];\n  uid: string;\n}\n","export const EFFECT_COMBAT_STATISTIC = 'EFFECT_COMBAT_STATISTIC';\nexport type EFFECT_COMBAT_STATISTIC = typeof EFFECT_COMBAT_STATISTIC;\n\nexport const EFFECT_CONDITIONAL_TEXT = 'EFFECT_CONDITIONAL_TEXT';\nexport type EFFECT_CONDITIONAL_TEXT = typeof EFFECT_CONDITIONAL_TEXT;\n\nexport const EFFECT_CHI_THRESHOLD_INCREASE_BASE_CHI = 'EFFECT_CHI_THRESHOLD_INCREASE_BASE_CHI';\nexport type EFFECT_CHI_THRESHOLD_INCREASE_BASE_CHI = typeof EFFECT_CHI_THRESHOLD_INCREASE_BASE_CHI;\n","import * as constants from \"../../../perks/constants/effects\";\nimport {\n  IEffectChiThresholdIncreaseBaseChi,\n  IEffectCombatStatistic,\n  IEffectConditionalText,\n  IEffectStatistic\n} from \"../../../perks/effects\";\n\nexport function combatStatistic(\n  statistic: IEffectStatistic,\n  increase: number\n): IEffectCombatStatistic {\n  return { increase, statistic, type: constants.EFFECT_COMBAT_STATISTIC };\n}\n\nexport function conditionalText(textInput: string[]): IEffectConditionalText {\n  const text = textInput.filter((line: string) => line.length > 0);\n  if (text.length === 0) {\n    throw new Error(\"Error with conditionalText : empty text\");\n  }\n  return { text, type: constants.EFFECT_CONDITIONAL_TEXT };\n}\n\nexport function conditionalOnelineText(text: string): IEffectConditionalText {\n  return conditionalText(new Array<string>(text));\n}\n\nexport function increaseBaseChiForThreshold(\n  chiIncrease: number\n): IEffectChiThresholdIncreaseBaseChi {\n  return {\n    chiIncrease,\n    type: constants.EFFECT_CHI_THRESHOLD_INCREASE_BASE_CHI\n  };\n}\n","import * as effects from \"../../../state/actions/perks/effects\";\nimport { IDataExternalKungfu } from \"../types\";\n\n/* tslint:disable:max-line-length */\n/* tslint:disable:object-literal-sort-keys */\n\nexport const blossomHarvest: IDataExternalKungfu = {\n  name: \"Blossom Harvest\",\n  uid: \"Blossom Harvest\",\n  qualities: [\n    \"This is one of the most honest and straightforward fighting styles there is. It dispenses with trickery or fancy moves, and compensates with sweat and resilience. Its training methods use everyday items and situations, such as running upstream through a river to build stamina, and using farming tools to practice weapon forms. Most of its techniques and theories also incorporate metaphors that are easy for common people to understand.\",\n    \"Because it is so approachable, it has achieved a folk hero status; peasant rebellions often start training with this fighting style, calling those who stand against injustice Blossoming Heroes.\"\n  ],\n  weapons: [\"Massive\", \"Staff\", \"Unarmed\"],\n  laugths:\n    \"A chain is only as strong as its weakest link, and so Blossom Harvest laughs at styles that are overly complicated or full of flourishes. These intricate methods are easily smashed aside and broken. It likewise laughs at such trivialities as being outnumbered, or disadvantageous terrain  pure grit and hellish training have rendered Blossoming Heroes fearless to such things!\",\n  fears:\n    \"This style has problems when facing fighters who are reactive. Blossom Harvests openness is easy to read and predict, giving such opponents everything they need. Its also ill-prepared for enemies who wield supernatural forces or influence.\",\n  statistics: {\n    speed: 5,\n    footwork: 0,\n    strike: 5,\n    damage: 10,\n    block: 5,\n    toughness: 10\n  },\n  techniques: [\n    {\n      name: \"Heart-Fire Temper Skill\",\n      cost: 4,\n      description:\n        \"Pain and fear blunt edges worse than rust, but your training has seen every bone broken and regrown stronger. To you, pain is but a reminder of your lessons and your teachers wisdom.\",\n      effect: effects.conditionalOnelineText(\n        \"When you have a physical wound condition, this styles Damage bonus increases to +15.\"\n      ),\n      uid: \"Heart-Fire Temper Skill\"\n    },\n    {\n      name: \"Iron Skin\",\n      cost: 5,\n      description:\n        \"Hardened muscles and willpower have given you great resistance to physical punishment. Spears bend and sticks break upon striking you!\",\n      effect: effects.combatStatistic(\"toughness\", 5),\n      uid: \"Iron Skin\"\n    },\n    {\n      name: \"Iron Skin\",\n      uid: \"Iron Skin 2\",\n      cost: 4,\n      description:\n        \"Hardened muscles and willpower have given you great resistance to physical punishment. Spears bend and sticks break upon striking you!\",\n      effect: effects.increaseBaseChiForThreshold(2),\n      prerequisites: [{ uid: \"iron_skin_1\" }]\n    },\n    {\n      name: \"Nine Mountains Great Strength\",\n      uid: \"Nine Mountains Great Strength\",\n      cost: 5,\n      description:\n        \"Your attacks are like mountains: grand and overwhelming, undeniable and unmovable.\",\n      effect: effects.combatStatistic(\"strike\", 5)\n    },\n    {\n      name: \"No Vermin in the World\",\n      uid: \"No Vermin in the World\",\n      cost: 2,\n      description:\n        \"The corrupt are numerous and the virtuous seem but few these days. Villages are razed to the ground and orphans cry in the streets. The great men of this age therefore have no choice but to be Blossoming Heroes, fighting off entire gangs all by themselves!\",\n      effect: effects.conditionalOnelineText(\n        \"All your attacks count as Area attacks for the purpose of damaging groups of Minions.\"\n      )\n    }\n  ]\n};\n","import * as effects from \"../../../state/actions/perks/effects\";\nimport { IDataExternalKungfu } from \"../types\";\n\n/* tslint:disable:max-line-length */\n/* tslint:disable:object-literal-sort-keys */\n\nexport const boneFedWolfFang: IDataExternalKungfu = {\n  name: \"Bone-Fed Wolf Fang\",\n  uid: \"Bone-Fed Wolf Fang\",\n  weapons: [\"Massive\", \"Saber\"],\n  qualities: [\n    \"Generations of battlefield experience have shaped a fighting style developed with the practicalities of warfare in mind. Some maneuvers were loosely inspired by the gruesome methods by which wolves drag down their prey. It is mainly taught by the military, but unfortunately, many deserters take up a life of banditry, making this style a common plague for simple people. Because of this, the style is also often called a dogs way of fighting.\",\n    \"This style focuses on hard, linear movements designed to cripple and exploit weaknessesthe supreme soldier needs efficiency, not beauty. It cruelly maims first, and dispatches second. No methods are too dishonest when victory is on the line.\"\n  ],\n  laugths:\n    \"The wolf laughs at honesty, which it rewards with hungry teeth. Above all else, the wolf knows no greater joy than to fight someone vulnerable or caught off guard.\",\n  fears:\n    \"The wolf fears what is hidden or unorthodox, for his many strategies dont account for them. The wolf also dislikes being outnumbered and surrounded; it relies on being the hunting pack, not the hunted.\",\n  statistics: {\n    speed: +5,\n    footwork: +5,\n    strike: +5,\n    damage: +10,\n    block: +5,\n    toughness: +5\n  },\n  techniques: [\n    {\n      name: \"Circling Pack\",\n      cost: 4,\n      description:\n        \"Wolves strike from all sides to overwhelm their prey. You force a response with your weapon, creating an opening so you can deal a blow to a vulnerable spot.\",\n      effect: effects.conditionalOnelineText(\n        \"The difficulty to recover from Disrupt or Disorient Marvels you have imposed is increased by 10.\"\n      ),\n      uid: \"Circling Pack\"\n    },\n    {\n      name: \"Fighting With Fire\",\n      cost: 4,\n      description:\n        \"Fire is a useful, if dangerous, tool to use in war. Its effects on the enemy are startling: set something ablaze that they value and they will flock towards it; set something ablaze that they can afford to lose and they wont dare approach. So too must your strikes be utilized to force them into a pattern and method of your choosing. An enemy that follows your lead is not worthy of the name\",\n      effect: effects.conditionalOnelineText(\n        \"This styles Block and Dodge bonuses increase to +10 against any Disoriented or Disrupted target\"\n      ),\n      uid: \"Fighting With Fire\"\n    },\n    {\n      name: \"March Towards Hell\",\n      cost: 4,\n      description:\n        \"The wise general makes his enemies tire themselves out by forcing them to march towards his position. Once in battle, he cleverly uses his troops to dictate the maneuvers of his enemy. Your attacks follow the same philosophy; your enemies are already defeated, the slaughter a mere formality.\",\n      effect: effects.conditionalOnelineText(\n        \"You may Flood 1 die from the River while you make an attack. If you do, the strike also creates a Disorient or Disrupt condition if it hits.\"\n      ),\n      uid: \"March Towards Hell\"\n    },\n    {\n      name: \"Rainfall at Night\",\n      cost: 4,\n      description:\n        \"The battlefield is where wars are ended, but to a peerless general their outcome is determined beforehand. Assassinate their officers, poison the wells, fill their hearts with propaganda, and creep inside their camps to set fires and steal horses. These are the ways of the warrior who knows neither honor nor defeat.\",\n      effect: effects.conditionalOnelineText(\n        \"This styles Strike bonus increases to +10 against any Disoriented or Disrupted target.\"\n      ),\n      uid: \"Rainfall at Night\"\n    },\n    {\n      name: \"Wolves Devour the Lion\",\n      cost: 4,\n      description:\n        \"Stress bruised ribs until they crack. Lash sore flesh until it rips. The tales of glorious battle are for the halls of gold and silk, but they are built on your acts in the fields of iron and wolves.\",\n      effect: effects.conditionalOnelineText(\n        \"This styles Damage bonus increases to +15 against any Disoriented or Disrupted target.\"\n      ),\n      uid: \"Wolves Devour the Lion\"\n    }\n  ]\n};\n","import * as effects from \"../../../state/actions/perks/effects\";\nimport { IDataInternalKungfu } from \"../types\";\n\n/* tslint:disable:max-line-length */\n/* tslint:disable:object-literal-sort-keys */\n\nexport const boundlessProsperityManual: IDataInternalKungfu = {\n  name: \"Boundless Prosperity Manual\",\n  uid: \"Boundless Prosperity Manual\",\n  description:\n    \"One of the most famous instructions on health is the Boundless Prosperity Manual. It teaches proper breathing and exercise, and brings long life and vigorous health. Some rare copies go much further! They can teach you how to transcend mortal limitations through internal alchemy. Those who carefully decipher the clues and study the methods await a transformation to a higher state of being! These rare copies are all jealously guarded by gangs and martial masters.\",\n  element: \"wood\",\n  techniques: [\n    {\n      level: 1,\n      name: \"Retain Balanced Nature\",\n      uid: \"Retain Balanced Nature\",\n      description:\n        \"You promote the circulation of breath throughout your system by clearing away pollutants and obstructions.\",\n      effect: effects.conditionalOnelineText(\n        \"You have a +5 bonus to a roll made to remove a Disoriented or Disrupted Marvel, provided the Marvel is described as being caused by pain, blocked pressure points, injuries, or similar effects. You can also make such checks using only a single die, instead of needing a set.\"\n      )\n    },\n    {\n      level: 2,\n      name: \"Act Without Resistance\",\n      uid: \"Act Without Resistance\",\n      description:\n        \"One of the many techniques of physical augmentation, the manual teaches you how to achieve a forcefulness in your movements that sweeps away opposing powers.\",\n      effect: effects.conditionalOnelineText(\"You have a +10 bonus to Damage.\")\n    },\n    {\n      level: 2,\n      name: \"Be Where You Must\",\n      uid: \"Be Where You Must\",\n      description:\n        \"The key to increased physical potency isn't just greater power, but knowing when to show restraint. Precision can cut away unnecessary motion and purify your movement.\",\n      effect: effects.conditionalText([\n        \"Round-long duration.\",\n        \"You have a +10 bonus to Footwork.\"\n      ])\n    },\n    {\n      level: 2,\n      name: \"Move According To Purpose\",\n      uid: \"Move According To Purpose\",\n      description:\n        \"Many act without being truly aware of what they are doing. You cast aside such sleepwalking and go through life with certainty and flawlessness.\",\n      effect: effects.conditionalOnelineText(\"You have a +10 bonus to Strike.\")\n    },\n    {\n      level: 2,\n      name: \"Understand What You See\",\n      uid: \"Understand What You See\",\n      description:\n        \"Hone your mind to clarity. All phenomena and occurrences will become obvious!\",\n      effect: effects.conditionalOnelineText(\"You have a +10 bonus to Speed.\")\n    },\n    {\n      level: 3,\n      name: \"Covering Weakness with Strength\",\n      uid: \"Covering Weakness with Strength\",\n      description:\n        \"Many people in need of the Manual are sick, crippled or scarred. It cant restore what is truly lost, but it can help overcome the troubles these unfortunate conditions bring.\",\n      effect: effects.conditionalText([\n        \"Round-long duration. You may spend one Chi per round to extend the techniques duration another round; you must spend the Chi at the beginning of each new round.\",\n        \"Treat your Injury Conditions as if they were one step less severe when determining the Action or Breath penalty they inflict.\",\n        \"This doesnt cure or reduce the conditions, only their effects.\"\n      ])\n    },\n    {\n      level: 3,\n      name: \"Fortifying Oneself against the World\",\n      uid: \"Fortifying Oneself against the World\",\n      description:\n        \"The world is filled with harmful maladies that can damage your organs. The manual teaches methods which bolster the body against such dangers.\",\n      effect: effects.conditionalText([\n        \"Round-long duration.\",\n        \"You have a +10 bonus to your Hardiness and to Chi Aura when resisting Rippling rolls caused by the Doctors Arts.\"\n      ])\n    },\n    {\n      level: 3,\n      name: \"Reflexes Like Lightning\",\n      uid: \"Reflexes Like Lightning\",\n      description:\n        \"Life is tenacious and adaptive. If you can fully attain these qualities, then you can truly be a master of yourself and of others.\",\n      effect: effects.conditionalOnelineText(\n        \"You have a +10 bonus to any Marvel or attempt to break a Wave.\"\n      )\n    },\n    {\n      level: 4,\n      name: \"Five Elements Supreme Combination\",\n      uid: \"Five Elements Supreme Combination\",\n      description:\n        \"You can use internal alchemy to directly enhance the workings of your body.\",\n      effect: effects.conditionalText([\n        \"Round-long duration.\",\n        \"You have a +15 bonus to your Speed, Footwork, Strike, Damage, Block, or Toughness.\",\n        \"You may boost this technique, adding the bonus to another statistic for every two Chi you spend.\"\n      ])\n    },\n    {\n      level: 4,\n      name: \"King of Heaven Shapes the Earth\",\n      uid: \"King of Heaven Shapes the Earth\",\n      description:\n        \"You are struck by a fatal blow, yet miraculously you are alive! You direct blood away from the open wound, dull the pain with your will, and even rearrange your internal organs to keep them away from the injury. Only someone with absolute control over their own body could perform this feat.\",\n      effect: effects.conditionalOnelineText(\n        \"When someone makes a Rippling roll against you to cause an Injury or Medical Condition, reduce the number of dice in the roll by two. You may boost this technique to remove one more die per two Chi spent. You cant reduce the number of dice below one.\"\n      )\n    },\n    {\n      level: 5,\n      name: \"God-Body Transcendence\",\n      uid: \"God-Body Transcendence\",\n      description:\n        \"The final technique of the Manual is not taught, but understood. The accumulation of physical and spiritual health has created an immortal divine body that will endure after death on a higher level of existence. It is exhausting to do so, but you can briefly bring forth this higher nature.\",\n      effect: effects.conditionalText([\n        \"Round-long duration. You may spend Chi each round to extend the techniques duration another round; you must spend the Chi at the beginning of each new round. The first extension costs 1 chi, the second costs 2 chi, the third costs 3 chi, and so on.\",\n        \"Increase your Lake size by 1.\"\n      ])\n    }\n  ]\n};\n","import * as effects from \"../../../state/actions/perks/effects\";\nimport { IDataInternalKungfu } from \"../types\";\n\n/* tslint:disable:max-line-length */\n/* tslint:disable:object-literal-sort-keys */\n\nexport const fireSutra: IDataInternalKungfu = {\n  name: \"Fire Sutra\",\n  uid: \"Fire Sutra\",\n  description:\n    \"Few forces in the world are as primal and respected as fire, so it is no wonder that this sutra was a common art even in ancient days, particularly in the west where the sutras are thought to have been first written. Through meditation and purification, the student learns how to excite his own yang energy to the point of ignition.\",\n  element: \"fire\",\n  techniques: [\n    {\n      level: 1,\n      name: \"Thought of Flame\",\n      uid: \"Thought of Flame\",\n      description:\n        \"The most basic of techniques; once mastered, it is as easy and natural as exhalation. Internal power is gathered and expelled as yang-aspected energy.\",\n      effect: effects.conditionalOnelineText(\n        \"You can use the Burn effect as a Minor Action on your attack with a +5 bonus.\"\n      )\n    },\n    {\n      level: 2,\n      name: \"Breath of Buddha\",\n      uid: \"Breath of Buddha\",\n      description:\n        \"You expel your internal power directly in to your opponent. Normally, a transfer of inner power is used to heal, but your raging energy heats and dehydrates their body.\",\n      effect: effects.conditionalText([\n        \"If your strike hits, and the target has purified Earth, Metal or Water chi, he doesnt recspire any spent Chi points of those types at the end of this round.\",\n        \"You have a +5 bonus to any Disrupt or Disorient Marvel that narratively uses heat or dehydration.\"\n      ])\n    },\n    {\n      level: 2,\n      name: \"Fire to Heaven Ascension\",\n      uid: \"Fire to Heaven Ascension\",\n      description:\n        \"It is the nature of fire to grow tall and turn away from the earth. Following this example, you transform your energy and achieve similar properties.\",\n      effect: effects.conditionalOnelineText(\n        \"You have a +15 bonus to your Footwork when rolling to ascend, such as by jumping or running upwards.\"\n      )\n    },\n    {\n      level: 2,\n      name: \"Fusing Flames\",\n      uid: \"Fusing Flames\",\n      description:\n        \"Bring a flame close to fuel and it will scorch or ignite, but bring two flames together and they only merge into a greater whole. Flame cannot burn flame. Instead of expelling your yang-energy, you keep it close to the surface, so that flames leave you unharmed.\",\n      effect: effects.conditionalText([\n        \"Round-long duration.\",\n        \"You have a +10 bonus to your Chi Aura when rolling to protect against Burn damage.\",\n        \"If one or more fighters other than you within your zone use any points of Fire Chi, you regain one additional point of normal Chi at the end of this round. You can gain only a single point this way, regardless of how many people use Fire Chi or how much they use.\"\n      ])\n    },\n    {\n      level: 2,\n      name: \"Verse of Fire\",\n      uid: \"Verse of Fire\",\n      description:\n        \"A few simple words instruct the student on key points in their body to flow their internal energy through, and in what order. Its easy to learn, but the effects are spectacular: intensely hot fire!\",\n      effect: effects.conditionalOnelineText(\n        \"You can use the Burn effect as a Minor Action on your attack with a +10 bonus\"\n      )\n    },\n    {\n      level: 3,\n      name: \"Elusive Desert Being\",\n      uid: \"Elusive Desert Being\",\n      description:\n        \"The texts speak of gods and ghosts that dwell in hot and distant places. A holy man once traveled far to seek these beings out, and he impressed them with his enlightenment. They rewarded him with their secrets, which he wrote down in this sutra. It speaks of foreign monsters made of smokeless fire, their cunning trickery, and their mirages.\",\n      effect: effects.conditionalText([\n        \"You must activate this technique while rolling initiative, and it lasts for the entire round.\",\n        \"You have a +10 bonus to your Speed and Footwork.\",\n        \"If you Dodge an attack, your opponent can negate this techniques bonus to your roll by including a Hard (30) Awareness check as a minor action on his attack roll. You may boost this technique to increase the difficulty by one step per point of Chi spent.\"\n      ])\n    },\n    {\n      level: 3,\n      name: \"Mantra of Immolation\",\n      uid: \"Mantra of Immolation\",\n      description:\n        \"A profound phrase teaches a transformation of inner power to create fire so hot that it can melt iron.\",\n      effect: effects.conditionalOnelineText(\n        \"You can use the Burn effect as a Minor Action on your attack with a +15 bonus. If it forces an immediate Rippling roll, the roll receives a +5 bonus.\"\n      )\n    },\n    {\n      level: 3,\n      name: \"Nine-Fire Seal\",\n      uid: \"Nine-Fire Seal\",\n      description:\n        \"Power coruscates through your body, flooding your chakra and bringing your nature closer to that of a wildfire than that of a mere man.\",\n      effect: effects.conditionalText([\n        \"Round-long duration.\",\n        \"You have a +20 bonus to your Chi Aura when rolling to protect against Burn or Freeze damage.\",\n        \"If you used this technique last round as well, you have a +5 bonus to your Strike this round.\"\n      ])\n    },\n    {\n      level: 4,\n      name: \"Aura of the Qilin\",\n      uid: \"Aura of the Qilin\",\n      description:\n        \"The mythical Qilin symbolizes prosperity and wisdom, but its ability to surround itself in flames is more practical to you. You may not have seen such a beast yourself, but the sutras describe how to mimic this trick.\",\n      effect: effects.conditionalText([\n        \"Round-long duration.\",\n        \"You have a +30 bonus to your Chi Aura when rolling to protect against Burn or Freeze damage.\",\n        \"If you score a critical success on a Dodge roll, you may Reply against your opponent and inflict one Ripple.\"\n      ])\n    },\n    {\n      level: 4,\n      name: \"The Sun Scripture\",\n      uid: \"The Sun Scripture\",\n      description:\n        \"The sun is a heavenly fire of such strength that it cant reside on the earth. Your yang-energy approaches divine nature: you can create fire more brilliant than any torch, hearth, or forge.\",\n      effect: effects.conditionalOnelineText(\n        \"You can use the Burn effect as a Minor Action on your attack with a +20 bonus. If it forces an immediate Rippling roll, the roll receives a +10 bonus.\"\n      )\n    },\n    {\n      level: 5,\n      name: \"Prayer of Cosmic Rebirth\",\n      uid: \"Prayer of Cosmic Rebirth\",\n      description:\n        \"Religious texts describe the death and resurrection of the universe. A cleansing fire will consume all material existence, and so purge impurities. With a display of utmost skill and benevolence, you call upon the brightest fire that resides within the human spirit to free a life from its current, unclean incarnation.\",\n      effect: effects.conditionalOnelineText(\n        \"You can use the Burn effect as a Minor Action on your attack with a +20 bonus. If it forces an immediate Rippling roll, the roll receives a +15 bonus; any Chi Aura used to protect against this damage costs 2 Chi points per die to purchase.\"\n      )\n    }\n  ]\n};\n","/* eslint-disable import/first */\nimport {\n  IDataExternalKungfu,\n  IDataExternalKungfuTechnique,\n  IDataInternalKungfu,\n  IDataInternalKungfuTechnique,\n  KUNGFU_EXTERNAL,\n  KUNGFU_INTERNAL,\n  KUNGFU_TYPE\n} from \"./types\";\n\nimport { blossomHarvest } from \"./externals/blossom-harvest\";\nimport { boneFedWolfFang } from \"./externals/bone-fed-wolf-fang\";\nexport const externalKungfu: IDataExternalKungfu[] = [\n  blossomHarvest,\n  boneFedWolfFang\n];\n\nimport { boundlessProsperityManual } from \"./internals/boundless-prosperity-manual\";\nimport { fireSutra } from \"./internals/fire-sutra\";\nexport const internalKungfu: IDataInternalKungfu[] = [\n  boundlessProsperityManual,\n  fireSutra\n];\n\nexport function validateKungFuType(type: KUNGFU_TYPE): void {\n  switch (type) {\n    case KUNGFU_EXTERNAL:\n      return;\n    case KUNGFU_INTERNAL:\n      return;\n    default:\n      throw new Error('Invalid kung fu type : \"' + type + '\"');\n  }\n}\n\nexport function validateKungFuStyle(type: KUNGFU_TYPE, styleUid: string): void {\n  validateKungFuType(type);\n  if (type === KUNGFU_EXTERNAL) {\n    const filtered = externalKungfu.filter(\n      (kf: IDataExternalKungfu) => kf.uid === styleUid\n    );\n    if (filtered.length < 1) {\n      throw new Error('Invalid external kungfu \"' + styleUid + '\"');\n    }\n  } else {\n    const filtered = internalKungfu.filter(\n      (kf: IDataInternalKungfu) => kf.uid === styleUid\n    );\n    if (filtered.length < 1) {\n      throw new Error('Invalid internal kungfu \"' + styleUid + '\"');\n    }\n  }\n}\n\nexport function validateKungFuTechnique(\n  type: KUNGFU_TYPE,\n  styleUid: string,\n  techniqueUid: string\n): void {\n  validateKungFuStyle(type, styleUid);\n  if (type === KUNGFU_EXTERNAL) {\n    const filtered = externalKungfu.filter((kf: IDataExternalKungfu) => {\n      return (\n        kf.uid === styleUid &&\n        kf.techniques.filter(\n          (tech: IDataExternalKungfuTechnique) => tech.uid === techniqueUid\n        ).length > 0\n      );\n    });\n    if (filtered.length < 1) {\n      throw new Error(\n        'Invalid external kungfu technique \"' +\n          techniqueUid +\n          '\" for style \"' +\n          styleUid +\n          '\"'\n      );\n    }\n  } else {\n    const filtered = internalKungfu.filter((kf: IDataInternalKungfu) => {\n      return (\n        kf.uid === styleUid &&\n        kf.techniques.filter(\n          (tech: IDataInternalKungfuTechnique) => tech.uid === techniqueUid\n        ).length > 0\n      );\n    });\n    if (filtered.length < 1) {\n      throw new Error(\n        'Invalid internal kungfu technique \"' +\n          techniqueUid +\n          '\" for style \"' +\n          styleUid +\n          '\"'\n      );\n    }\n  }\n}\n\nexport function getKungFuType(styleUid: string): KUNGFU_TYPE {\n  const externalIdx = externalKungfu.findIndex(kf => kf.uid === styleUid);\n  const internalIdx = internalKungfu.findIndex(kf => kf.uid === styleUid);\n  if (externalIdx !== -1) {\n    return KUNGFU_EXTERNAL;\n  } else if (internalIdx !== -1) {\n    return KUNGFU_INTERNAL;\n  } else {\n    throw new Error(\"Unknwon kungfu \" + styleUid);\n  }\n}\n\nexport function kungfuData(type: KUNGFU_TYPE, styleUid: string) {\n  if (type === KUNGFU_EXTERNAL) {\n    const idxKF = externalKungfu.findIndex(kf => kf.uid === styleUid);\n    return externalKungfu[idxKF];\n  } else {\n    const idxKF = internalKungfu.findIndex(kf => kf.uid === styleUid);\n    return internalKungfu[idxKF];\n  }\n}\n\nexport function kungfuTechniqueData(\n  type: KUNGFU_TYPE,\n  styleUid: string,\n  techUid: string\n): IDataExternalKungfuTechnique | IDataInternalKungfuTechnique {\n  if (type === KUNGFU_EXTERNAL) {\n    const idxKF = externalKungfu.findIndex(kf => kf.uid === styleUid);\n    const idxTech = externalKungfu[idxKF].techniques.findIndex(\n      t => t.uid === techUid\n    );\n    return externalKungfu[idxKF].techniques[idxTech];\n  } else {\n    const idxKF = internalKungfu.findIndex(kf => kf.uid === styleUid);\n    const idxTech = internalKungfu[idxKF].techniques.findIndex(\n      t => t.uid === techUid\n    );\n    return internalKungfu[idxKF].techniques[idxTech];\n  }\n}\n","/* eslint-disable import/first */\nimport { IDiscount } from \"../perks/discounts\";\nimport { getDiscountIndexes, updateDiscounts } from \"./discounts\";\nimport { IStoreState } from \"./type\";\n\nexport interface ICost {\n  canPay: boolean;\n  destiny: number;\n  discounts?: Array<{\n    idx: number;\n    newValue: number;\n  }>;\n  original: number;\n}\n\nexport const zeroCost: ICost = {\n  canPay: true,\n  destiny: 0,\n  original: 0\n};\n\nfunction _costFactory(\n  state: IStoreState,\n  costValue: number,\n  discountIdx?: number[]\n): ICost {\n  if (discountIdx) {\n    let remainingCost = costValue;\n    const discounts = discountIdx.map((idx: number) => {\n      const stateDiscount: IDiscount = state.discounts[idx];\n      const effectiveDiscount = Math.min(remainingCost, stateDiscount.value);\n      const newValue = stateDiscount.value - effectiveDiscount;\n      remainingCost -= effectiveDiscount;\n      return { idx, newValue };\n    });\n    return {\n      canPay: state.destiny >= remainingCost,\n      destiny: remainingCost,\n      discounts,\n      original: costValue\n    };\n  } else {\n    return {\n      canPay: state.destiny >= costValue,\n      destiny: costValue,\n      original: costValue\n    };\n  }\n}\n\nexport function applyCost(state: IStoreState, cost: ICost): void {\n  if (!cost.canPay) {\n    throw new Error(\"Unpayable cost\");\n  }\n  state.destiny -= cost.destiny;\n  if (state.destiny < 0) {\n    throw new Error(\"Negative destiny reached\");\n  }\n  updateDiscounts(state, cost);\n}\n\nimport { TSkillName } from \"../data/skills\";\nimport { DISCOUNT_SKILL } from \"../perks/constants/discounts\";\nexport function getCostSkill(state: IStoreState, skillName: TSkillName): ICost {\n  const defaultCost = 2;\n\n  const skillDiscountIdx = getDiscountIndexes(state, (d: IDiscount) => {\n    if (d.type !== DISCOUNT_SKILL) {\n      return false;\n    }\n    if (d.skills.length === 0) {\n      return true;\n    }\n    return -1 !== d.skills.findIndex((s: TSkillName) => s === skillName);\n  });\n  return _costFactory(state, defaultCost, skillDiscountIdx);\n}\n\nexport function getCostSpeciality(state: IStoreState): ICost {\n  const defaultCost = 2;\n  return _costFactory(state, defaultCost, []);\n}\n\nimport { TChiName } from \"../data/chi\";\nimport { DISCOUNT_CHI } from \"../perks/constants/discounts\";\nexport function getCostChi(state: IStoreState, chiName: TChiName): ICost {\n  const chiValue = state.chi[chiName].value;\n  const chiMultiplicator =\n    chiName === \"general\"\n      ? 1\n      : chiName === \"corrupt\" || chiName === \"enlightened\"\n      ? 10\n      : 5;\n  const expectedCost =\n    chiValue < 1 ? chiMultiplicator : chiMultiplicator * chiValue;\n  const defaultCost = Math.max(\n    0,\n    expectedCost - state.chi[chiName].cultivation\n  );\n\n  const chiDiscountIdx = getDiscountIndexes(state, (d: IDiscount) => {\n    if (d.type !== DISCOUNT_CHI) {\n      return false;\n    }\n    if (d.chis.length === 0) {\n      return true;\n    }\n    return -1 !== d.chis.findIndex((s: TChiName) => s === chiName);\n  });\n  return _costFactory(state, defaultCost, chiDiscountIdx);\n}\n\nimport { getLoresheetData } from \"../data/loresheets\";\nimport { DISCOUNT_LORESHEET } from \"../perks/constants/discounts\";\nexport function getCostOpenLoresheet(state: IStoreState, uid: string): ICost {\n  const lsData = getLoresheetData(uid);\n  const defaultCost = lsData.cost;\n\n  const lsDiscountIdx = getDiscountIndexes(state, (d: IDiscount) => {\n    if (d.type !== DISCOUNT_LORESHEET) {\n      return false;\n    }\n    if (d.uids.length === 0) {\n      return true;\n    }\n    return -1 !== d.uids.findIndex((s: string) => s === uid);\n  });\n  return _costFactory(state, defaultCost, lsDiscountIdx);\n}\n\nimport { getLoresheetOptionData } from \"../data/loresheets\";\nimport { DISCOUNT_LORESHEET_OPTION } from \"../perks/constants/discounts\";\n\nfunction _getCostBuyLoresheetOptionOneCost(\n  state: IStoreState,\n  lsUid: string,\n  uid: string,\n  cost: number\n): ICost {\n  const lsDiscountIdx = getDiscountIndexes(state, (d: IDiscount) => {\n    if (d.type !== DISCOUNT_LORESHEET_OPTION) {\n      return false;\n    }\n    if (d.uids.length === 0) {\n      return true;\n    }\n\n    return (\n      -1 !==\n      d.uids.findIndex(\n        opt =>\n          opt.lsUid === lsUid &&\n          -1 !== opt.optUid.findIndex(discountOptUid => uid === discountOptUid)\n      )\n    );\n  });\n  return _costFactory(state, cost, lsDiscountIdx);\n}\n\nexport function getCostBuyLoresheetOption(\n  state: IStoreState,\n  lsUid: string,\n  uid: string\n): ICost[] {\n  const lsData = getLoresheetOptionData(lsUid, uid);\n  const defaultCost = lsData.cost;\n  if (typeof defaultCost === \"number\") {\n    return [_getCostBuyLoresheetOptionOneCost(state, lsUid, uid, defaultCost)];\n  } else {\n    const lenght = defaultCost.max - defaultCost.min + 1;\n    return Array.from(new Array(lenght).keys())\n      .map((v: number) => defaultCost.min + v)\n      .map(cost => _getCostBuyLoresheetOptionOneCost(state, lsUid, uid, cost));\n  }\n}\n\nexport function getCostVirtue(state: IStoreState): ICost {\n  return _costFactory(state, 5);\n}\n\nexport function getCostKungFuStyle(state: IStoreState): ICost {\n  return _costFactory(state, 10);\n}\n\nimport { kungfuTechniqueData } from \"../data/kungfu\";\nimport {\n  IDataExternalKungfuTechnique,\n  IDataInternalKungfuTechnique,\n  KUNGFU_EXTERNAL,\n  KUNGFU_TYPE\n} from \"../data/kungfu/types\";\nexport function getCostKungFuTechnique(\n  state: IStoreState,\n  type: KUNGFU_TYPE,\n  styleUid: string,\n  uid: string\n): ICost {\n  /*\n   DISCOUNT !\n  */\n  const kfData = kungfuTechniqueData(type, styleUid, uid);\n  const defaultCost =\n    type === KUNGFU_EXTERNAL\n      ? (kfData as IDataExternalKungfuTechnique).cost\n      : (kfData as IDataInternalKungfuTechnique).level;\n\n  return _costFactory(state, defaultCost);\n}\n","export const KUNGFU_OPEN_STYLE = 'KUNGFU_OPEN_STYLE';\nexport type KUNGFU_OPEN_STYLE = typeof KUNGFU_OPEN_STYLE;\n\nexport const KUNGFU_CUSTOM_NAME_FOR_STYLE = 'KUNGFU_CUSTOM_NAME_FOR_STYLE';\nexport type KUNGFU_CUSTOM_NAME_FOR_STYLE = typeof KUNGFU_CUSTOM_NAME_FOR_STYLE;\n\nexport const KUNGFU_CUSTOM_NAME_FOR_TECHNIQUE = 'KUNGFU_CUSTOM_NAME_FOR_TECHNIQUE';\nexport type KUNGFU_CUSTOM_NAME_FOR_TECHNIQUE = typeof KUNGFU_CUSTOM_NAME_FOR_TECHNIQUE;\n\nexport const KUNGFU_BUY_TECHNIQUE = 'KUNGFU_BUY_TECHNIQUE';\nexport type KUNGFU_BUY_TECHNIQUE = typeof KUNGFU_BUY_TECHNIQUE;\n","import {\n  kungfuData,\n  kungfuTechniqueData,\n  validateKungFuStyle,\n  validateKungFuTechnique\n} from \"../data/kungfu\";\nimport {\n  IDataExternalKungfu,\n  IDataExternalKungfuStatistics,\n  IDataInternalKungfuTechnique,\n  KUNGFU_EXTERNAL,\n  KUNGFU_INTERNAL,\n  KUNGFU_TYPE\n} from \"../data/kungfu/types\";\nimport * as effects from \"../perks/constants/effects\";\n\nexport interface IKungFuState {\n  KUNGFU_EXTERNAL: { [uid: string]: string[] };\n  KUNGFU_INTERNAL: { [uid: string]: string[] };\n  noRestrictionInternal: string[];\n}\n\nexport function createState(): IKungFuState {\n  return {\n    KUNGFU_EXTERNAL: {},\n    KUNGFU_INTERNAL: {},\n    noRestrictionInternal: []\n  };\n}\n\nexport function openStyle(\n  state: IKungFuState,\n  type: KUNGFU_TYPE,\n  styleUid: string\n): void {\n  validateKungFuStyle(type, styleUid);\n  if (isStylePresent(state, type, styleUid)) {\n    throw new Error(\"Internal error : style already open\");\n  }\n  state[type][styleUid] = [];\n}\n\nexport function isStylePresent(\n  state: IKungFuState,\n  type: KUNGFU_TYPE,\n  styleUid: string\n): boolean {\n  const styleIndex = Object.keys(state[type]).findIndex(\n    stateKungFuUid => stateKungFuUid === styleUid\n  );\n  return styleIndex !== -1;\n}\n\nexport function addKungFuTechnique(\n  state: IKungFuState,\n  type: KUNGFU_TYPE,\n  styleUid: string,\n  techniqueUid: string\n): void {\n  validateKungFuStyle(type, styleUid);\n  validateKungFuTechnique(type, styleUid, techniqueUid);\n\n  if (!isStylePresent(state, type, styleUid)) {\n    throw new Error(\"Internal error : style not open\");\n  }\n  if (isStyleTechniquePresent(state, type, styleUid, techniqueUid)) {\n    throw new Error(\"Internal error : technique already presents\");\n  }\n\n  state[type][styleUid].push(techniqueUid);\n}\n\nexport function isStyleTechniquePresent(\n  state: IKungFuState,\n  type: KUNGFU_TYPE,\n  styleUid: string,\n  techniqueUid: string\n): boolean {\n  if (!isStylePresent(state, type, styleUid)) {\n    return false;\n  }\n  const optionIndex = state[type][styleUid].findIndex(\n    stateTechniqueUid => stateTechniqueUid === techniqueUid\n  );\n  return optionIndex !== -1;\n}\n\nexport function getExternalKungFuStatistics(\n  state: IKungFuState,\n  styleUid: string\n): IDataExternalKungfuStatistics {\n  const dataStatistics = (kungfuData(\n    KUNGFU_EXTERNAL,\n    styleUid\n  ) as IDataExternalKungfu).statistics;\n\n  if (!isStylePresent(state, KUNGFU_EXTERNAL, styleUid)) {\n    return dataStatistics;\n  }\n\n  const statistics: IDataExternalKungfuStatistics = { ...dataStatistics };\n\n  state[KUNGFU_EXTERNAL][styleUid].forEach(techniqueUid => {\n    const kfTechnique = kungfuTechniqueData(\n      KUNGFU_EXTERNAL,\n      styleUid,\n      techniqueUid\n    );\n    switch (kfTechnique.effect.type) {\n      case effects.EFFECT_COMBAT_STATISTIC:\n        statistics[kfTechnique.effect.statistic] += kfTechnique.effect.increase;\n        break;\n      default:\n        break;\n    }\n  });\n  return statistics;\n}\n\nexport function canOpenKungFu(\n  state: IKungFuState,\n  type: KUNGFU_TYPE,\n  styleUid: string\n): boolean {\n  return !isStylePresent(state, type, styleUid);\n}\n\nfunction _knownInternalKungFuLevel(\n  state: IKungFuState,\n  styleUid: string\n): number[] {\n  return state[KUNGFU_INTERNAL][styleUid]\n    .map(techniqueUid => {\n      const techData = kungfuTechniqueData(\n        KUNGFU_INTERNAL,\n        styleUid,\n        techniqueUid\n      ) as IDataInternalKungfuTechnique;\n      return techData.level;\n    })\n    .sort();\n}\n\nexport function canBuyKungFuTechnique(\n  state: IKungFuState,\n  type: KUNGFU_TYPE,\n  styleUid: string,\n  techniqueUid: string\n): boolean {\n  if (!isStylePresent(state, type, styleUid)) {\n    return false;\n  }\n  if (isStyleTechniquePresent(state, type, styleUid, techniqueUid)) {\n    return false;\n  }\n\n  if (type === KUNGFU_EXTERNAL) {\n    return true;\n  } else {\n    if (state.noRestrictionInternal) {\n      if (\n        -1 !== state.noRestrictionInternal.findIndex(uid => uid === styleUid)\n      ) {\n        return true;\n      }\n    }\n    const levels = _knownInternalKungFuLevel(state, styleUid);\n    const kfTechnique = kungfuTechniqueData(\n      KUNGFU_INTERNAL,\n      styleUid,\n      techniqueUid\n    ) as IDataInternalKungfuTechnique;\n\n    if (levels.length === 0 && kfTechnique.level === 1) {\n      return true;\n    }\n    return Math.max(...levels) === kfTechnique.level - 1;\n  }\n}\n","import { produce } from \"immer\";\n\nimport { IKungFuAction } from \"../actions/kungfu\";\nimport { IStoreState } from \"../type\";\n\nimport { applyCost } from \"../costs\";\n\nimport * as dataKungfu from \"../../data/kungfu\";\nimport {\n  IDataInternalKungfu,\n  KUNGFU_EXTERNAL,\n  KUNGFU_INTERNAL\n} from \"../../data/kungfu/types\";\nimport * as constants from \"../constants/kungfu\";\nimport { addKungFuTechnique, openStyle } from \"../kungfu\";\n\nimport * as chi from \"../chi\";\n\nexport function kungfuReducer(\n  baseState: IStoreState,\n  action: IKungFuAction\n): IStoreState {\n  switch (action.type) {\n    case constants.KUNGFU_OPEN_STYLE:\n      return produce(baseState, draftState => {\n        applyCost(draftState, action.cost);\n        openStyle(draftState.kungfu, action.kungfuType, action.uid);\n\n        if (action.kungfuType === KUNGFU_EXTERNAL) {\n          chi.increaseCultivation(\n            draftState.chi,\n            \"general\",\n            action.cost.destiny\n          );\n        } else {\n          const data = dataKungfu.kungfuData(\n            KUNGFU_INTERNAL,\n            action.uid\n          ) as IDataInternalKungfu;\n          chi.increaseCultivation(\n            draftState.chi,\n            data.element,\n            action.cost.destiny\n          );\n        }\n\n        draftState.history.push(action);\n      });\n    case constants.KUNGFU_BUY_TECHNIQUE:\n      return produce(baseState, draftState => {\n        applyCost(draftState, action.cost);\n        addKungFuTechnique(\n          draftState.kungfu,\n          action.kungfuType,\n          action.styleUid,\n          action.uid\n        );\n\n        if (action.kungfuType === KUNGFU_EXTERNAL) {\n          chi.increaseCultivation(\n            draftState.chi,\n            \"general\",\n            action.cost.destiny\n          );\n        } else {\n          const data = dataKungfu.kungfuData(\n            KUNGFU_INTERNAL,\n            action.styleUid\n          ) as IDataInternalKungfu;\n          chi.increaseCultivation(\n            draftState.chi,\n            data.element,\n            action.cost.destiny\n          );\n        }\n\n        draftState.history.push(action);\n      });\n    case constants.KUNGFU_CUSTOM_NAME_FOR_STYLE:\n    case constants.KUNGFU_CUSTOM_NAME_FOR_TECHNIQUE:\n    default:\n  }\n  return baseState;\n}\n","export const HISTORY_DELETE = 'HISTORY_DELETE';\nexport type HISTORY_DELETE = typeof HISTORY_DELETE;\n","export const SKILLS_BUY = 'SKILLS_BUY';\nexport type SKILLS_BUY = typeof SKILLS_BUY;\n\nexport const SKILLS_SPECIALITY_BUY = 'SKILLS_SPECIALITY_BUY';\nexport type SKILLS_SPECIALITY_BUY = typeof SKILLS_SPECIALITY_BUY;\n","export const LORESHEET_OPEN = 'LORESHEET_OPEN';\nexport type LORESHEET_OPEN = typeof LORESHEET_OPEN;\n\nexport const LORESHEET_BUY_OPTION = 'LORESHEET_BUY_OPTION';\nexport type LORESHEET_BUY_OPTION = typeof LORESHEET_BUY_OPTION;\n","import {\n  getLoresheetOptionData,\n  IDataLoresheetOptionPrerequisite,\n  validateLoresheet,\n  validateLoresheetOption\n} from \"../data/loresheets\";\nimport { IStoreState } from \"./type\";\n\nexport interface ILoresheetOptionState {\n  uid: string;\n  payload: any;\n}\n\nexport interface ILoresheetsState {\n  [lsUid: string]: ILoresheetOptionState[];\n}\n\nexport function createState(): ILoresheetsState {\n  return {};\n}\n\nexport function isLoresheetPresent(\n  state: ILoresheetsState,\n  loresheetUid: string\n): boolean {\n  const loresheetIndex = Object.keys(state).findIndex(\n    stateLoresheetUid => stateLoresheetUid === loresheetUid\n  );\n  return loresheetIndex !== -1;\n}\n\nexport function isLoresheetOptionPresent(\n  state: ILoresheetsState,\n  loresheetUid: string,\n  optionUid: string\n): boolean {\n  if (state[loresheetUid] === undefined) {\n    return false;\n  }\n  const optionIndex = state[loresheetUid].findIndex(\n    option => option.uid === optionUid\n  );\n  return optionIndex !== -1;\n}\n\nexport function canOpenLoresheet(state: IStoreState, uid: string): boolean {\n  return !isLoresheetPresent(state.loresheets, uid);\n}\n\nfunction _or(a: boolean, b: boolean) {\n  return a || b;\n}\nfunction _and(a: boolean, b: boolean) {\n  return a && b;\n}\n\nfunction _prerequisiteToBool(\n  state: ILoresheetsState,\n  lsUid: string,\n  prerequisite: IDataLoresheetOptionPrerequisite\n): boolean {\n  if (typeof prerequisite === \"string\") {\n    return isLoresheetOptionPresent(state, lsUid, prerequisite);\n  } else {\n    return prerequisite.prerequisites\n      .map((optUid: string) => {\n        const here = isLoresheetOptionPresent(state, lsUid, optUid);\n        return here;\n      })\n      .reduce(\n        prerequisite.type === \"OR\" ? _or : _and,\n        prerequisite.type === \"OR\" ? false : true\n      );\n  }\n}\n\nexport function canBuyLoresheetOption(\n  state: ILoresheetsState,\n  lsUid: string,\n  uid: string\n): boolean {\n  if (!isLoresheetPresent(state, lsUid)) {\n    return false;\n  } // Not opened\n  const lsOptData = getLoresheetOptionData(lsUid, uid);\n  if (isLoresheetOptionPresent(state, lsUid, uid) && lsOptData.repeatable) {\n    return lsOptData.repeatable;\n  } // Already bought\n  const cb = lsOptData.prerequisites\n    .map(p => _prerequisiteToBool(state, lsUid, p))\n    .reduce(_and, true);\n  return cb;\n}\n\nexport function buyLoresheetOption(\n  state: ILoresheetsState,\n  loresheetUid: string,\n  optionUid: string,\n  payload?: string\n): void {\n  validateLoresheet(loresheetUid);\n  validateLoresheetOption(loresheetUid, optionUid);\n\n  if (!canBuyLoresheetOption(state, loresheetUid, optionUid)) {\n    throw new Error(\n      \"Internal error : impossible to buy loresheet option \" +\n        loresheetUid +\n        \",\" +\n        optionUid\n    );\n  }\n  state[loresheetUid].push({ uid: optionUid, payload });\n}\n\nexport function openLoresheet(\n  state: ILoresheetsState,\n  loresheetUid: string\n): void {\n  validateLoresheet(loresheetUid);\n  state[loresheetUid] = [];\n}\n","import produce from \"immer\";\n\nimport { ILoresheetAction } from \"../actions/loresheets\";\nimport { IStoreState } from \"../type\";\n\nimport { applyCost } from \"../costs\";\nimport { buyLoresheetOption, openLoresheet } from \"../loresheets\";\n\nimport * as constants from \"../constants/loresheets\";\n\nexport function loresheetsReducer(\n  baseState: IStoreState,\n  action: ILoresheetAction\n): IStoreState {\n  switch (action.type) {\n    case constants.LORESHEET_OPEN:\n      return produce(baseState, draftState => {\n        applyCost(draftState, action.cost);\n        openLoresheet(draftState.loresheets, action.uid);\n        draftState.history.push(action);\n      });\n    case constants.LORESHEET_BUY_OPTION:\n      return produce(baseState, draftState => {\n        applyCost(draftState, action.cost);\n        buyLoresheetOption(\n          draftState.loresheets,\n          action.lsUid,\n          action.uid,\n          action.payload\n        );\n        draftState.history.push(action);\n      });\n    default:\n  }\n  return baseState;\n}\n","export const VIRTUE_INCREASE = 'VIRTUE_INCREASE';\nexport type VIRTUE_INCREASE = typeof VIRTUE_INCREASE;\n\nexport const VIRTUE_OPEN = 'VIRTUE_OPEN';\nexport type VIRTUE_OPEN = typeof VIRTUE_OPEN;\n","export const VIRTUE_CHIVALROUS = 'VIRTUE_CHIVALROUS';\nexport type VIRTUE_CHIVALROUS = typeof VIRTUE_CHIVALROUS;\n\nexport const VIRTUE_SELFISH = 'VIRTUE_SELFISH';\nexport type VIRTUE_SELFISH = typeof VIRTUE_SELFISH;\n\nexport type IDataVirtueType = VIRTUE_SELFISH | VIRTUE_CHIVALROUS;\n\nexport interface IDataVirtue {\n  name: string;\n  type: IDataVirtueType;\n}\n\nexport const virtues: IDataVirtue[] = [\n  {name: 'Honor', type: VIRTUE_CHIVALROUS},\n  {name: 'Benevolence', type: VIRTUE_CHIVALROUS},\n  {name: 'Righteousness', type: VIRTUE_CHIVALROUS},\n  {name: 'Loyalty', type: VIRTUE_CHIVALROUS},\n  {name: 'Force', type: VIRTUE_CHIVALROUS},\n  {name: 'Revenge', type: VIRTUE_SELFISH},\n  {name: 'Individualism', type: VIRTUE_SELFISH},\n  {name: 'Obsession', type: VIRTUE_SELFISH},\n  {name: 'Ruthlessness', type: VIRTUE_SELFISH},\n  {name: 'Ferocity', type: VIRTUE_SELFISH}\n];\n","import { IDataVirtue, IDataVirtueType, virtues } from \"../data/virtues\";\nimport { IStoreState } from \"./type\";\n\nexport interface IVirtueState {\n  name: string;\n  value: number;\n  type: IDataVirtueType;\n}\n\nexport type TVirtuesState = IVirtueState[];\n\nexport function createState(): TVirtuesState {\n  return virtues.map((virtue: IDataVirtue) => {\n    return { name: virtue.name, value: 0, type: virtue.type };\n  });\n}\n\nexport function add(\n  state: TVirtuesState,\n  name: string,\n  type: IDataVirtueType,\n  value: number\n): void {\n  if (isVirtuePresent(state, name)) {\n    throw new Error(\"Internal Error : virtue already present \" + name);\n  }\n  state.push({ name, value, type });\n}\n\nexport function increase(\n  state: TVirtuesState,\n  name: string,\n  value: number\n): void {\n  if (!isVirtuePresent(state, name)) {\n    throw new Error(\"Internal Error : unknwon new virtue \" + name);\n  }\n  state.forEach(virtue => {\n    if (virtue.name === name) {\n      virtue.value += value;\n    }\n  });\n}\n\nexport function isVirtuePresent(state: TVirtuesState, name: string): boolean {\n  return state.findIndex(virtue => name === virtue.name) !== -1;\n}\n\nexport function canBuyVirtue(state: IStoreState, name: string): boolean {\n  const findIndex = state.virtues.findIndex(v => name === v.name);\n  if (findIndex === -1) {\n    return false;\n  }\n  const virtue = state.virtues[findIndex];\n  if (virtue.value + 1 > 5) {\n    return false;\n  } else {\n    return true;\n  }\n}\n","import produce from \"immer\";\n\nimport { IVirtueAction } from \"../actions/virtues\";\nimport * as constants from \"../constants/virtues\";\nimport { IStoreState } from \"../type\";\n\nimport { applyCost } from \"../costs\";\nimport { increase } from \"../virtues\";\n\nexport function virtuesReducer(\n  baseState: IStoreState,\n  action: IVirtueAction\n): IStoreState {\n  switch (action.type) {\n    case constants.VIRTUE_INCREASE:\n      return produce(baseState, state => {\n        applyCost(state, action.cost);\n        increase(state.virtues, action.name, action.value);\n        state.history.push(action);\n      });\n    default:\n  }\n  return baseState;\n}\n","import { IAction } from \"../../state/actions/types\";\nimport { IStoreState } from \"../../state/type\";\n\n// Sub Reducers\nimport * as header from \"../../state/constants/header\";\nimport { headerReducer } from \"../../state/reducers/header\";\n\nimport * as chi from \"../../state/constants/chi\";\nimport { chiReducer } from \"../../state/reducers/chi\";\n\nimport * as initial from \"../../state/constants/initial\";\nimport { initialStateFactory } from \"../../state/initial\";\n\nimport * as kungfu from \"../../state/constants/kungfu\";\nimport { kungfuReducer } from \"../../state/reducers/kungfu\";\n\nimport * as history from \"../../state/constants/history\";\nimport { historyReducer } from \"../../state/reducers/history\";\n\nimport * as skills from \"../../state/constants/skills\";\nimport { skillsReducer } from \"../../state/reducers/skills\";\n\nimport * as loresheets from \"../../state/constants/loresheets\";\nimport { loresheetsReducer } from \"../../state/reducers/loresheets\";\n\nimport * as virtues from \"../../state/constants/virtues\";\nimport { virtuesReducer } from \"../../state/reducers/virtues\";\n\nexport function globalReducer(\n  state: IStoreState | undefined,\n  action: IAction\n): IStoreState {\n  if (!state) {\n    return globalReducer(initialStateFactory(), action);\n  }\n  switch (action.type) {\n    case header.HEADER_SET_ARCHETYPE:\n    case header.HEADER_SET_CONCEPT:\n    case header.HEADER_SET_NAME:\n    case header.HEADER_SET_RANK:\n      return headerReducer(state, action);\n    case chi.CHI_BUY:\n      return chiReducer(state, action);\n    case initial.INITIAL_STATE:\n      return initialStateFactory();\n    case kungfu.KUNGFU_OPEN_STYLE:\n    case kungfu.KUNGFU_CUSTOM_NAME_FOR_STYLE:\n    case kungfu.KUNGFU_CUSTOM_NAME_FOR_TECHNIQUE:\n    case kungfu.KUNGFU_BUY_TECHNIQUE:\n      return kungfuReducer(state, action);\n    case skills.SKILLS_BUY:\n    case skills.SKILLS_SPECIALITY_BUY:\n      return skillsReducer(state, action);\n    case loresheets.LORESHEET_OPEN:\n    case loresheets.LORESHEET_BUY_OPTION:\n      return loresheetsReducer(state, action);\n    case history.HISTORY_DELETE:\n      return historyReducer(state, action);\n    case virtues.VIRTUE_INCREASE:\n      return virtuesReducer(state, action);\n    default:\n      return state;\n  }\n}\n","import { produce } from \"immer\";\n\nimport { IHeaderAction } from \"../actions/header\";\nimport * as constants from \"../constants/header\";\nimport { setRank } from \"../header\";\nimport { IStoreState } from \"../type\";\n\nexport function headerReducer(\n  baseState: IStoreState,\n  action: IHeaderAction\n): IStoreState {\n  switch (action.type) {\n    case constants.HEADER_SET_NAME:\n      return produce(baseState, draftState => {\n        draftState.name = action.name;\n        draftState.history.push(action);\n      });\n    case constants.HEADER_SET_CONCEPT:\n      return produce(baseState, draftState => {\n        draftState.concept = action.concept;\n        draftState.history.push(action);\n      });\n    case constants.HEADER_SET_RANK:\n      return produce(baseState, draftState => {\n        setRank(draftState, action.rank);\n        draftState.history.push(action);\n      });\n    case constants.HEADER_SET_ARCHETYPE:\n      return produce(baseState, draftState => {\n        draftState.archetype = action.archetype;\n        draftState.history.push(action);\n      });\n    default:\n  }\n  return baseState;\n}\n","import { produce } from \"immer\";\n\nimport { IChiAction } from \"../actions/chi\";\nimport { applyCost } from \"../costs\";\nimport { IStoreState } from \"../type\";\n\nimport * as constants from \"../constants/chi\";\n\nimport { increase } from \"../chi\";\n\nexport function chiReducer(\n  baseState: IStoreState,\n  action: IChiAction\n): IStoreState {\n  switch (action.type) {\n    case constants.CHI_BUY:\n      return produce(baseState, draftState => {\n        applyCost(draftState, action.cost);\n        increase(draftState.chi, action.chi, action.value);\n        draftState.history.push(action);\n      });\n    default:\n  }\n  return baseState;\n}\n","import produce from \"immer\";\n\nimport { ISkillAction } from \"../actions/skills\";\nimport * as constants from \"../constants/skills\";\nimport { maxSkillBonus } from \"../derived\";\n\nimport { applyCost } from \"../costs\";\nimport { addSpeciality, increase } from \"../skills\";\nimport { IStoreState } from \"../type\";\n\nexport function skillsReducer(\n  baseState: IStoreState,\n  action: ISkillAction\n): IStoreState {\n  switch (action.type) {\n    case constants.SKILLS_BUY:\n      return produce(baseState, draftState => {\n        applyCost(draftState, action.cost);\n        const max = maxSkillBonus(draftState);\n        increase(draftState.skills, action.name, max);\n        draftState.history.push(action);\n      });\n    case constants.SKILLS_SPECIALITY_BUY:\n      return produce(baseState, draftState => {\n        applyCost(draftState, action.cost);\n        addSpeciality(draftState.skills, action.skill, action.speciality);\n        draftState.history.push(action);\n      });\n    default:\n  }\n  return baseState;\n}\n","import { IStoreState } from \"../type\";\n\nimport { IHistoryAction } from \"../actions/history\";\nimport * as constants from \"../constants/history\";\nimport { replayHistory } from \"../history\";\n\nexport function historyReducer(\n  baseState: IStoreState,\n  action: IHistoryAction\n): IStoreState {\n  switch (action.type) {\n    case constants.HISTORY_DELETE:\n      return replayHistory(\n        baseState,\n        baseState.history.slice(0, action.id + 1)\n      ); // +1 needed to skip initialState\n    default:\n      return baseState;\n  }\n}\n","import { resetToInitialState } from \"./actions/initial\";\nimport { IAction } from \"./actions/types\";\nimport { globalReducer } from \"./reducers/global\";\nimport { IStoreState } from \"./type\";\n\nexport type THistoryState = IAction[];\n\nexport function replayHistory(\n  state: IStoreState,\n  actions: IAction[]\n): IStoreState {\n  for (const action of actions) {\n    state = globalReducer(state, action);\n  }\n  return state;\n}\n\nexport function createState(): THistoryState {\n  return [resetToInitialState()];\n}\n","export interface IDataArchetype {\n  name: string;\n  description: string;\n  key: string;\n  breath: string;\n}\n\nexport type IDataArchetypes = IDataArchetype[];\n\n/* tslint:disable:max-line-length */\nexport const archetypes: IDataArchetypes = [\n  {\n    breath: 'Hardiness',\n    description: 'Warriors are by far the most common of the five archetypes. Although all people within the martial arts society are good at fighting, it is the warriors who truly embrace it as their way of life. They are the swordsmen and pugilists, constables and assassins, as well as the most iconic heroes and villains.',\n    key: 'warrior',\n    name: 'Warrior',\n  }, {\n    breath: 'WuWei',\n    description: 'Despite the name, they are not simple religious administrators; they are the Daoists, wise men and women whose approach to fighting starts with Chi cultivation first and foremost. In a world where inner power is of utmost importance, priests are widely respected.',\n    key: 'priest',\n    name: 'Priest',\n  }, {\n    breath: 'Confidence',\n    description: 'Courtiers wield power not just over themselves but also over others. They are the rulers, merchants, envoys and entertainers that shape society and its people. In a subtle way they are the most powerful of all people; a general may win a war but its his king who decides whether there is war at all.',\n    key: 'courtier',\n    name: 'Courtier',\n  }, {\n    breath: 'Learning',\n    description: 'Scholars are the educated masters, the lore keepers, inventors and advisors. With their knowledge about the workings of the world they perceive events like few others do. Scholars are often found debating how best to rule an empire, hunting for long-lost manuals written in Sanskrit or studying things from exotic foreign lands.',\n    key: 'scholar',\n    name: 'Scholar',\n  }, {\n    breath: 'Medicine',\n    description: 'Doctors are the least prominent of all five archetypes. Although the medical profession is by no means unheard of, relatively few of them involve themselves in the martial arts realm. Those that do have the potential to become greatly respected allies and feared enemies, literally masters over life and death.',\n    key: 'doctor',\n    name: 'Doctor',\n  }\n];\n\nexport function validateArchetype(archetype: string): void {\n  const foundArchetype = archetypes.find((dataArchetype: IDataArchetype) => (dataArchetype.key === archetype) );\n  if (! foundArchetype ) { throw new Error('Invalid archetype \"' + archetype + '\"'); }\n}\n","import * as constants from \"../constants/header\";\n\nimport * as dataArchetypes from \"../../data/archetypes\";\nimport * as dataRanks from \"../../data/ranks\";\n\nexport interface IHeaderSetName {\n  type: constants.HEADER_SET_NAME;\n  name: string;\n}\n\nexport interface IHeaderSetConcept {\n  type: constants.HEADER_SET_CONCEPT;\n  concept: string;\n}\n\nexport interface IHeaderSetArchetype {\n  type: constants.HEADER_SET_ARCHETYPE;\n  archetype: string;\n}\n\nexport interface IHeaderSetRank {\n  type: constants.HEADER_SET_RANK;\n  rank: string;\n}\n\nexport type IHeaderAction =\n  | IHeaderSetName\n  | IHeaderSetConcept\n  | IHeaderSetArchetype\n  | IHeaderSetRank;\n\nexport function setName(name: string): IHeaderSetName {\n  return { type: constants.HEADER_SET_NAME, name };\n}\n\nexport function setConcept(concept: string): IHeaderSetConcept {\n  return { type: constants.HEADER_SET_CONCEPT, concept };\n}\n\nexport function setArchetype(archetype: string): IHeaderSetArchetype {\n  dataArchetypes.validateArchetype(archetype);\n  return { archetype, type: constants.HEADER_SET_ARCHETYPE };\n}\n\nexport function setRank(rank: string): IHeaderSetRank {\n  dataRanks.validateRank(rank);\n  return { rank, type: constants.HEADER_SET_RANK };\n}\n","import { TSkillName } from \"../../data/skills\";\nimport * as constants from \"../constants/skills\";\nimport { ICost } from \"../costs\";\n\nexport interface ISkillBuy {\n  type: constants.SKILLS_BUY;\n  name: TSkillName;\n  cost: ICost;\n}\n\nexport interface ISkillSpecialityBuy {\n  type: constants.SKILLS_SPECIALITY_BUY;\n  skill: TSkillName;\n  speciality: string;\n  cost: ICost;\n}\n\nexport type ISkillAction = ISkillBuy | ISkillSpecialityBuy;\n\nexport function skillsBuy(name: TSkillName, cost: ICost): ISkillBuy {\n  return { cost, name, type: constants.SKILLS_BUY };\n}\n\nexport function skillSpecialityBuy(\n  skill: TSkillName,\n  speciality: string,\n  cost: ICost\n): ISkillSpecialityBuy {\n  if (speciality.length === 0) {\n    throw new Error(\"Empty speciality\");\n  }\n  return { cost, skill, speciality, type: constants.SKILLS_SPECIALITY_BUY };\n}\n","/* eslint-disable import/first */\nimport { IStoreState } from \"./type\";\n\nimport { createState as createHistoryState } from \"./history\";\n\nimport { createState as createChiState } from \"./chi\";\nimport { createState as createaKungFuState } from \"./kungfu\";\nimport { createState as createLoresheetsState } from \"./loresheets\";\nimport { createState as createSkillsState } from \"./skills\";\nimport { createState as createVirtuesState } from \"./virtues\";\n\nimport { createState as createBonusesState } from \"./bonuses\";\nimport { createState as createDiscountsState } from \"./discounts\";\n\nexport function emptyStateFactory(): IStoreState {\n  return {\n    archetype: undefined,\n    concept: undefined,\n    name: undefined,\n    rank: undefined,\n\n    destiny: 0,\n    entanglement: 0,\n\n    history: createHistoryState(),\n\n    chi: createChiState(),\n    kungfu: createaKungFuState(),\n    loresheets: createLoresheetsState(),\n    skills: createSkillsState(),\n    virtues: createVirtuesState(),\n\n    bonuses: createBonusesState(),\n    discounts: createDiscountsState()\n  };\n}\n\nimport { setArchetype, setRank } from \"./actions/header\";\nimport { skillSpecialityBuy } from \"./actions/skills\";\nimport { zeroCost } from \"./costs\";\nimport { replayHistory } from \"./history\";\n\nexport function testingStateFactory(): IStoreState {\n  const initial = emptyStateFactory();\n  const actions = [\n    setRank(\"4th_rank\"),\n    setArchetype(\"warrior\"),\n    skillSpecialityBuy(\"Awareness\", \"Hear\", zeroCost),\n    skillSpecialityBuy(\"Awareness\", \"Sight\", zeroCost)\n  ];\n  initial.destiny += 25;\n  return replayHistory(initial, actions);\n}\n\nexport function initialStateFactory(): IStoreState {\n  return emptyStateFactory();\n}\n","import * as constants from \"../constants/initial\";\n\nexport interface IInitialState {\n  type: constants.INITIAL_STATE;\n}\n\nexport type IInitialStateAction = IInitialState;\n\nexport function resetToInitialState(): IInitialState {\n  return { type: constants.INITIAL_STATE };\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\n/* tslint:disable:no-console */\n/* tslint:disable:interface-name */\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ninterface Config {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit http://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See http://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import * as React from \"react\";\nimport Icon from \"react-fa\";\nimport { Link } from \"react-router-dom\";\n\nimport \"./header.css\";\n\nclass AppHeader extends React.PureComponent<{}, { isOpen: boolean }> {\n  constructor(props: any) {\n    super(props);\n\n    this.toggle = this.toggle.bind(this);\n    this.state = {\n      isOpen: false\n    };\n  }\n  public toggle() {\n    this.setState({\n      isOpen: !this.state.isOpen\n    });\n  }\n\n  public render() {\n    return (\n      <nav className=\"navbar\">\n        <ul className=\"left\">\n          <Link to=\"/\">\n            <li>\n              <h1>LotWCS</h1>\n            </li>\n          </Link>\n          <Link to=\"/skills\">\n            <li>Skills</li>\n          </Link>\n          <Link to=\"/chi\">\n            <li>Chi</li>\n          </Link>\n          <Link to=\"/virtues\">\n            <li>Virtues</li>\n          </Link>\n          <Link to=\"/equipment\">\n            <li>Equipment</li>\n          </Link>\n          <Link to=\"/conditions\">\n            <li>Conditions</li>\n          </Link>\n          <Link to=\"/kungfu\">\n            <li>{\"Kung\\u00A0Fu\"}</li>\n          </Link>\n          <Link to=\"/loresheets\">\n            <li>Loresheets</li>\n          </Link>\n          <Link to=\"/history\">\n            <li>History</li>\n          </Link>\n        </ul>\n        <ul className=\"right\">\n          <Link to=\"/print\">\n            <li>Full sheet</li>\n          </Link>\n          <Link to=\"/config\">\n            <li>\n              <Icon name=\"cog\" />\n            </li>\n          </Link>\n        </ul>\n      </nav>\n    );\n  }\n}\n\nexport default AppHeader;\n","import * as React from \"react\";\n\nimport \"./intro.css\";\n\nclass AppIntro extends React.PureComponent<{}, {}> {\n  public render() {\n    return <section className=\"app-intro\">{this.props.children}</section>;\n  }\n}\n\nexport default AppIntro;\n","import * as React from \"react\";\n\nimport \"./page.css\";\n\nclass AppPage extends React.PureComponent<{}, {}> {\n  public render() {\n    return <section className=\"app-page\">{this.props.children}</section>;\n  }\n}\n\nexport default AppPage;\n","import * as React from \"react\";\n\nexport interface IFieldHeader {\n  label: string | JSX.Element;\n}\n\nconst style: React.CSSProperties = {\n  display: \"block\",\n  textAlign: \"center\"\n};\n\nclass FieldHeader extends React.PureComponent<IFieldHeader, {}> {\n  public render(): JSX.Element {\n    return (\n      <h4 style={style}>\n        <span className=\"align-text-middle\">{this.props.label}</span>\n      </h4>\n    );\n  }\n}\n\nexport default FieldHeader;\n","import * as React from \"react\";\nimport Icon from \"react-fa\";\n\nimport FieldHeader from \"./FieldHeader\";\n\nexport interface IDDLItem {\n  key: string;\n  label: string;\n}\n\nexport interface IDDLTextProps {\n  header: string;\n  default?: string;\n  locked?: boolean;\n  values: IDDLItem[];\n  onSubmit: (v: string) => void;\n}\n\ninterface IDDLTextState {\n  value: string;\n  edit: boolean;\n  dropdownOpen: boolean;\n}\n\nexport interface IDDLTextEvent {\n  target: { value: string };\n}\n\nclass DDLText extends React.PureComponent<IDDLTextProps, IDDLTextState> {\n  protected static getDerivedStateFromProps(\n    props: IDDLTextProps,\n    state: IDDLTextState\n  ): IDDLTextState {\n    if (!state.edit) {\n      state.value = props.default ? props.default : \"\";\n    }\n    return state;\n  }\n\n  constructor(props: IDDLTextProps) {\n    super(props);\n\n    this.state = {\n      dropdownOpen: false,\n      edit: false,\n      value: this.props.default ? this.props.default : \"\"\n    };\n\n    this.startEdit = this.startEdit.bind(this);\n    this.endEdit = this.endEdit.bind(this);\n    this.toggleDDL = this.toggleDDL.bind(this);\n    this.select = this.select.bind(this);\n    this.getLabelForSelectedKey = this.getLabelForSelectedKey.bind(this);\n    this.renderButton = this.renderButton.bind(this);\n    this.renderDropdownList = this.renderDropdownList.bind(this);\n    this.renderDropdownItems = this.renderDropdownItems.bind(this);\n    this.renderHeader = this.renderHeader.bind(this);\n  }\n\n  public render(): JSX.Element {\n    return this.state.edit ? this.renderDropdownList() : this.renderValue();\n  }\n\n  private startEdit() {\n    if (this.props.locked ? false : true) {\n      this.setState({ edit: true, dropdownOpen: false });\n    }\n  }\n\n  private endEdit() {\n    this.setState({ edit: false, dropdownOpen: false });\n    const labelForSelectedKey = this.getLabelForSelectedKey();\n    if (\n      this.state.value !== this.props.default &&\n      labelForSelectedKey.length > 0\n    ) {\n      this.props.onSubmit(this.state.value);\n    }\n  }\n\n  private toggleDDL() {\n    this.setState({ dropdownOpen: !this.state.dropdownOpen });\n  }\n\n  private select(key: string) {\n    this.setState({ value: key });\n  }\n\n  private getLabelForSelectedKey(): string {\n    return this.props.values\n      .map(\n        ({ key, label }: IDDLItem) => (key === this.state.value ? label : \"\")\n      )\n      .filter((e: string) => e !== \"\")\n      .join(\", \");\n  }\n\n  private renderHeader(): JSX.Element {\n    return <FieldHeader label={this.props.header} />;\n  }\n\n  private renderButton(labelForSelectedKey: string): JSX.Element {\n    const btnOk = (\n      <button onClick={this.endEdit} color=\"success\">\n        <Icon name=\"check\" />\n      </button>\n    );\n    const btnKo = (\n      <button onClick={this.endEdit} color=\"danger\">\n        <Icon name=\"times\" />\n      </button>\n    );\n    return labelForSelectedKey.length > 0 ? btnOk : btnKo;\n  }\n\n  private renderDropdownItems(): JSX.Element[] {\n    return this.props.values.map(({ key, label }: IDDLItem) => {\n      const selectMe = () => this.select(key);\n      return (\n        <div key={key} onClick={selectMe}>\n          {label}\n        </div>\n      );\n    });\n  }\n\n  private renderDropdownList(): JSX.Element {\n    const labelForSelectedKey = this.getLabelForSelectedKey();\n    return (\n      <div>\n        <div>{this.renderHeader()}</div>\n        <div>\n          <div>\n            <div>\n              {labelForSelectedKey.length > 0\n                ? labelForSelectedKey\n                : \"Choose a \" + this.props.header}\n            </div>\n            <div>{this.renderDropdownItems()}</div>\n          </div>\n          {this.renderButton(labelForSelectedKey)}\n        </div>\n      </div>\n    );\n  }\n\n  private renderValue(): JSX.Element {\n    const labelForSelectedKey = this.getLabelForSelectedKey();\n    return (\n      <div onClick={this.startEdit} role=\"button\">\n        <div>{this.renderHeader()}</div>\n        <div>\n          {labelForSelectedKey.length > 0\n            ? labelForSelectedKey\n            : this.state.value}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default DDLText;\n","import * as React from \"react\";\n\nimport DDLText from \"../../components/DDLText\";\nimport { archetypes, IDataArchetype } from \"../../data/archetypes\";\n\nexport interface IArchetypeProps {\n  value: string | undefined;\n  onChange: (s: string) => void;\n  locked: boolean;\n}\n\nclass Archetype extends React.PureComponent<IArchetypeProps, {}> {\n  public render() {\n    return (\n      <DDLText\n        header=\"Character Archetype\"\n        default={this.props.value}\n        values={archetypes\n          .sort((a: IDataArchetype, b: IDataArchetype) => {\n            if (a.name < b.name) {\n              return -1;\n            }\n            if (a.name > b.name) {\n              return 1;\n            }\n            return 0;\n          })\n          .map((a: IDataArchetype) => ({\n            key: a.key,\n            label: a.name\n          }))}\n        onSubmit={this.props.onChange}\n        locked={this.props.locked}\n      />\n    );\n  }\n}\n\nexport default Archetype;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport * as headerActions from \"../../state/actions/header\";\nimport { IStoreState } from \"../../state/type\";\n\nimport Archetype, {\n  IArchetypeProps\n} from \"../../components/Character/Archetype\";\n\ninterface IMapStateToProps {\n  locked: boolean;\n  value: string;\n}\n\ninterface IMapDispatchToProps {\n  onChange: (s: string) => void;\n}\n\nfunction mapStateToProps(state: IStoreState): IMapStateToProps {\n  return {\n    locked: state.archetype !== undefined,\n    value: state.archetype !== undefined ? state.archetype : \"\"\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<headerActions.IHeaderAction>\n): IMapDispatchToProps {\n  return {\n    onChange: (s: string) => dispatch(headerActions.setArchetype(s))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): IArchetypeProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(Archetype);\n","import * as React from \"react\";\nimport Icon from \"react-fa\";\nimport { Button, Input, InputGroup, InputGroupAddon } from \"reactstrap\";\n\nexport interface IEditTextProps {\n  header: string;\n  default?: string;\n  locked?: boolean;\n  validate: (v: string) => boolean;\n  onSubmit: (v: string) => void;\n}\n\ninterface IEditTextState {\n  value: string;\n  edit: boolean;\n}\n\nexport interface IEditTextEvent {\n  target: { value: string };\n}\n\nclass EditText extends React.PureComponent<IEditTextProps, IEditTextState> {\n  constructor(props: IEditTextProps) {\n    super(props);\n\n    this.state = {\n      edit: false,\n      value: this.props.default ? this.props.default : \"\"\n    };\n\n    this.componentWillReceiveProps = this.componentWillReceiveProps.bind(this);\n    this.startEdit = this.startEdit.bind(this);\n    this.endEdit = this.endEdit.bind(this);\n    this.textChange = this.textChange.bind(this);\n    this.renderEdit = this.renderEdit.bind(this);\n    this.renderNoEdit = this.renderNoEdit.bind(this);\n  }\n\n  public render(): JSX.Element {\n    return this.state.edit ? this.renderEdit() : this.renderNoEdit();\n  }\n\n  public componentWillReceiveProps(nextProps: IEditTextProps) {\n    this.setState({\n      value: nextProps.default ? nextProps.default : \"\"\n    });\n  }\n\n  private startEdit() {\n    if (this.props.locked ? false : true) {\n      this.setState({ edit: true });\n    }\n  }\n\n  private endEdit() {\n    this.setState({\n      edit: false,\n      value: this.state.value.trim()\n    });\n    if (this.props.validate(this.state.value)) {\n      if (this.state.value !== this.props.default) {\n        this.props.onSubmit(this.state.value);\n      }\n    }\n  }\n\n  private textChange(e: IEditTextEvent) {\n    this.setState({ value: e.target.value });\n  }\n\n  private renderButton(isValueValid: boolean): JSX.Element {\n    const btnOk = (\n      <Button onClick={this.endEdit} color=\"success\">\n        <Icon name=\"check\" />\n      </Button>\n    );\n    const btnKo = (\n      <Button onClick={this.endEdit} color=\"danger\">\n        <Icon name=\"times\" />\n      </Button>\n    );\n    return isValueValid ? btnOk : btnKo;\n  }\n\n  private renderNoEdit(): JSX.Element {\n    return (\n      <div onClick={this.startEdit} role=\"button\">\n        <InputGroup>\n          <InputGroupAddon addonType=\"prepend\">\n            {this.props.header}\n          </InputGroupAddon>\n          <div className=\"form-control\">{this.state.value}</div>\n        </InputGroup>\n      </div>\n    );\n  }\n\n  private renderEdit(): JSX.Element {\n    const isValueValid = this.props.validate(this.state.value);\n    return (\n      <div>\n        <InputGroup>\n          <InputGroupAddon addonType=\"prepend\">\n            {this.props.header}\n          </InputGroupAddon>\n          <Input\n            onChange={this.textChange}\n            value={this.state.value}\n            placeholder={this.state.value}\n            valid={isValueValid}\n          />\n          <InputGroupAddon addonType=\"append\">\n            {this.renderButton(isValueValid)}\n          </InputGroupAddon>\n        </InputGroup>\n      </div>\n    );\n  }\n}\n\nexport default EditText;\n","import * as React from \"react\";\n\nimport EditText from \"../../components/EditText\";\n\nexport interface IConceptProps {\n  value: string | undefined;\n  onChange: (s: string) => void;\n}\n\nclass Concept extends React.PureComponent<IConceptProps, {}> {\n  public render() {\n    return (\n      <EditText\n        header=\"Character Concept\"\n        default={this.props.value}\n        validate={this.isStringNotNull}\n        onSubmit={this.props.onChange}\n      />\n    );\n  }\n\n  private isStringNotNull(s: string): boolean {\n    return s.trim().length > 0;\n  }\n}\n\nexport default Concept;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport * as headerActions from \"../../state/actions/header\";\nimport { IStoreState } from \"../../state/type\";\n\nimport Concept, { IConceptProps } from \"../../components/Character/Concept\";\n\ninterface IMapStateToProps {\n  value: string;\n}\n\ninterface IMapDispatchToProps {\n  onChange: (s: string) => void;\n}\n\nfunction mapStateToProps(state: IStoreState): IMapStateToProps {\n  return {\n    value: state.concept !== undefined ? state.concept : \"\"\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<headerActions.IHeaderAction>\n): IMapDispatchToProps {\n  return {\n    onChange: (s: string) => dispatch(headerActions.setConcept(s))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): IConceptProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(Concept);\n","import * as React from \"react\";\nimport { InputGroup, InputGroupAddon } from \"reactstrap\";\n\nexport interface IStaticTextProps {\n  header: string;\n  value: string;\n}\n\nclass StaticText extends React.PureComponent<IStaticTextProps, {}> {\n  public render = (): JSX.Element => {\n    return (\n      <InputGroup>\n        <InputGroupAddon addonType=\"prepend\">\n          {this.props.header}\n        </InputGroupAddon>\n        <div className=\"form-control\">{this.props.value}</div>\n      </InputGroup>\n    );\n  };\n}\n\nexport default StaticText;\n","import * as React from \"react\";\n\nimport StaticText from \"../../components/StaticText\";\n\nexport interface IDestinyProps {\n  value: number;\n}\n\nclass Destiny extends React.PureComponent<IDestinyProps, {}> {\n  public render() {\n    return <StaticText header=\"Destiny\" value={this.props.value.toString()} />;\n  }\n}\n\nexport default Destiny;\n","import { connect } from \"react-redux\";\n\nimport { IStoreState } from \"../../state/type\";\n\nimport Destiny, { IDestinyProps } from \"../../components/Character/Destiny\";\n\nfunction mapStateToProps(state: IStoreState): IDestinyProps {\n  return {\n    value: state.destiny\n  };\n}\n\nexport default connect(mapStateToProps)(Destiny);\n","import * as React from \"react\";\n\nimport StaticText from \"../../components/StaticText\";\n\nexport interface IEntanglementProps {\n  value: number;\n}\n\nclass Entanglement extends React.PureComponent<IEntanglementProps, {}> {\n  public render() {\n    return (\n      <StaticText header=\"Entanglement\" value={this.props.value.toString()} />\n    );\n  }\n}\n\nexport default Entanglement;\n","import { connect } from \"react-redux\";\n\nimport { IStoreState } from \"../../state/type\";\n\nimport Entanglement, {\n  IEntanglementProps\n} from \"../../components/Character/Entanglement\";\n\nfunction mapStateToProps(state: IStoreState): IEntanglementProps {\n  return {\n    value: state.entanglement\n  };\n}\n\nexport default connect(mapStateToProps)(Entanglement);\n","import * as React from \"react\";\n\nimport EditText from \"../../components/EditText\";\n\nexport interface INameProps {\n  value: string | undefined;\n  onChange: (s: string) => void;\n}\n\nclass Name extends React.PureComponent<INameProps, {}> {\n  public render() {\n    return (\n      <EditText\n        header=\"Character Name\"\n        default={this.props.value}\n        validate={this.isStringNotNull}\n        onSubmit={this.props.onChange}\n      />\n    );\n  }\n\n  private isStringNotNull(s: string): boolean {\n    return s.trim().length > 0;\n  }\n}\n\nexport default Name;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport * as headerActions from \"../../state/actions/header\";\nimport { IStoreState } from \"../../state/type\";\n\nimport Name, { INameProps } from \"../../components/Character/Name\";\n\ninterface IMapStateToProps {\n  value: string;\n}\n\ninterface IMapDispatchToProps {\n  onChange: (s: string) => void;\n}\n\nfunction mapStateToProps(state: IStoreState): IMapStateToProps {\n  return {\n    value: state.name !== undefined ? state.name : \"\"\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<headerActions.IHeaderAction>\n): IMapDispatchToProps {\n  return {\n    onChange: (s: string) => dispatch(headerActions.setName(s))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): INameProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(Name);\n","import * as React from \"react\";\n\nimport DDLText from \"../../components/DDLText\";\nimport { ranks } from \"../../data/ranks\";\n\nexport interface IRankProps {\n  rank: { name: string; value: number } | undefined;\n  onChange: (s: string) => void;\n  locked: boolean;\n}\n\nclass Rank extends React.PureComponent<IRankProps, {}> {\n  public render() {\n    return (\n      <DDLText\n        header=\"Character Rank\"\n        default={this.props.rank ? this.props.rank.name : \"\"}\n        values={ranks.map(({ name: n, key: k }) => ({ label: n, key: k }))}\n        onSubmit={this.props.onChange}\n        locked={this.props.locked}\n      />\n    );\n  }\n}\n\nexport default Rank;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport * as headerActions from \"../../state/actions/header\";\nimport { IStoreState } from \"../../state/type\";\n\nimport Rank, { IRankProps } from \"../../components/Character/Rank\";\n\ninterface IMapStateToProps {\n  rank: { name: string; value: number } | undefined;\n  locked: boolean;\n}\n\ninterface IMapDispatchToProps {\n  onChange: (s: string) => void;\n}\n\nfunction mapStateToProps(state: IStoreState): IMapStateToProps {\n  return {\n    locked: state.archetype !== undefined,\n    rank: state.rank\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<headerActions.IHeaderAction>\n): IMapDispatchToProps {\n  return {\n    onChange: (s: string) => dispatch(headerActions.setRank(s))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): IRankProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(Rank);\n","import * as React from \"react\";\nimport { RouteComponentProps } from \"react-router\";\n\nimport AppIntro from \"../components/AppIntro\";\nimport AppPage from \"../components/AppPage\";\n\nimport Archetype from \"../containers/Character/Archetype\";\nimport Concept from \"../containers/Character/Concept\";\nimport Destiny from \"../containers/Character/Destiny\";\nimport Entanglement from \"../containers/Character/Entanglement\";\nimport Name from \"../containers/Character/Name\";\nimport Rank from \"../containers/Character/Rank\";\n\nclass Homepage extends React.PureComponent<RouteComponentProps<{}>> {\n  public render() {\n    return (\n      <div>\n        <AppIntro>Empty Intro</AppIntro>\n        <AppPage>\n          <Name />\n          <Concept />\n          <Archetype />\n          <Rank />\n          <Destiny />\n          <Entanglement />\n        </AppPage>\n      </div>\n    );\n  }\n}\n\nexport default Homepage;\n","import * as React from \"react\";\nimport Icon from \"react-fa\";\nimport { Button, InputGroup, InputGroupAddon } from \"reactstrap\";\n\nimport FieldHeader from \"./FieldHeader\";\n\nexport interface IEditNumericProps {\n  name: string | JSX.Element;\n  value: number;\n  canBuy: boolean;\n  onBuy: () => void;\n}\n\ninterface IEditNumericState {\n  edit: boolean;\n}\n\nclass EditNumeric extends React.PureComponent<\n  IEditNumericProps,\n  IEditNumericState\n> {\n  constructor(props: IEditNumericProps) {\n    super(props);\n\n    this.state = {\n      edit: false\n    };\n\n    this.startEdit = this.startEdit.bind(this);\n    this.endEdit = this.endEdit.bind(this);\n    this.doBuy = this.doBuy.bind(this);\n    this.renderHeader = this.renderHeader.bind(this);\n    this.renderButton = this.renderButton.bind(this);\n  }\n\n  public render() {\n    if (!this.state.edit) {\n      return (\n        <InputGroup onClick={this.startEdit} role=\"button\">\n          <InputGroupAddon addonType=\"prepend\">\n            {this.props.name}\n          </InputGroupAddon>\n          <div className=\"form-control\">{this.props.value}</div>\n        </InputGroup>\n      );\n    } else {\n      return (\n        <InputGroup>\n          <InputGroupAddon addonType=\"prepend\">\n            {this.props.name}\n          </InputGroupAddon>\n          <div className=\"form-control\">{this.props.value}</div>\n          <InputGroupAddon addonType=\"append\">\n            {this.props.canBuy ? this.renderButton(\"plus\", this.doBuy) : null}\n            {this.renderButton(\"times\", this.endEdit)}\n          </InputGroupAddon>\n        </InputGroup>\n      );\n    }\n  }\n\n  public componentDidUpdate() {\n    if (this.state.edit && !this.props.canBuy) {\n      this.endEdit();\n    }\n  }\n\n  private startEdit() {\n    if (this.props.canBuy) {\n      this.setState({ edit: true });\n    }\n  }\n\n  private endEdit() {\n    this.setState({\n      edit: false\n    });\n  }\n\n  private doBuy() {\n    this.props.onBuy();\n  }\n\n  private renderHeader(): JSX.Element {\n    return <FieldHeader label={this.props.name} />;\n  }\n\n  private renderButton(icon: string, f: () => void) {\n    return (\n      <Button onClick={f}>\n        <Icon name={icon} />\n      </Button>\n    );\n  }\n}\n\nexport default EditNumeric;\n","import * as React from \"react\";\n\nimport { ICost } from \"../../state/costs\";\n\nimport { TSkillName } from \"../../data/skills\";\n\nimport EditNumeric from \"../../components/EditNumeric\";\n\nexport interface ISkillProps {\n  name: TSkillName;\n  value: number;\n  cost: ICost;\n  canBuy: boolean;\n  onBuy: (cost: ICost) => void;\n}\n\nclass Skill extends React.PureComponent<ISkillProps, {}> {\n  constructor(props: ISkillProps) {\n    super(props);\n    this.onBuy = this.onBuy.bind(this);\n  }\n  public render() {\n    return (\n      <EditNumeric\n        name={this.props.name}\n        value={this.props.value}\n        canBuy={this.props.canBuy && this.props.cost.canPay}\n        onBuy={this.onBuy}\n      />\n    );\n  }\n\n  private onBuy(): void {\n    this.props.onBuy(this.props.cost);\n  }\n}\n\nexport default Skill;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport * as actions from \"../../state/actions/skills\";\nimport { getCostSkill, ICost } from \"../../state/costs\";\nimport { canBuySkill } from \"../../state/skills\";\nimport { IStoreState } from \"../../state/type\";\n\nimport { TSkillName } from \"../../data/skills\";\n\nimport Skill, { ISkillProps } from \"../../components/Character/Skill\";\n\ninterface IMapStateToProps {\n  canBuy: boolean;\n  cost: ICost;\n  name: TSkillName;\n  value: number;\n}\n\ninterface IProps {\n  name: TSkillName;\n}\n\ninterface IMapDispatchToProps {\n  onBuy: (cost: ICost) => void;\n}\n\nfunction mapStateToProps(state: IStoreState, props: IProps): IMapStateToProps {\n  return {\n    canBuy: canBuySkill(state, props.name),\n    cost: getCostSkill(state, props.name),\n    name: props.name,\n    value: state.skills[props.name].value\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<actions.ISkillAction>,\n  props: IProps\n): IMapDispatchToProps {\n  return {\n    onBuy: (cost: ICost) => {\n      dispatch(actions.skillsBuy(props.name, cost));\n    }\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): ISkillProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(Skill);\n","import * as React from \"react\";\n\nimport \"./TokenInput.css\";\n\ninterface ITokenInputProps {\n  allowNew?: boolean;\n  idKey?: string;\n  labelKey?: string;\n  onAdd: (id: string) => void;\n  options: any[];\n  tokens?: string[];\n}\n\ninterface ITokenInputState {\n  input: string;\n  focused: boolean;\n}\n\nclass TokenInput extends React.PureComponent<\n  ITokenInputProps,\n  ITokenInputState\n> {\n  public static defaultProps = {\n    idKey: \"id\",\n    labelKey: \"name\"\n  };\n\n  private idKey: string;\n  private labelKey: string;\n\n  constructor(props: ITokenInputProps) {\n    super(props);\n\n    this.labelKey = this.props.labelKey\n      ? this.props.labelKey\n      : TokenInput.defaultProps.labelKey;\n\n    this.idKey = this.props.idKey\n      ? this.props.idKey\n      : TokenInput.defaultProps.idKey;\n\n    this.state = {\n      focused: false,\n      input: \"\"\n    };\n\n    this.inputChange = this.inputChange.bind(this);\n    this.onBlur = this.onBlur.bind(this);\n    this.onFocus = this.onFocus.bind(this);\n  }\n\n  public render() {\n    return (\n      <div className=\"form-control\">\n        <div className=\"TokenInput\">\n          <div className=\"TokenInput-token-list\">{this.renderTokens()}</div>\n          <div className=\"TokenInput-dropdown\">\n            <input\n              className=\"TokenInput-input\"\n              onBlur={this.onBlur}\n              onChange={this.inputChange}\n              onFocus={this.onFocus}\n              value={this.state.input}\n            />\n            <div className=\"TokenInput-dropdown-content\">\n              {this.renderSuggestion()}\n              {this.renderAddNew()}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  private renderTokens(): JSX.Element[] {\n    return (this.props.tokens as string[]).map(t => (\n      <span key={t} className=\"TokenInput-token\">\n        {t}\n      </span>\n    ));\n  }\n\n  private renderSuggestion() {\n    return this.matchOptionsWithInput(false)\n      .filter((option: any) => option[this.labelKey].length > 0)\n      .filter(option => {\n        const label = option[this.labelKey];\n        const id = option[this.idKey];\n\n        if (!label || !id) {\n          return false;\n        }\n        return true;\n      })\n      .map((option: any) => {\n        const label = option[this.labelKey];\n        const id = option[this.idKey];\n        const onClick = () => {\n          this.props.onAdd(id);\n          this.resetState();\n        };\n        return (\n          <span key={id} onMouseDown={onClick}>\n            {label}\n          </span>\n        );\n      });\n  }\n\n  private renderAddNew(): JSX.Element | void {\n    if (!this.state.focused) {\n      return;\n    }\n    if (\n      this.props.allowNew &&\n      this.state.input.length > 0 &&\n      this.matchOptionsWithInput(true).length === 0\n    ) {\n      const onClick = () => {\n        this.props.onAdd(this.state.input);\n        this.resetState();\n      };\n      return (\n        <span id=\"addNew\" onMouseDown={onClick}>\n          Add a new entry : {this.state.input}\n        </span>\n      );\n    }\n  }\n\n  private onFocus(): void {\n    this.setState({\n      focused: true\n    });\n  }\n\n  private onBlur(): void {\n    /*this.setState({\n      focused: false\n    });*/\n  }\n\n  private inputChange(event: React.ChangeEvent<HTMLInputElement>): void {\n    this.setState({\n      input: event.target.value.trim()\n    });\n  }\n\n  private resetState(): void {\n    this.setState({\n      input: \"\"\n    });\n  }\n\n  private matchOptionsWithInput(exact: boolean): any[] {\n    if (!this.state.focused) {\n      return [];\n    }\n    const inputPrep = this.state.input.toLowerCase().trim();\n\n    return this.props.options\n      .filter((option: any) => {\n        /* tslint:disable no-console */\n        if (this.props.tokens) {\n          return !this.props.tokens.some(token => {\n            return token === option[this.labelKey];\n          });\n        } else {\n          return true;\n        }\n      })\n      .filter((option: any) => {\n        const label = option[this.labelKey];\n        if (!label) {\n          return false;\n        }\n\n        const labelPrep = label.toLowerCase().trim();\n\n        if (!exact && this.state.input.length > 0) {\n          return labelPrep.indexOf(inputPrep) !== -1;\n        } else if (exact) {\n          return inputPrep === labelPrep;\n        } else {\n          return true;\n        }\n      });\n  }\n}\n\nexport default TokenInput;\n","import * as React from \"react\";\nimport Icon from \"react-fa\";\nimport { Button, InputGroup, InputGroupAddon } from \"reactstrap\";\n\nimport TokenInput from \"../../components/TokenInput\";\nimport { ICost } from \"../../state/costs\";\n\ninterface IEditSpecialitiesProps {\n  bought: string[];\n  specialities: Array<{\n    name: string;\n    canBuy: boolean;\n    cost: ICost;\n  }>;\n  onBuy: (speciality: string, cost: ICost) => void;\n}\n\ninterface IEditSpecialitiesState {\n  edit: boolean;\n}\n\nclass EditSpecialities extends React.PureComponent<\n  IEditSpecialitiesProps,\n  IEditSpecialitiesState\n> {\n  constructor(props: IEditSpecialitiesProps) {\n    super(props);\n    this.state = {\n      edit: false\n    };\n\n    this.startEdit = this.startEdit.bind(this);\n    this.endEdit = this.endEdit.bind(this);\n    this.isValueValid = this.isValueValid.bind(this);\n\n    this.buySpeciality = this.buySpeciality.bind(this);\n    this.renderButton = this.renderButton.bind(this);\n    this.renderBoughtSpecialities = this.renderBoughtSpecialities.bind(this);\n    this.renderNoEdit = this.renderNoEdit.bind(this);\n    this.renderEdit = this.renderEdit.bind(this);\n  }\n\n  public render() {\n    if (!this.state.edit) {\n      return this.renderNoEdit();\n    } else {\n      return this.renderEdit();\n    }\n  }\n\n  private renderButton(icon: string, color: string, f: () => void) {\n    return (\n      <Button onClick={f} color={color}>\n        <Icon name={icon} />\n      </Button>\n    );\n  }\n\n  private renderBoughtSpecialities() {\n    return this.props.bought.map((speciality: string, index: number) => {\n      return (index > 0 ? \", \" : \"\") + speciality;\n    });\n  }\n\n  private renderNoEdit() {\n    const canBuy = this.props.specialities.some(\n      option => option.canBuy && option.cost.canPay\n    );\n    return (\n      <InputGroup onClick={this.startEdit} role=\"button\">\n        <div className=\"form-control\">{this.renderBoughtSpecialities()}</div>\n        {canBuy ? (\n          <InputGroupAddon addonType=\"append\">\n            {this.renderButton(\"plus\", \"default\", this.startEdit)}\n          </InputGroupAddon>\n        ) : (\n          \"\"\n        )}\n      </InputGroup>\n    );\n  }\n\n  private renderEdit() {\n    const optionList = this.props.specialities.map(speciality => {\n      return { id: speciality.name, name: speciality.name };\n    });\n\n    return (\n      <InputGroup>\n        <TokenInput\n          allowNew={true}\n          labelKey=\"name\"\n          onAdd={this.buySpeciality}\n          options={optionList}\n          tokens={this.props.bought}\n        />\n        <InputGroupAddon addonType=\"append\">\n          {this.renderButton(\"check\", \"success\", this.endEdit)}\n        </InputGroupAddon>\n      </InputGroup>\n    );\n  }\n\n  private startEdit(): void {\n    const canBuy = this.props.specialities.some(option => option.canBuy);\n    if (canBuy) {\n      this.setState({ edit: true });\n    }\n  }\n\n  private endEdit(): void {\n    this.setState({\n      edit: false\n    });\n  }\n\n  private isValueValid(specialityName: string): boolean {\n    return (\n      this.props.bought.findIndex(\n        speciality => specialityName === speciality\n      ) === -1\n    );\n  }\n\n  private buySpeciality(speciality: string) {\n    if (speciality.length === 0) {\n      return;\n    }\n    if (!this.isValueValid(speciality)) {\n      return;\n    }\n\n    const foundIndex = this.props.specialities.findIndex(available => {\n      return available.name === speciality;\n    });\n    if (foundIndex !== -1) {\n      if (this.props.specialities[foundIndex].canBuy) {\n        this.props.onBuy(\n          this.props.specialities[foundIndex].name,\n          this.props.specialities[foundIndex].cost\n        );\n      }\n    } else {\n      const indexNewSpeciality = this.props.specialities.findIndex(\n        option => option.name.length === 0\n      );\n      if (this.props.specialities[indexNewSpeciality].canBuy) {\n        this.props.onBuy(\n          speciality,\n          this.props.specialities[indexNewSpeciality].cost\n        );\n      }\n    }\n  }\n}\n\nexport default EditSpecialities;\n","import * as React from \"react\";\n\nimport { ICost } from \"../../state/costs\";\n\nimport EditSpecialities from \"./EditSpecialities\";\n\nexport interface ISpecialitiesProps {\n  specialities: Array<{\n    name: string;\n    canBuy: boolean;\n    cost: ICost;\n  }>;\n  bought: string[];\n\n  onBuy: (speciality: string, cost: ICost) => void;\n}\n\nclass Specialities extends React.PureComponent<ISpecialitiesProps, {}> {\n  public render() {\n    return (\n      <EditSpecialities\n        bought={this.props.bought}\n        specialities={this.props.specialities}\n        onBuy={this.props.onBuy}\n      />\n    );\n  }\n}\n\nexport default Specialities;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport * as actions from \"../../state/actions/skills\";\nimport { getCostSpeciality, ICost } from \"../../state/costs\";\nimport { canBuySpeciality } from \"../../state/skills\";\nimport { IStoreState } from \"../../state/type\";\n\nimport { skills as data, TSkillName } from \"../../data/skills\";\n\nimport Specialities, {\n  ISpecialitiesProps\n} from \"../../components/Character/Specialities\";\n\ninterface IMapStateToProps {\n  bought: string[];\n  specialities: Array<{\n    name: string;\n    canBuy: boolean;\n    cost: ICost;\n  }>;\n}\n\ninterface IProps {\n  skill: TSkillName;\n}\n\ninterface IMapDispatchToProps {\n  onBuy: (speciality: string, cost: ICost) => void;\n}\n\nfunction mapStateToProps(state: IStoreState, props: IProps): IMapStateToProps {\n  const newSpecialityAvailability = {\n    canBuy: canBuySpeciality(state, props.skill, \"\"),\n    cost: getCostSpeciality(state),\n    name: \"\"\n  };\n\n  const concat = data[props.skill].specialities.concat(\n    state.skills[props.skill].specialities\n  );\n  const merge = concat\n    .filter((item, pos) => concat.indexOf(item) === pos)\n    .sort();\n\n  const retVal = {\n    bought: state.skills[props.skill].specialities,\n    specialities: merge.map((speciality: string) => {\n      return {\n        canBuy: canBuySpeciality(state, props.skill, speciality),\n        cost: getCostSpeciality(state),\n        name: speciality\n      };\n    })\n  };\n  retVal.specialities.push(newSpecialityAvailability);\n  return retVal;\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<actions.ISkillAction>,\n  props: IProps\n): IMapDispatchToProps {\n  return {\n    onBuy: (speciality: string, cost: ICost) => {\n      dispatch(actions.skillSpecialityBuy(props.skill, speciality, cost));\n    }\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): ISpecialitiesProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(Specialities);\n","import * as React from \"react\";\n\nimport Skill from \"../../containers/Character/Skill\";\nimport Specialities from \"../../containers/Character/Specialities\";\nimport { skills, TSkillName } from \"../../data/skills\";\n\nimport \"./Skills.css\";\n\nclass Skills extends React.PureComponent<{}, {}> {\n  public render() {\n    return (\n      <ul className=\"skills-list\">\n        {Object.keys(skills).map((name: string) => {\n          return (\n            <li key={name} className=\"Grid\">\n              <div className=\"Grid-cell\">\n                <Skill name={name as TSkillName} />\n              </div>\n              <div className=\"Grid-cell\">\n                <Specialities skill={name as TSkillName} />\n              </div>\n            </li>\n          );\n        })}\n      </ul>\n    );\n  }\n}\n\nexport default Skills;\n","import * as React from \"react\";\nimport { RouteComponentProps } from \"react-router\";\n\nimport AppIntro from \"../components/AppIntro\";\nimport AppPage from \"../components/AppPage\";\nimport Skills from \"../components/Character/Skills\";\n\nimport { Input } from \"reactstrap\";\n\nclass RouteSkills extends React.PureComponent<RouteComponentProps<{}>> {\n  public render() {\n    return (\n      <div>\n        <AppIntro>\n          <Input placeholder=\"blabla\" />\n        </AppIntro>\n        <AppPage>\n          <Skills />\n        </AppPage>\n      </div>\n    );\n  }\n}\n\nexport default RouteSkills;\n","import * as React from \"react\";\n\nimport { ICost } from \"../../state/costs\";\n\nimport {\n  IDataVirtueType,\n  VIRTUE_CHIVALROUS,\n  VIRTUE_SELFISH\n} from \"../../data/virtues\";\n\nimport EditNumeric from \"../../components/EditNumeric\";\nimport FieldHeader from \"../../components/FieldHeader\";\n\ninterface IVirtueProp {\n  type: IDataVirtueType;\n  name: string;\n  value: number;\n  cost: ICost;\n  canBuy: boolean;\n  onBuy: () => void;\n}\n\nexport interface IVirtuesProps {\n  virtues: IVirtueProp[];\n}\n\nclass Virtues extends React.PureComponent<IVirtuesProps, {}> {\n  public render() {\n    const chivalrousVirtues = this.props.virtues.filter(\n      v => v.type === VIRTUE_CHIVALROUS\n    );\n    const selfishVirtues = this.props.virtues.filter(\n      v => v.type === VIRTUE_SELFISH\n    );\n    const max = Math.max(chivalrousVirtues.length, selfishVirtues.length);\n\n    const rows = [\n      <div key=\"header\">\n        <div>\n          <FieldHeader label=\"Chivalrous Virtues\" />\n        </div>\n        <div>\n          <FieldHeader label=\"Selfish Virtues\" />\n        </div>\n      </div>\n    ];\n    for (let i = 0; i < max; i++) {\n      const cvdiv =\n        i < chivalrousVirtues.length ? (\n          <div>{this.renderVirtue(chivalrousVirtues[i])}</div>\n        ) : (\n          <div />\n        );\n      const svdiv =\n        i < selfishVirtues.length ? (\n          <div>{this.renderVirtue(selfishVirtues[i])}</div>\n        ) : (\n          <div />\n        );\n\n      rows.push(\n        <div key={\"virtues_\" + i}>\n          {cvdiv}\n          {svdiv}\n        </div>\n      );\n    }\n    return <div>{rows.map(r => r)}</div>;\n  }\n\n  private renderVirtue(virtue: IVirtueProp): JSX.Element {\n    return (\n      <EditNumeric\n        name={virtue.name}\n        value={virtue.value}\n        canBuy={virtue.canBuy && virtue.cost.canPay}\n        onBuy={virtue.onBuy}\n      />\n    );\n  }\n}\n\nexport default Virtues;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport * as actions from \"../../state/actions/virtues\";\nimport { getCostVirtue, ICost } from \"../../state/costs\";\nimport { IStoreState } from \"../../state/type\";\nimport { canBuyVirtue } from \"../../state/virtues\";\n\nimport Virtues, { IVirtuesProps } from \"../../components/Character/Virtues\";\nimport { IDataVirtueType } from \"../../data/virtues\";\n\ninterface IMapStateToProps {\n  virtues: Array<{\n    canBuy: boolean;\n    cost: ICost;\n    name: string;\n    type: IDataVirtueType;\n    value: number;\n  }>;\n}\n\ninterface IMapDispatchToProps {\n  onBuy: (name: string, cost: ICost) => void;\n}\n\nfunction mapStateToProps(state: IStoreState): IMapStateToProps {\n  return {\n    virtues: state.virtues.map(v => {\n      return {\n        canBuy: canBuyVirtue(state, v.name),\n        cost: getCostVirtue(state),\n        name: v.name,\n        type: v.type,\n        value: v.value\n      };\n    })\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<actions.IVirtueAction>\n): IMapDispatchToProps {\n  return {\n    onBuy: (name: string, cost: ICost) =>\n      dispatch(actions.increase(name, 1, cost))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): IVirtuesProps {\n  const props: IVirtuesProps = { virtues: [] };\n\n  propsFromState.virtues.forEach(variable => {\n    const val = Object.assign({}, variable, {\n      onBuy: () => propsForDispatch.onBuy(variable.name, variable.cost)\n    });\n    props.virtues.push(val);\n  });\n  return props;\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(Virtues);\n","import * as constants from \"../constants/virtues\";\nimport { ICost } from \"../costs\";\n\nexport interface IVirtueIncrease {\n  type: constants.VIRTUE_INCREASE;\n  name: string;\n  value: number;\n  cost: ICost;\n}\n\nexport type IVirtueAction = IVirtueIncrease;\n\nexport function increase(\n  name: string,\n  value: number,\n  cost: ICost\n): IVirtueIncrease {\n  return { type: constants.VIRTUE_INCREASE, name, value, cost };\n}\n","import * as React from \"react\";\nimport { RouteComponentProps } from \"react-router\";\n\nimport AppIntro from \"../components/AppIntro\";\nimport AppPage from \"../components/AppPage\";\nimport Virtues from \"../containers/Character/Virtues\";\n\nclass RouteVirtues extends React.PureComponent<RouteComponentProps<{}>> {\n  public render() {\n    return (\n      <div>\n        <AppIntro>Empty Intro</AppIntro>\n        <AppPage>\n          <Virtues />\n        </AppPage>\n      </div>\n    );\n  }\n}\n\nexport default RouteVirtues;\n","import * as React from \"react\";\n\nimport { ICost } from \"../../state/costs\";\n\nimport { TChiName } from \"../../data/chi\";\n\nimport EditNumeric from \"../../components/EditNumeric\";\nimport StaticText from \"../../components/StaticText\";\n\nexport interface IChiProps {\n  name: TChiName;\n  value: number;\n  cultivation: number;\n  cost: ICost;\n  canBuy: boolean;\n  onBuy: (cost: ICost) => void;\n}\n\nclass Chi extends React.PureComponent<IChiProps, {}> {\n  constructor(props: IChiProps) {\n    super(props);\n    this.onBuy = this.onBuy.bind(this);\n  }\n  public render() {\n    const name =\n      this.props.name.charAt(0).toUpperCase() + this.props.name.slice(1);\n\n    return (\n      <div className=\"Grid\">\n        <div className=\"Grid-cell\">\n          <EditNumeric\n            name={name}\n            value={this.props.value}\n            canBuy={this.props.canBuy && this.props.canBuy}\n            onBuy={this.onBuy}\n          />\n        </div>\n        <div className=\"Grid-cell\">\n          <StaticText\n            header=\"Cultivation\"\n            value={this.props.cultivation.toString()}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  private onBuy(): void {\n    this.props.onBuy(this.props.cost);\n  }\n}\n\nexport default Chi;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport * as actions from \"../../state/actions/chi\";\nimport { canBuyChi } from \"../../state/chi\";\nimport { getCostChi, ICost } from \"../../state/costs\";\nimport { IStoreState } from \"../../state/type\";\n\nimport Chi, { IChiProps } from \"../../components/Character/Chi\";\nimport { TChiName } from \"../../data/chi\";\n\ninterface IMapStateToProps {\n  canBuy: boolean;\n  cost: ICost;\n  cultivation: number;\n  name: TChiName;\n  value: number;\n}\n\ninterface IMapDispatchToProps {\n  onBuy: (cost: ICost) => void;\n}\n\ninterface IProps {\n  name: TChiName;\n}\n\nfunction mapStateToProps(state: IStoreState, props: IProps): IMapStateToProps {\n  return {\n    canBuy: canBuyChi(/*state, props.name*/),\n    cost: getCostChi(state, props.name),\n    cultivation: state.chi[props.name].cultivation,\n    name: props.name,\n    value: state.chi[props.name].value\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<actions.IChiAction>,\n  props: IProps\n): IMapDispatchToProps {\n  return {\n    onBuy: (cost: ICost) => dispatch(actions.chiBuy(props.name, 1, cost))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): IChiProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(Chi);\n","import { TChiName } from \"../../data/chi\";\nimport * as constants from \"../constants/chi\";\nimport { ICost } from \"../costs\";\n\nexport interface IChiBuy {\n  type: constants.CHI_BUY;\n  chi: TChiName;\n  value: number;\n  cost: ICost;\n}\n\nexport type IChiAction = IChiBuy;\n\nexport function chiBuy(chi: TChiName, value: number, cost: ICost): IChiBuy {\n  return { chi, cost, type: constants.CHI_BUY, value };\n}\n","import * as React from \"react\";\n\nimport Chi from \"../../containers/Character/Chi\";\nimport { chiNames, TChiName } from \"../../data/chi\";\n\nclass ChiList extends React.PureComponent<{}, {}> {\n  public render() {\n    // TODO showing something ?\n    return (\n      <div>\n        {chiNames.map((name: TChiName) => {\n          return (\n            <div key={name}>\n              <div>\n                <Chi name={name} />\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nexport default ChiList;\n","import * as React from \"react\";\nimport { RouteComponentProps } from \"react-router\";\n\nimport AppIntro from \"../components/AppIntro\";\nimport AppPage from \"../components/AppPage\";\nimport ChiList from \"../components/Character/ChiList\";\n\nclass RouteChi extends React.PureComponent<RouteComponentProps<{}>> {\n  public render() {\n    return (\n      <div>\n        <AppIntro>Please select your Chi values</AppIntro>\n        <AppPage>\n          <ChiList />\n        </AppPage>\n      </div>\n    );\n  }\n}\n\nexport default RouteChi;\n","import * as React from 'react';\n\nclass PlaceHolder extends React.PureComponent<{}, {}> {\n  public render() {\n    return (\n      <div>\n        <div>This is a placeholder </div>\n        <div>The content will soon be added</div>\n        <div>\n          <div>{this.props.children}</div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default PlaceHolder;\n","import * as React from \"react\";\nimport { RouteComponentProps } from \"react-router\";\n\nimport AppIntro from \"../components/AppIntro\";\nimport AppPage from \"../components/AppPage\";\nimport PlaceHodler from \"../components/PlaceHolder\";\n\nclass RouteEquipment extends React.PureComponent<RouteComponentProps<{}>> {\n  public render() {\n    return (\n      <div>\n        <AppIntro>Empty Intro</AppIntro>\n        <AppPage>\n          <PlaceHodler>Soon to be Equipment</PlaceHodler>\n        </AppPage>\n      </div>\n    );\n  }\n}\n\nexport default RouteEquipment;\n","import * as React from \"react\";\nimport { RouteComponentProps } from \"react-router\";\n\nimport AppIntro from \"../components/AppIntro\";\nimport AppPage from \"../components/AppPage\";\nimport PlaceHodler from \"../components/PlaceHolder\";\n\nclass RouteConditions extends React.PureComponent<RouteComponentProps<{}>> {\n  public render() {\n    return (\n      <div>\n        <AppIntro>Empty Intro</AppIntro>\n        <AppPage>\n          <PlaceHodler>Soon to be Conditions</PlaceHodler>\n        </AppPage>\n      </div>\n    );\n  }\n}\n\nexport default RouteConditions;\n","import SelectorList from \"./SelectorList\";\n\nexport interface IOption {\n  id: string;\n  label: string;\n  meta?: string;\n  disabled?: boolean;\n}\n\nexport default SelectorList;\n","import * as React from \"react\";\n\nimport { IOption } from \"../SelectorList\";\n\nimport \"./SelectorList.css\";\n\ninterface ISelectorListProps {\n  options: IOption[];\n  preSelected?: string[];\n  renderItem: (id: string) => JSX.Element;\n}\n\nexport interface ISelectorListState {\n  selected: string[];\n  searched: string[];\n}\n\nclass SelectorList extends React.PureComponent<\n  ISelectorListProps,\n  ISelectorListState\n> {\n  constructor(props: ISelectorListProps) {\n    super(props);\n\n    this.state = {\n      searched: this.props.options.map(option => {\n        if (option.meta) {\n          return option.id;\n        } else {\n          return option.label;\n        }\n      }),\n      selected: this.props.preSelected ? this.props.preSelected : []\n    };\n\n    this.renderList = this.renderList.bind(this);\n    this.renderSearchBox = this.renderSearchBox.bind(this);\n    this.renderSelected = this.renderSelected.bind(this);\n    this.itemOnSelectedToggle = this.itemOnSelectedToggle.bind(this);\n    this.searchInputChanged = this.searchInputChanged.bind(this);\n  }\n\n  public render() {\n    return (\n      <section className=\"selector-list\">\n        <aside className=\"left-list\">\n          {this.renderSearchBox()}\n          {this.renderList()}\n        </aside>\n        <section className=\"right-list\">{this.renderSelected()}</section>\n      </section>\n    );\n  }\n\n  private renderSearchBox(): JSX.Element {\n    return (\n      <div className=\"searchbox\">\n        <input\n          type=\"search\"\n          placeholder=\"Search a style...\"\n          onChange={this.searchInputChanged}\n        />\n      </div>\n    );\n  }\n\n  private renderList(): JSX.Element {\n    return (\n      <ul className=\"search-list\">\n        {this.state.searched\n          .filter(id => {\n            const option = this.props.options.find(prop => {\n              return prop.id === id;\n            });\n            if (option === undefined) {\n              return false;\n            }\n            return true;\n          })\n          .map(id => {\n            const option = this.props.options.find(prop => {\n              return prop.id === id;\n            }) as IOption;\n            if (!option.disabled) {\n              const toggle = () => this.itemOnSelectedToggle(option);\n              const selected = this.state.selected.indexOf(option.id) !== -1;\n\n              return (\n                <li className=\"item\" onClick={toggle} key={option.id}>\n                  {selected ? <b>{option.label}</b> : option.label}\n                </li>\n              );\n            } else {\n              return (\n                <li className=\"header\" key={option.id}>\n                  {option.label}\n                </li>\n              );\n            }\n          })}\n      </ul>\n    );\n  }\n\n  private renderSelected(): JSX.Element[] {\n    return this.state.selected.map(selected => {\n      const element = this.props.renderItem(selected);\n      return (\n        <article className=\"selected-item\" key={selected}>\n          {element}\n        </article>\n      );\n    });\n  }\n\n  private itemOnSelectedToggle(item: { id: string; label: string }): void {\n    this.setState((prevState: ISelectorListState) => {\n      const idx = prevState.selected.indexOf(item.id);\n      const newList = this.state.selected.slice();\n\n      if (idx < 0) {\n        newList.splice(0, 0, item.id);\n      } else {\n        newList.splice(idx, 1);\n      }\n\n      newList.sort((a, b) => {\n        return (\n          this.props.options.findIndex(o => o.id === a) -\n          this.props.options.findIndex(o => o.id === b)\n        );\n      });\n\n      return {\n        selected: newList\n      };\n    });\n  }\n\n  private searchInputChanged(event: React.ChangeEvent<HTMLInputElement>): void {\n    const input = event.target.value.toLowerCase();\n    this.setState({\n      searched: this.props.options\n        .filter(option => {\n          if (input.length === 0) {\n            return true;\n          }\n          if (option.meta) {\n            return option.meta.toLowerCase().search(input) !== -1;\n          } else {\n            return option.label.toLowerCase().search(input) !== -1;\n          }\n        })\n        .map(option => option.id)\n    });\n  }\n}\n\nexport default SelectorList;\n","import * as dataKungFu from \"../../data/kungfu\";\nimport { KUNGFU_TYPE } from \"../../data/kungfu/types\";\nimport * as constants from \"../constants/kungfu\";\nimport { ICost } from \"../costs\";\n\nexport interface IKungFuOpenStyle {\n  type: constants.KUNGFU_OPEN_STYLE;\n  cost: ICost;\n  uid: string;\n  kungfuType: KUNGFU_TYPE;\n}\n\nexport interface IKungFuBuyTechnique {\n  type: constants.KUNGFU_BUY_TECHNIQUE;\n  cost: ICost;\n  styleUid: string;\n  uid: string;\n  kungfuType: KUNGFU_TYPE;\n}\n\nexport interface IKungFuSetCustomStyleName {\n  type: constants.KUNGFU_CUSTOM_NAME_FOR_STYLE;\n  uid: string;\n  name: string;\n  kungfuType: KUNGFU_TYPE;\n}\n\nexport interface IKungFuSetCustomTechniqueName {\n  type: constants.KUNGFU_CUSTOM_NAME_FOR_TECHNIQUE;\n  styleUid: string;\n  uid: string;\n  name: string;\n  kungfuType: KUNGFU_TYPE;\n}\n\nexport type IKungFuAction =\n  | IKungFuOpenStyle\n  | IKungFuBuyTechnique\n  | IKungFuSetCustomStyleName\n  | IKungFuSetCustomTechniqueName;\n\nexport function openStyle(\n  uid: string,\n  kungfuType: KUNGFU_TYPE,\n  cost: ICost\n): IKungFuOpenStyle {\n  dataKungFu.validateKungFuType(kungfuType);\n  dataKungFu.validateKungFuStyle(kungfuType, uid);\n  return { type: constants.KUNGFU_OPEN_STYLE, cost, uid, kungfuType };\n}\n\nexport function buyTechnique(\n  styleUid: string,\n  uid: string,\n  kungfuType: KUNGFU_TYPE,\n  cost: ICost\n): IKungFuBuyTechnique {\n  dataKungFu.validateKungFuType(kungfuType);\n  dataKungFu.validateKungFuStyle(kungfuType, styleUid);\n  dataKungFu.validateKungFuTechnique(kungfuType, styleUid, uid);\n  return {\n    cost,\n    kungfuType,\n    styleUid,\n    type: constants.KUNGFU_BUY_TECHNIQUE,\n    uid\n  };\n}\n\nexport function customStyleName(\n  uid: string,\n  kungfuType: KUNGFU_TYPE,\n  name: string\n): IKungFuSetCustomStyleName {\n  dataKungFu.validateKungFuType(kungfuType);\n  dataKungFu.validateKungFuStyle(kungfuType, uid);\n  if (name.length < 1) {\n    throw new Error(\"Invalid new name\");\n  }\n  return {\n    kungfuType,\n    name,\n    type: constants.KUNGFU_CUSTOM_NAME_FOR_STYLE,\n    uid\n  };\n}\n\nexport function customTechniqueName(\n  styleUid: string,\n  uid: string,\n  kungfuType: KUNGFU_TYPE,\n  name: string\n): IKungFuSetCustomTechniqueName {\n  dataKungFu.validateKungFuType(kungfuType);\n  dataKungFu.validateKungFuStyle(kungfuType, styleUid);\n  dataKungFu.validateKungFuTechnique(kungfuType, styleUid, uid);\n  if (name.length < 1) {\n    throw new Error(\"Invalid new name\");\n  }\n  return {\n    kungfuType,\n    name,\n    styleUid,\n    type: constants.KUNGFU_CUSTOM_NAME_FOR_TECHNIQUE,\n    uid\n  };\n}\n","import * as constants from \"../perks/constants/effects\";\n\nexport type IEffectStatistic =\n  | \"speed\"\n  | \"footwork\"\n  | \"strike\"\n  | \"damage\"\n  | \"block\"\n  | \"toughness\";\n\nexport interface IEffectCombatStatistic {\n  type: constants.EFFECT_COMBAT_STATISTIC;\n  increase: number;\n  statistic: IEffectStatistic;\n}\n\nexport interface IEffectConditionalText {\n  type: constants.EFFECT_CONDITIONAL_TEXT;\n  text: string[];\n}\n\nexport interface IEffectChiThresholdIncreaseBaseChi {\n  type: constants.EFFECT_CHI_THRESHOLD_INCREASE_BASE_CHI;\n  chiIncrease: number;\n}\n\nexport type IEffect =\n  | IEffectCombatStatistic\n  | IEffectConditionalText\n  | IEffectChiThresholdIncreaseBaseChi;\n\nexport function effectToString(effect: IEffect): string {\n  switch (effect.type) {\n    case constants.EFFECT_COMBAT_STATISTIC:\n      return (\n        (effect.increase > 0 ? \"+\" : \"\") +\n        effect.increase +\n        \" to \" +\n        effect.statistic\n      );\n    case constants.EFFECT_CONDITIONAL_TEXT:\n      return effect.text.toString();\n    case constants.EFFECT_CHI_THRESHOLD_INCREASE_BASE_CHI:\n      return (\n        (effect.chiIncrease > 0 ? \"+\" : \"\") +\n        effect.chiIncrease +\n        \" to Chi Threshold\"\n      );\n  }\n}\n","import * as React from \"react\";\nimport { Icon } from \"react-fa\";\n\nimport { kungfuTechniqueData } from \"../../data/kungfu\";\nimport {\n  IDataExternalKungfuTechnique,\n  KUNGFU_EXTERNAL\n} from \"../../data/kungfu/types\";\nimport { ICost } from \"../../state/costs\";\nimport { effectToString } from \"../../state/effects\";\n\nexport interface IExternalKungFuTechniqueProps {\n  styleUid: string;\n  uid: string;\n  cost: ICost;\n  canBuy: boolean;\n  onBuy: (cost: ICost) => void;\n}\n\nclass ExternalKungFuTechnique extends React.PureComponent<\n  IExternalKungFuTechniqueProps,\n  {}\n> {\n  constructor(props: IExternalKungFuTechniqueProps) {\n    super(props);\n\n    this.onBuy = this.onBuy.bind(this);\n    this.renderButton = this.renderButton.bind(this);\n  }\n\n  public render() {\n    const technique = kungfuTechniqueData(\n      KUNGFU_EXTERNAL,\n      this.props.styleUid,\n      this.props.uid\n    ) as IDataExternalKungfuTechnique;\n    if (technique === undefined) {\n      return;\n    }\n\n    const effect = effectToString(technique.effect);\n\n    return (\n      <tr key={technique.uid} role=\"button\" onClick={this.onBuy}>\n        <td>{technique.name}</td>\n        <td>{technique.cost}</td>\n        <td>\n          {technique.description}\n          {effect.length > 0 ? \" \" + effect : null}\n        </td>\n        <td>{this.renderButton()}</td>\n      </tr>\n    );\n  }\n\n  private renderButton(): JSX.Element {\n    if (this.props.canBuy && this.props.cost.canPay) {\n      return (\n        <button color=\"success\">\n          <Icon name=\"graduation-cap\" />\n        </button>\n      );\n    } else {\n      return (\n        <button color=\"danger\">\n          <Icon name=\"times\" />\n        </button>\n      );\n    }\n  }\n\n  private onBuy(): void {\n    if (this.props.canBuy && this.props.cost.canPay) {\n      this.props.onBuy(this.props.cost);\n    }\n  }\n}\n\nexport default ExternalKungFuTechnique;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport { getCostKungFuTechnique, ICost } from \"../../state/costs\";\n\nimport { buyTechnique, IKungFuAction } from \"../../state/actions/kungfu\";\nimport {\n  canBuyKungFuTechnique,\n  isStyleTechniquePresent\n} from \"../../state/kungfu\";\nimport { IStoreState } from \"../../state/type\";\n\nimport ExternalKungFuTechnique, {\n  IExternalKungFuTechniqueProps\n} from \"../../components/Character/ExternalKungFuTechnique\";\nimport { KUNGFU_EXTERNAL } from \"../../data/kungfu/types\";\n\ninterface IMapStateToProps {\n  styleUid: string;\n  uid: string;\n  known: boolean;\n  canBuy: boolean;\n  cost: ICost;\n}\n\ninterface IMapDispatchToProps {\n  onBuy: (cost: ICost) => void;\n}\n\ninterface IProps {\n  styleUid: string;\n  uid: string;\n}\n\nfunction mapStateToProps(state: IStoreState, props: IProps): IMapStateToProps {\n  return {\n    canBuy: canBuyKungFuTechnique(\n      state.kungfu,\n      KUNGFU_EXTERNAL,\n      props.styleUid,\n      props.uid\n    ),\n    cost: getCostKungFuTechnique(\n      state,\n      KUNGFU_EXTERNAL,\n      props.styleUid,\n      props.uid\n    ),\n    known: isStyleTechniquePresent(\n      state.kungfu,\n      KUNGFU_EXTERNAL,\n      props.styleUid,\n      props.uid\n    ),\n    styleUid: props.styleUid,\n    uid: props.uid\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<IKungFuAction>,\n  props: IProps\n): IMapDispatchToProps {\n  return {\n    onBuy: (cost: ICost) =>\n      dispatch(buyTechnique(props.styleUid, props.uid, KUNGFU_EXTERNAL, cost))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): IExternalKungFuTechniqueProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(ExternalKungFuTechnique);\n","import * as React from \"react\";\nimport { Icon } from \"react-fa\";\n\nimport { kungfuData } from \"../../data/kungfu\";\nimport {\n  IDataExternalKungfu,\n  IDataExternalKungfuStatistics,\n  KUNGFU_EXTERNAL\n} from \"../../data/kungfu/types\";\nimport { ICost } from \"../../state/costs\";\n\nimport ExternalKungFuTechnique from \"../../containers/Character/ExternalKungFuTechnique\";\n\nexport interface IExternalKungFuProps {\n  uid: string;\n  isOpen: boolean;\n  cost: ICost;\n  canOpen: boolean;\n  knownTechniques: string[];\n  onOpen: (cost: ICost) => void;\n  statistics: IDataExternalKungfuStatistics;\n}\n\nclass ExternalKungFu extends React.PureComponent<IExternalKungFuProps, {}> {\n  constructor(props: IExternalKungFuProps) {\n    super(props);\n\n    this.renderCrunch = this.renderCrunch.bind(this);\n    this.renderStats = this.renderStats.bind(this);\n    this.renderTechniques = this.renderTechniques.bind(this);\n    this.renderButton = this.renderButton.bind(this);\n  }\n\n  public render() {\n    const data = kungfuData(\n      KUNGFU_EXTERNAL,\n      this.props.uid\n    ) as IDataExternalKungfu;\n    return (\n      <div>\n        <div>\n          <div>{this.renderCrunch(data)}</div>\n        </div>\n      </div>\n    );\n  }\n\n  private renderCrunch(data: IDataExternalKungfu): JSX.Element {\n    return (\n      <div>\n        <div className=\"Grid\" style={{ justifyContent: \"space-between\" }}>\n          <h4>{data.name}</h4>\n          <span style={{ justifyContent: \"flex-end\" }}>\n            {this.renderButton()}\n          </span>\n        </div>\n        <div className=\"Grid\">\n          <h5>Weapons</h5>\n          <p>\n            {data.weapons.map(w => (\n              <button key={w} disabled={true}>\n                {w}\n              </button>\n            ))}\n          </p>\n        </div>\n        <div className=\"Grid\">\n          <div className=\"Grid-cell\">\n            <div className=\"Grid\">\n              <h5>Qualities</h5>\n              {data.qualities.map((q, i) => (\n                <p key={i}>{q}</p>\n              ))}\n            </div>\n            <div className=\"Grid\">\n              <h5>Laught</h5>\n              <p>{data.laugths}</p>\n            </div>\n            <div className=\"Grid\">\n              <h5>Fears</h5>\n              <p>{data.fears}</p>\n            </div>\n          </div>\n          <div className=\"Grid-cell\" style={{ flexGrow: 0 }}>\n            {this.renderStats()}\n          </div>\n        </div>\n        <div>\n          <h5>Techniques</h5>\n          {this.renderTechniques(data)}\n        </div>\n      </div>\n    );\n  }\n\n  private renderStats(): JSX.Element {\n    return (\n      <table>\n        <tbody>\n          {Object.keys(this.props.statistics).map(\n            (s: string): JSX.Element => {\n              return (\n                <tr key={s}>\n                  <td>{s}</td>\n                  <td>{this.props.statistics[s]}</td>\n                </tr>\n              );\n            }\n          )}\n        </tbody>\n      </table>\n    );\n  }\n\n  private renderTechniques(data: IDataExternalKungfu): JSX.Element {\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th>Name</th>\n            <th>Cost</th>\n            <th>Effect</th>\n            <th />\n          </tr>\n        </thead>\n        <tbody>\n          {data.techniques.map(t => (\n            <ExternalKungFuTechnique\n              key={t.uid}\n              styleUid={data.uid}\n              uid={t.uid}\n            />\n          ))}\n        </tbody>\n      </table>\n    );\n  }\n\n  private renderButton(): JSX.Element {\n    const onClick = () => this.props.onOpen(this.props.cost);\n    if (this.props.canOpen && this.props.cost.canPay) {\n      return (\n        <button color=\"success\" onClick={onClick}>\n          <Icon name=\"graduation-cap\" />\n        </button>\n      );\n    } else if (this.props.isOpen) {\n      return (\n        <button color=\"primary\" disabled={true}>\n          <Icon name=\"leanpub\" />\n        </button>\n      );\n    } else {\n      return (\n        <button color=\"danger\">\n          <Icon name=\"times\" />\n        </button>\n      );\n    }\n  }\n}\n\nexport default ExternalKungFu;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport { IKungFuAction, openStyle } from \"../../state/actions/kungfu\";\nimport { getCostKungFuStyle, ICost } from \"../../state/costs\";\nimport {\n  canOpenKungFu,\n  getExternalKungFuStatistics,\n  isStylePresent\n} from \"../../state/kungfu\";\nimport { IStoreState } from \"../../state/type\";\n\nimport ExternalKungFu, {\n  IExternalKungFuProps\n} from \"../../components/Character/ExternalKungFu\";\n\nimport {\n  IDataExternalKungfuStatistics,\n  KUNGFU_EXTERNAL\n} from \"../../data/kungfu/types\";\n\ninterface IProps {\n  uid: string;\n}\n\ninterface IMapStateToProps {\n  canOpen: boolean;\n  isOpen: boolean;\n  knownTechniques: string[];\n  uid: string;\n  cost: ICost;\n  statistics: IDataExternalKungfuStatistics;\n}\n\ninterface IMapDispatchToProps {\n  onOpen: (cost: ICost) => void;\n}\n\nfunction mapStateToProps(state: IStoreState, props: IProps): IMapStateToProps {\n  const isOpen = isStylePresent(state.kungfu, KUNGFU_EXTERNAL, props.uid);\n\n  return {\n    canOpen: canOpenKungFu(state.kungfu, KUNGFU_EXTERNAL, props.uid),\n    cost: getCostKungFuStyle(state /*, KUNGFU_EXTERNAL, props.uid*/),\n    isOpen,\n    knownTechniques: isOpen ? state.kungfu[KUNGFU_EXTERNAL][props.uid] : [],\n    statistics: getExternalKungFuStatistics(state.kungfu, props.uid),\n    uid: props.uid\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<IKungFuAction>,\n  props: IProps\n): IMapDispatchToProps {\n  return {\n    onOpen: (cost: ICost) =>\n      dispatch(openStyle(props.uid, KUNGFU_EXTERNAL, cost))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): IExternalKungFuProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(ExternalKungFu);\n","import * as React from \"react\";\nimport { Icon } from \"react-fa\";\n\nimport { kungfuTechniqueData } from \"../../data/kungfu\";\nimport {\n  IDataInternalKungfuTechnique,\n  KUNGFU_INTERNAL\n} from \"../../data/kungfu/types\";\nimport { ICost } from \"../../state/costs\";\nimport { effectToString } from \"../../state/effects\";\n\nexport interface IInternalKungFuTechniqueProps {\n  styleUid: string;\n  uid: string;\n  cost: ICost;\n  canBuy: boolean;\n  onBuy: (cost: ICost) => void;\n}\n\nclass InternalKungFuTechnique extends React.PureComponent<\n  IInternalKungFuTechniqueProps,\n  {}\n> {\n  constructor(props: IInternalKungFuTechniqueProps) {\n    super(props);\n\n    this.onBuy = this.onBuy.bind(this);\n    this.renderButton = this.renderButton.bind(this);\n  }\n\n  public render() {\n    const technique = kungfuTechniqueData(\n      KUNGFU_INTERNAL,\n      this.props.styleUid,\n      this.props.uid\n    ) as IDataInternalKungfuTechnique;\n    if (technique === undefined) {\n      return;\n    }\n\n    const effect = effectToString(technique.effect);\n\n    return (\n      <tr key={technique.uid} role=\"button\" onClick={this.onBuy}>\n        <td>{technique.name}</td>\n        <td>{technique.level}</td>\n        <td>\n          {technique.description}\n          {effect.length > 0 ? \" \" + effect : null}\n        </td>\n        <td>{this.renderButton()}</td>\n      </tr>\n    );\n  }\n\n  private renderButton(): JSX.Element {\n    if (this.props.canBuy && this.props.cost.canPay) {\n      return (\n        <button color=\"success\">\n          <Icon name=\"graduation-cap\" />\n        </button>\n      );\n    } else {\n      return (\n        <button color=\"danger\">\n          <Icon name=\"times\" />\n        </button>\n      );\n    }\n  }\n\n  private onBuy(): void {\n    if (this.props.canBuy && this.props.cost.canPay) {\n      this.props.onBuy(this.props.cost);\n    }\n  }\n}\n\nexport default InternalKungFuTechnique;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport { getCostKungFuTechnique, ICost } from \"../../state/costs\";\n\nimport { buyTechnique, IKungFuAction } from \"../../state/actions/kungfu\";\nimport {\n  canBuyKungFuTechnique,\n  isStyleTechniquePresent\n} from \"../../state/kungfu\";\nimport { IStoreState } from \"../../state/type\";\n\nimport InternalKungFuTechnique, {\n  IInternalKungFuTechniqueProps\n} from \"../../components/Character/InternalKungFuTechnique\";\nimport { KUNGFU_INTERNAL } from \"../../data/kungfu/types\";\n\ninterface IMapStateToProps {\n  styleUid: string;\n  uid: string;\n  known: boolean;\n  canBuy: boolean;\n  cost: ICost;\n}\n\ninterface IMapDispatchToProps {\n  onBuy: (cost: ICost) => void;\n}\n\ninterface IProps {\n  styleUid: string;\n  uid: string;\n}\n\nfunction mapStateToProps(state: IStoreState, props: IProps): IMapStateToProps {\n  return {\n    canBuy: canBuyKungFuTechnique(\n      state.kungfu,\n      KUNGFU_INTERNAL,\n      props.styleUid,\n      props.uid\n    ),\n    cost: getCostKungFuTechnique(\n      state,\n      KUNGFU_INTERNAL,\n      props.styleUid,\n      props.uid\n    ),\n    known: isStyleTechniquePresent(\n      state.kungfu,\n      KUNGFU_INTERNAL,\n      props.styleUid,\n      props.uid\n    ),\n    styleUid: props.styleUid,\n    uid: props.uid\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<IKungFuAction>,\n  props: IProps\n): IMapDispatchToProps {\n  return {\n    onBuy: (cost: ICost) =>\n      dispatch(buyTechnique(props.styleUid, props.uid, KUNGFU_INTERNAL, cost))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): IInternalKungFuTechniqueProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(InternalKungFuTechnique);\n","import * as React from \"react\";\nimport { Icon } from \"react-fa\";\n\nimport { kungfuData } from \"../../data/kungfu\";\nimport { IDataInternalKungfu, KUNGFU_INTERNAL } from \"../../data/kungfu/types\";\nimport { ICost } from \"../../state/costs\";\n\nimport InternalKungFuTechnique from \"../../containers/Character/InternalKungFuTechnique\";\n\nexport interface IInternalKungFuProps {\n  uid: string;\n  isOpen: boolean;\n  cost: ICost;\n  canOpen: boolean;\n  knownTechniques: string[];\n  onOpen: (cost: ICost) => void;\n}\n\nclass InternalKungFu extends React.PureComponent<IInternalKungFuProps, {}> {\n  constructor(props: IInternalKungFuProps) {\n    super(props);\n\n    this.renderTechniques = this.renderTechniques.bind(this);\n    this.renderButton = this.renderButton.bind(this);\n  }\n\n  public render() {\n    const data = kungfuData(\n      KUNGFU_INTERNAL,\n      this.props.uid\n    ) as IDataInternalKungfu;\n    return (\n      <div>\n        <div className=\"Grid\" style={{ justifyContent: \"space-between\" }}>\n          <h4>{data.name}</h4>\n          <span style={{ justifyContent: \"flex-end\" }}>\n            {this.renderButton()}\n          </span>\n        </div>\n        <div>\n          <h5>Description</h5>\n          <p>{data.description}</p>\n        </div>\n        <div className=\"Grid\">\n          <h5>Element</h5>\n          <p>\n            <button disabled={true}>{data.element}</button>\n          </p>\n        </div>\n        <div>\n          <h5>Techniques</h5>\n        </div>\n        {this.renderTechniques(data)}\n      </div>\n    );\n  }\n\n  private renderTechniques(data: IDataInternalKungfu): JSX.Element {\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th>Name</th>\n            <th>Level</th>\n            <th>Effect</th>\n            <th />\n          </tr>\n        </thead>\n        <tbody>\n          {data.techniques\n            .sort((a, b) => a.level - b.level)\n            .map(t => (\n              <InternalKungFuTechnique\n                key={t.uid}\n                styleUid={data.uid}\n                uid={t.uid}\n              />\n            ))}\n        </tbody>\n      </table>\n    );\n  }\n\n  private renderButton(): JSX.Element {\n    const onClick = () => this.props.onOpen(this.props.cost);\n    if (this.props.canOpen && this.props.cost.canPay) {\n      return (\n        <button color=\"success\" onClick={onClick}>\n          <Icon name=\"graduation-cap\" />\n        </button>\n      );\n    } else if (this.props.isOpen) {\n      return (\n        <button color=\"primary\" disabled={true}>\n          <Icon name=\"leanpub\" />\n        </button>\n      );\n    } else {\n      return (\n        <button color=\"danger\">\n          <Icon name=\"times\" />\n        </button>\n      );\n    }\n  }\n}\n\nexport default InternalKungFu;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport { IKungFuAction, openStyle } from \"../../state/actions/kungfu\";\nimport { getCostKungFuStyle, ICost } from \"../../state/costs\";\nimport { canOpenKungFu, isStylePresent } from \"../../state/kungfu\";\nimport { IStoreState } from \"../../state/type\";\n\nimport InternalKungFu, {\n  IInternalKungFuProps\n} from \"../../components/Character/InternalKungFu\";\n\nimport { KUNGFU_INTERNAL } from \"../../data/kungfu/types\";\n\ninterface IProps {\n  uid: string;\n}\n\ninterface IMapStateToProps {\n  canOpen: boolean;\n  isOpen: boolean;\n  knownTechniques: string[];\n  uid: string;\n  cost: ICost;\n}\n\ninterface IMapDispatchToProps {\n  onOpen: (cost: ICost) => void;\n}\n\nfunction mapStateToProps(state: IStoreState, props: IProps): IMapStateToProps {\n  const isOpen = isStylePresent(state.kungfu, KUNGFU_INTERNAL, props.uid);\n\n  return {\n    canOpen: canOpenKungFu(state.kungfu, KUNGFU_INTERNAL, props.uid),\n    cost: getCostKungFuStyle(state /*, KUNGFU_INTERNAL, props.uid*/),\n    isOpen,\n    knownTechniques: isOpen ? state.kungfu[KUNGFU_INTERNAL][props.uid] : [],\n    uid: props.uid\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<IKungFuAction>,\n  props: IProps\n): IMapDispatchToProps {\n  return {\n    onOpen: (cost: ICost) =>\n      dispatch(openStyle(props.uid, KUNGFU_INTERNAL, cost))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): IInternalKungFuProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(InternalKungFu);\n","import * as React from \"react\";\n\nimport SelectorList, { IOption } from \"../../components/SelectorList\";\n\nimport ExternalKungFu from \"../../containers/Character/ExternalKungFu\";\nimport InternalKungFu from \"../../containers/Character/InternalKungFu\";\n\nimport {\n  externalKungfu,\n  getKungFuType,\n  internalKungfu\n} from \"../../data/kungfu\";\nimport { KUNGFU_EXTERNAL } from \"../../data/kungfu/types\";\n\nclass KungFuList extends React.PureComponent<{}, {}> {\n  constructor(props: {}) {\n    super(props);\n\n    this.renderItem = this.renderItem.bind(this);\n  }\n\n  public render() {\n    const externals: IOption[] = externalKungfu.map(kf => ({\n      disabled: false,\n      id: kf.uid,\n      label: kf.name,\n      meta: kf.name + \",external\"\n    }));\n    const internals: IOption[] = internalKungfu.map(kf => ({\n      disabled: false,\n      id: kf.uid,\n      label: kf.name,\n      meta: kf.name + \",internal\"\n    }));\n\n    const externalHeader: IOption[] = [\n      {\n        disabled: true,\n        id: \"External Styles\",\n        label: \"External Styles\",\n        meta: \"external\"\n      }\n    ];\n    const internalHeader: IOption[] = [\n      {\n        disabled: true,\n        id: \"Internal Styles\",\n        label: \"Internal Styles\",\n        meta: \"internal\"\n      }\n    ];\n\n    return (\n      <SelectorList\n        options={externalHeader\n          .concat(externals)\n          .concat(internalHeader)\n          .concat(internals)}\n        preSelected={[]}\n        renderItem={this.renderItem}\n      />\n    );\n  }\n\n  private renderItem(uid: string): JSX.Element {\n    const type = getKungFuType(uid);\n    if (type === KUNGFU_EXTERNAL) {\n      return <ExternalKungFu uid={uid} />;\n    } else {\n      return <InternalKungFu uid={uid} />;\n    }\n  }\n}\n\nexport default KungFuList;\n","import * as React from \"react\";\nimport { RouteComponentProps } from \"react-router\";\n\nimport AppIntro from \"../components/AppIntro\";\nimport AppPage from \"../components/AppPage\";\nimport KungFuList from \"../components/Character/KungFuList\";\n\nclass RouteKungFu extends React.PureComponent<RouteComponentProps<{}>> {\n  public render() {\n    return (\n      <div>\n        <AppIntro>Empty Intro</AppIntro>\n        <AppPage>\n          <KungFuList />\n        </AppPage>\n      </div>\n    );\n  }\n}\n\nexport default RouteKungFu;\n","import * as React from \"react\";\nimport { Button, Modal, ModalBody, ModalFooter, ModalHeader } from \"reactstrap\";\n\nimport { getLoresheetOptionData, IPerk } from \"../../data/loresheets\";\nimport { IBonus } from \"../../perks/bonuses\";\nimport * as bonuses from \"../../perks/constants/bonuses\";\nimport { ICost } from \"../../state/costs\";\n\nimport EditText from \"../../components/EditText\";\n\nimport Slider from \"rc-slider\";\nimport \"rc-slider/assets/index.css\";\n\nexport interface ILoresheetOptionPopupProps {\n  lsUid: string;\n  uid: string;\n  cost: ICost[];\n  onBuy: (cost: ICost, payload?: string) => void;\n  isOpen: boolean;\n  toggle: () => void;\n}\n\ninterface ILoresheetOptionPopupState {\n  cost?: ICost;\n  payload?: string;\n}\n\nfunction fromBonusToString(bonus: IBonus): string {\n  switch (bonus.type) {\n    case bonuses.BONUS_DESTINY:\n      return \"destiny +\" + bonus.value;\n    case bonuses.BONUS_ENTANGLEMENT:\n      return \"entanglement +\" + bonus.value;\n    case bonuses.BONUS_CHI:\n      return bonus.chi + \" chi +\" + bonus.value;\n    case bonuses.BONUS_CULTIVATION:\n      return bonus.chi + \" chi cultivation +\" + bonus.value;\n    case bonuses.BONUS_ONE_AMONG_N:\n      throw new Error(\n        \"bonus too complicated to render : \" + JSON.stringify(bonus)\n      );\n    case bonuses.BONUS_SKILL_RANK:\n      return \"skill \" + bonus.skill + \" +5\";\n    case bonuses.BONUS_SPECIALITY:\n      return \"skill \" + bonus.skill + \" : free speciality \" + bonus.speciality;\n    default:\n      return \"no\";\n  }\n}\n\nclass LoresheetOptionPopup extends React.PureComponent<\n  ILoresheetOptionPopupProps,\n  ILoresheetOptionPopupState\n> {\n  constructor(props: ILoresheetOptionPopupProps) {\n    super(props);\n\n    const initState: ILoresheetOptionPopupState = {};\n    if (this.props.cost.length === 1) {\n      initState.cost = this.props.cost[0];\n    }\n    this.state = initState;\n\n    this.renderComplexCost = this.renderComplexCost.bind(this);\n    this.renderPayload = this.renderPayload.bind(this);\n    this.buyButtonClick = this.buyButtonClick.bind(this);\n  }\n\n  public render() {\n    const data = getLoresheetOptionData(this.props.lsUid, this.props.uid);\n    const payload: React.ReactNode = data.payload\n      ? this.renderPayload(data.payload)\n      : undefined;\n    const choices: React.ReactNode = data.perks.map((p: IPerk, id: number) =>\n      this.renderBonusChoices(p, id)\n    );\n    const complexCost: React.ReactNode =\n      typeof data.cost === \"number\" ? undefined : this.renderComplexCost();\n    return (\n      <Modal isOpen={this.props.isOpen}>\n        <ModalHeader toggle={this.props.toggle}>{data.type}</ModalHeader>\n        <ModalBody>\n          {data.description}\n          <hr />\n          {[payload, choices, complexCost]}\n        </ModalBody>\n        <ModalFooter>{this.renderBuyButton()}</ModalFooter>\n      </Modal>\n    );\n  }\n\n  private renderBonusChoices(perk: IPerk, key: any): React.ReactNode {\n    if (perk.type !== bonuses.BONUS_ONE_AMONG_N) {\n      return;\n    }\n    const onChange = (all: any) => {\n      /* tslint:disable:no-console */\n      console.log(all.target.value);\n    };\n    return (\n      <div key={\"bonus_\" + key}>\n        {Object.keys(perk.bonuses).map((bonusKey: string) => (\n          <div key={bonusKey}>\n            <input\n              type=\"radio\"\n              key={\"radio_bonus_\" + key}\n              name={\"bonus_\" + key}\n              onChange={onChange}\n            />\n            {fromBonusToString(perk.bonuses[bonusKey])}\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  private renderPayload(payload: string): React.ReactNode {\n    const onChange = (p: string) => {\n      this.setState({\n        cost: this.state.cost,\n        payload: p\n      });\n    };\n    const notNull = (s: string) => s.length > 0;\n    return (\n      <EditText\n        key={\"payload\"}\n        header={payload}\n        default={this.state.payload}\n        validate={notNull}\n        onSubmit={onChange}\n      />\n    );\n  }\n\n  private renderComplexCost(): React.ReactNode {\n    const onChange = (idx: number) => {\n      this.setState({\n        cost: this.props.cost[idx],\n        payload: this.state.payload\n      });\n    };\n\n    let marks = {};\n    this.props.cost.forEach((cost: ICost, idx: number) => {\n      const newMarks = {\n        [idx]: {\n          label: cost.original.toString(),\n          style: { color: cost.canPay ? \"black\" : \"light-grey\" }\n        }\n      };\n      marks = { ...marks, ...newMarks };\n    });\n    return (\n      <div key=\"cost\">\n        <Slider\n          min={0}\n          max={this.props.cost.length - 1} // 0-indexed\n          marks={marks}\n          included={false}\n          onChange={onChange}\n          step={null}\n        />\n        <br />\n      </div>\n    );\n  }\n\n  private renderBuyButton(): React.ReactNode {\n    const data = getLoresheetOptionData(this.props.lsUid, this.props.uid);\n\n    const requirePayload: React.ReactNode = data.payload ? true : false;\n    const activePayload =\n      !requirePayload || (this.state.payload && this.state.payload.length > 0);\n    const activeCost = this.state.cost ? this.state.cost.canPay : false;\n    const active = activePayload && activeCost;\n\n    return (\n      <Button disabled={!active} color=\"info\" onClick={this.buyButtonClick}>\n        Pay\n      </Button>\n    );\n  }\n\n  private buyButtonClick(): void {\n    if (this.state.cost && this.state.cost.canPay) {\n      this.props.onBuy(this.state.cost, this.state.payload);\n      this.props.toggle();\n      this.setState({});\n    }\n  }\n}\n\nexport default LoresheetOptionPopup;\n","import * as React from \"react\";\nimport { Icon } from \"react-fa\";\n\nimport { getLoresheetOptionData } from \"../../data/loresheets\";\nimport { ICost } from \"../../state/costs\";\nimport LoresheetOptionPopup from \"./LoresheetOptionPopup\";\n\nexport interface ILoresheetOptionProps {\n  lsUid: string;\n  uid: string;\n  cost: ICost[];\n  canBuy: boolean;\n  onBuy: (cost: ICost) => void;\n  payloads: any[];\n}\n\ninterface ILoresheetOptionState {\n  isModalOpen: boolean;\n}\n\nclass LoresheetOption extends React.PureComponent<\n  ILoresheetOptionProps,\n  ILoresheetOptionState\n> {\n  constructor(props: ILoresheetOptionProps) {\n    super(props);\n\n    this.state = { isModalOpen: false };\n\n    this.renderButton = this.renderButton.bind(this);\n\n    this.renderKnown = this.renderKnown.bind(this);\n    this.renderNotKnown = this.renderNotKnown.bind(this);\n    this.onRowClickBuy = this.onRowClickBuy.bind(this);\n    this.toggleModal = this.toggleModal.bind(this);\n  }\n\n  public render() {\n    const data = getLoresheetOptionData(this.props.lsUid, this.props.uid);\n    if (data === undefined) {\n      return;\n    }\n    const known = this.props.payloads.map((payload, index) =>\n      this.renderKnown(payload, index)\n    );\n    if (known.length > 0 && data.repeatable) {\n      return known.concat(this.renderNotKnown());\n    } else if (known.length > 0) {\n      return known;\n    } else {\n      return this.renderNotKnown();\n    }\n  }\n\n  private renderButton(canBuy: boolean): JSX.Element {\n    if (canBuy) {\n      return (\n        <button color=\"success\">\n          <Icon name=\"graduation-cap\" />\n        </button>\n      );\n    } else {\n      return (\n        <button color=\"danger\">\n          <Icon name=\"times\" />\n        </button>\n      );\n    }\n  }\n\n  private fromCostToString(cost: number | { min: number; max: number }) {\n    if (typeof cost === \"number\") {\n      return cost;\n    } else {\n      return cost.min + \"-\" + cost.max;\n    }\n  }\n\n  private renderKnown(payload: any, index: number): JSX.Element {\n    const data = getLoresheetOptionData(this.props.lsUid, this.props.uid);\n    return (\n      <tr key={\"known_\" + data.uid + \"_\" + index}>\n        <td>{data.type}</td>\n        <td>{this.fromCostToString(data.cost)}</td>\n        <td>{data.description}</td>\n        <td />\n      </tr>\n    );\n  }\n\n  private renderNotKnown(): JSX.Element {\n    const data = getLoresheetOptionData(this.props.lsUid, this.props.uid);\n    const canBuyOneOrMore =\n      this.props.canBuy &&\n      this.props.cost\n        .map(cost => cost.canPay)\n        .reduce(\n          (previousValue, currentValue) => previousValue || currentValue,\n          false\n        );\n    return (\n      <tr\n        key={\"unknown_\" + data.uid}\n        role=\"button\"\n        onClick={this.onRowClickBuy}\n      >\n        <LoresheetOptionPopup\n          lsUid={this.props.lsUid}\n          uid={this.props.uid}\n          cost={this.props.cost}\n          onBuy={this.props.onBuy}\n          isOpen={this.state.isModalOpen}\n          toggle={this.toggleModal}\n        />\n        <td>{data.type}</td>\n        <td>{this.fromCostToString(data.cost)}</td>\n        <td>{data.description}</td>\n        <td>{this.renderButton(canBuyOneOrMore)}</td>\n      </tr>\n    );\n  }\n\n  private onRowClickBuy(): void {\n    const canBuyOneOrMore =\n      this.props.canBuy &&\n      this.props.cost\n        .map(cost => cost.canPay)\n        .reduce(\n          (previousValue, currentValue) => previousValue || currentValue,\n          false\n        );\n    if (canBuyOneOrMore && !this.state.isModalOpen) {\n      this.toggleModal();\n    }\n  }\n\n  private toggleModal(): void {\n    this.setState({ isModalOpen: !this.state.isModalOpen });\n  }\n}\n\nexport default LoresheetOption;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport { getCostBuyLoresheetOption, ICost } from \"../../state/costs\";\n\nimport { buyOption, ILoresheetAction } from \"../../state/actions/loresheets\";\nimport {\n  canBuyLoresheetOption,\n  isLoresheetOptionPresent\n} from \"../../state/loresheets\";\nimport { IStoreState } from \"../../state/type\";\n\nimport LoresheetOption, {\n  ILoresheetOptionProps\n} from \"../../components/Character/LoresheetOption\";\n\ninterface IMapStateToProps {\n  lsUid: string;\n  uid: string;\n  known: boolean;\n  canBuy: boolean;\n  cost: ICost[];\n  payloads: any[];\n}\n\ninterface IMapDispatchToProps {\n  onBuy: (cost: ICost) => void;\n}\n\ninterface IProps {\n  lsUid: string;\n  uid: string;\n}\n\nfunction mapStateToProps(state: IStoreState, props: IProps): IMapStateToProps {\n  const lsState = state.loresheets[props.lsUid];\n  const payloads =\n    lsState === undefined\n      ? []\n      : lsState.filter(o => o.uid === props.uid).map(o => o.payload);\n\n  return {\n    canBuy: canBuyLoresheetOption(state.loresheets, props.lsUid, props.uid),\n    cost: getCostBuyLoresheetOption(state, props.lsUid, props.uid),\n    known: isLoresheetOptionPresent(state.loresheets, props.lsUid, props.uid),\n    lsUid: props.lsUid,\n    payloads,\n    uid: props.uid\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<ILoresheetAction>,\n  props: IProps\n): IMapDispatchToProps {\n  return {\n    onBuy: (cost: ICost, payload?: string) =>\n      dispatch(buyOption(props.lsUid, props.uid, cost, payload))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): ILoresheetOptionProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(LoresheetOption);\n","import * as dataLoresheets from \"../../data/loresheets\";\nimport * as constants from \"../constants/loresheets\";\nimport { ICost } from \"../costs\";\n\nexport interface ILoresheetOpen {\n  type: constants.LORESHEET_OPEN;\n  uid: string;\n  cost: ICost;\n}\n\nexport interface ILoresheetBuyOption {\n  type: constants.LORESHEET_BUY_OPTION;\n  lsUid: string;\n  uid: string;\n  cost: ICost;\n  payload?: string;\n}\n\nexport type ILoresheetAction = ILoresheetOpen | ILoresheetBuyOption;\n\nexport function open(uid: string, cost: ICost): ILoresheetOpen {\n  dataLoresheets.validateLoresheet(uid);\n  return { cost, type: constants.LORESHEET_OPEN, uid };\n}\n\nexport function buyOption(\n  lsUid: string,\n  uid: string,\n  cost: ICost,\n  payload?: string\n): ILoresheetBuyOption {\n  dataLoresheets.validateLoresheetOption(lsUid, uid);\n  return { cost, lsUid, type: constants.LORESHEET_BUY_OPTION, uid, payload };\n}\n","import * as React from \"react\";\nimport Icon from \"react-fa\";\n\nimport { getLoresheetData, IDataLoresheet } from \"../../data/loresheets\";\nimport { ICost } from \"../../state/costs\";\n\nimport LoresheetOption from \"../../containers/Character/LoresheetOption\";\n\nexport interface ILoresheetProps {\n  uid: string;\n  known: boolean;\n  cost: ICost;\n  canOpen: boolean;\n  onOpen: (cost: ICost) => void;\n}\n\nclass Loresheet extends React.PureComponent<ILoresheetProps, {}> {\n  constructor(props: ILoresheetProps) {\n    super(props);\n\n    this.renderOptions = this.renderOptions.bind(this);\n    this.renderButton = this.renderButton.bind(this);\n  }\n\n  public render() {\n    const data = getLoresheetData(this.props.uid) as IDataLoresheet;\n    return (\n      <div>\n        <div className=\"Grid\" style={{ justifyContent: \"space-between\" }}>\n          <h4>{data.name}</h4>\n          <span style={{ justifyContent: \"flex-end\" }}>\n            {this.renderButton()}\n          </span>\n        </div>\n        <div>\n          <p>{data.description}</p>\n        </div>\n        <div>{this.renderOptions(data)}</div>\n      </div>\n    );\n  }\n\n  private renderOptions(data: IDataLoresheet): JSX.Element {\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th>Type</th>\n            <th>Cost</th>\n            <th>Effect</th>\n            <th />\n          </tr>\n        </thead>\n        <tbody>\n          {data.options.map(o => (\n            <LoresheetOption key={o.uid} lsUid={data.uid} uid={o.uid} />\n          ))}\n        </tbody>\n      </table>\n    );\n  }\n\n  private renderButton(): JSX.Element {\n    const onClick = () => this.props.onOpen(this.props.cost);\n    if (this.props.canOpen && this.props.cost.canPay) {\n      return (\n        <button color=\"success\" onClick={onClick}>\n          <Icon name=\"graduation-cap\" />\n        </button>\n      );\n    } else if (this.props.known) {\n      return (\n        <button color=\"primary\" disabled={true}>\n          <Icon name=\"leanpub\" />\n        </button>\n      );\n    } else {\n      return (\n        <button color=\"danger\">\n          <Icon name=\"times\" />\n        </button>\n      );\n    }\n  }\n}\n\nexport default Loresheet;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport { getCostOpenLoresheet, ICost } from \"../../state/costs\";\n\nimport { ILoresheetAction, open } from \"../../state/actions/loresheets\";\nimport { canOpenLoresheet, isLoresheetPresent } from \"../../state/loresheets\";\nimport { IStoreState } from \"../../state/type\";\n\nimport Loresheet, {\n  ILoresheetProps\n} from \"../../components/Character/Loresheet\";\n\ninterface IMapStateToProps {\n  canOpen: boolean;\n  cost: ICost;\n  known: boolean;\n  uid: string;\n}\n\ninterface IMapDispatchToProps {\n  onOpen: (cost: ICost) => void;\n}\n\ninterface IProps {\n  uid: string;\n}\n\nfunction mapStateToProps(state: IStoreState, props: IProps): IMapStateToProps {\n  return {\n    canOpen: canOpenLoresheet(state, props.uid),\n    cost: getCostOpenLoresheet(state, props.uid),\n    known: isLoresheetPresent(state.loresheets, props.uid),\n    uid: props.uid\n  };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<ILoresheetAction>,\n  props: IProps\n): IMapDispatchToProps {\n  return {\n    onOpen: (cost: ICost) => dispatch(open(props.uid, cost))\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): ILoresheetProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(Loresheet);\n","import * as React from \"react\";\n\nimport SelectorList, { IOption } from \"../../components/SelectorList\";\n\nimport Loresheet from \"../../containers/Character/Loresheet\";\nimport {\n  IDataLoresheet,\n  loresheets,\n  loresheetsCategories\n} from \"../../data/loresheets\";\n\nclass LoresheetsList extends React.PureComponent<{}, {}> {\n  constructor(props: {}) {\n    super(props);\n\n    this.renderItem = this.renderItem.bind(this);\n  }\n\n  public render() {\n    const nestedOptions = loresheetsCategories.map(category => {\n      const categories: IOption[] = [\n        { id: category, label: category, disabled: true }\n      ];\n      const lsInCategory: IOption[] = loresheets\n        .filter((ls: IDataLoresheet) => ls.category === category)\n        .map((ls: IDataLoresheet) => ({\n          disabled: false,\n          id: ls.uid,\n          label: ls.name,\n          meta: ls.name + \",\" + category\n        }));\n      return categories.concat(lsInCategory);\n    });\n\n    const options = ([] as IOption[]).concat(...nestedOptions); // Flattening\n\n    return (\n      <SelectorList\n        options={options}\n        preSelected={[]}\n        renderItem={this.renderItem}\n      />\n    );\n  }\n\n  private renderItem(uid: string): JSX.Element {\n    return <Loresheet uid={uid} />;\n  }\n}\n\nexport default LoresheetsList;\n","import * as React from \"react\";\nimport { RouteComponentProps } from \"react-router\";\n\nimport AppIntro from \"../components/AppIntro\";\nimport AppPage from \"../components/AppPage\";\nimport LoresheetsList from \"../components/Character/LoresheetsList\";\n\nclass RouteLoresheets extends React.PureComponent<RouteComponentProps<{}>> {\n  public render() {\n    return (\n      <div>\n        <AppIntro>Empty Intro</AppIntro>\n        <AppPage>\n          <LoresheetsList />\n        </AppPage>\n      </div>\n    );\n  }\n}\n\nexport default RouteLoresheets;\n","import * as React from \"react\";\n\nimport { IAction } from \"../../state/actions/types\";\n\nexport interface IHistoryProps {\n  history: IAction[];\n  onDelete: (id: number) => void;\n}\n\nexport interface IHistoryState {\n  hoverIndex: number;\n}\n\nclass History extends React.PureComponent<IHistoryProps, IHistoryState> {\n  constructor(props: IHistoryProps) {\n    super(props);\n\n    this.state = {\n      hoverIndex: this.props.history.length\n    };\n\n    this.renderHistoryAction.bind(this);\n    this.rollbackHistory.bind(this);\n  }\n\n  public render() {\n    return (\n      <div className=\"History\">\n        <div>\n          {this.props.history.map((action: IAction, index: number) =>\n            this.renderHistoryAction(action, index)\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  private renderHistoryAction(action: IAction, index: number): JSX.Element {\n    const onClick = () => this.rollbackHistory(index);\n    return (\n      <div key={\"rowHistory_\" + index} onClick={onClick}>\n        <div>{index + 1 + \" \" + action.type}</div>\n        <div>{JSON.stringify(action)}</div>\n      </div>\n    );\n  }\n\n  private rollbackHistory(index: number): void {\n    this.props.onDelete(index);\n  }\n}\n\nexport default History;\n","import { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\n\nimport History, { IHistoryProps } from \"../../components/Character/History\";\n\nimport * as actions from \"../../state/actions/history\";\nimport { IAction } from \"../../state/actions/types\";\nimport { IStoreState } from \"../../state/type\";\n\ninterface IMapStateToProps {\n  history: IAction[];\n}\n\ninterface IMapDispatchToProps {\n  onDelete: (id: number) => void;\n}\n\nfunction mapStateToProps(state: IStoreState): IMapStateToProps {\n  return { history: state.history };\n}\n\nfunction mapDispatchToProps(\n  dispatch: Dispatch<actions.IHistoryAction>\n): IMapDispatchToProps {\n  return {\n    onDelete: (id: number) => {\n      dispatch(actions.historyDeleteUpTo(id));\n    }\n  };\n}\n\nfunction mergeProps(\n  propsFromState: IMapStateToProps,\n  propsForDispatch: IMapDispatchToProps\n): IHistoryProps {\n  return Object.assign({}, propsFromState, propsForDispatch);\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(History);\n","import * as constants from \"../constants/history\";\n\nexport interface IHistoryDeleteUpTo {\n  type: constants.HISTORY_DELETE;\n  id: number;\n}\n\nexport type IHistoryAction = IHistoryDeleteUpTo;\n\nexport function historyDeleteUpTo(id: number): IHistoryDeleteUpTo {\n  return { type: constants.HISTORY_DELETE, id };\n}\n","import * as React from \"react\";\nimport { RouteComponentProps } from \"react-router\";\n\nimport AppIntro from \"../components/AppIntro\";\nimport AppPage from \"../components/AppPage\";\nimport History from \"../containers/Character/History\";\n\nclass RouteHistory extends React.PureComponent<RouteComponentProps<{}>> {\n  public render() {\n    return (\n      <div>\n        <AppIntro>Empty Intro</AppIntro>\n        <AppPage>\n          <History />\n        </AppPage>\n      </div>\n    );\n  }\n}\n\nexport default RouteHistory;\n","import * as React from \"react\";\nimport { BrowserRouter, Route } from \"react-router-dom\";\n\nimport AppHeader from \"../components/AppHeader\";\n\n/* Pages */\n/* tslint:disable ordered-imports */\nimport Homepage from \"../routes/Homepage\";\n\nimport Skills from \"../routes/Skills\";\nimport Virtues from \"../routes/Virtues\";\nimport Chi from \"../routes/Chi\";\nimport Equipment from \"../routes/Equipment\";\nimport Conditions from \"../routes/Conditions\";\nimport KungFu from \"../routes/KungFu\";\nimport Loresheets from \"../routes/Loresheets\";\n\nimport History from \"../routes/History\";\n\nclass App extends React.PureComponent<{}, {}> {\n  public render() {\n    return (\n      <BrowserRouter>\n        <div className=\"lotwcs\">\n          <AppHeader />\n          <Route exact={true} path=\"/\" component={Homepage} />\n          <Route exact={true} path=\"/skills\" component={Skills} />\n          <Route exact={true} path=\"/chi\" component={Chi} />\n          <Route exact={true} path=\"/virtues\" component={Virtues} />\n          <Route exact={true} path=\"/equipment\" component={Equipment} />\n          <Route exact={true} path=\"/conditions\" component={Conditions} />\n          <Route exact={true} path=\"/kungfu\" component={KungFu} />\n          <Route exact={true} path=\"/loresheets\" component={Loresheets} />\n          <Route exact={true} path=\"/history\" component={History} />\n        </div>\n      </BrowserRouter>\n    );\n  }\n}\n\nexport default App;\n","/* eslint-disable import/first */\n/* Redux and state management */\nimport { Provider } from \"react-redux\";\nimport { createStore } from \"redux\";\nimport { devToolsEnhancer } from \"redux-devtools-extension\";\n\n/* React and DOM management */\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\n\nimport { IAction } from \"./state/actions/types\";\nimport { testingStateFactory } from \"./state/initial\";\nimport { globalReducer } from \"./state/reducers/global\";\nimport { IStoreState } from \"./state/type\";\n\nconst store = createStore<IStoreState, IAction, any, any>(\n  globalReducer,\n  testingStateFactory(),\n  devToolsEnhancer({})\n);\n\nimport * as serviceWorker from \"./serviceWorker\";\n\nimport \"bootstrap/dist/css/bootstrap.css\";\nimport \"./Grid.css\";\nimport \"./index.css\";\n\nimport App from \"./App\";\n\nReactDOM.render(\n  <div>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </div>,\n  document.getElementById(\"root\") as HTMLElement\n);\n\nserviceWorker.register();\n"],"sourceRoot":""}